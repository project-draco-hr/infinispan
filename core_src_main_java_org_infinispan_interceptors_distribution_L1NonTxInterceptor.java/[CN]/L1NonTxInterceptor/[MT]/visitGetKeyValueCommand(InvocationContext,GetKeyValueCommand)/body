{
  Object returnValue=invokeNextInterceptor(ctx,command);
  InternalCacheEntry ice=command.getRemotelyFetchedValue();
  if (ctx.isOriginLocal() && ice != null) {
    log.tracef("Caching remotely retrieved entry for key %s in L1",command.getKey());
    try {
      long l1Lifespan=cacheConfiguration.clustering().l1().lifespan();
      long lifespan=ice.getLifespan() < 0 ? l1Lifespan : Math.min(ice.getLifespan(),l1Lifespan);
      Metadata newMetadata=ice.getMetadata().builder().lifespan(lifespan).maxIdle(-1).build();
      PutKeyValueCommand put=cf.buildPutKeyValueCommand(ice.getKey(),ice.getValue(),newMetadata,Collections.singleton(Flag.CACHE_MODE_LOCAL));
      lockAndWrap(ctx,command.getKey(),ice,command);
      invokeNextInterceptor(ctx,put);
    }
 catch (    Exception e) {
      log.infof("Unable to store entry %s in L1 cache",command.getKey());
      log.debug("Inability to store in L1 caused by",e);
    }
  }
 else   if (!ctx.isOriginLocal() && returnValue != null) {
    l1Manager.addRequestor(command.getKey(),ctx.getOrigin());
  }
  return returnValue;
}
