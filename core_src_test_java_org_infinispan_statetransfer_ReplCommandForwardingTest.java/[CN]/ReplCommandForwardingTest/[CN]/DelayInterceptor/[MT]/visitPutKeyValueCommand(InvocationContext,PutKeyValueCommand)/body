{
  if (!ctx.isInTxScope() && !command.hasFlag(Flag.PUT_FOR_STATE_TRANSFER)) {
    log.tracef("Delaying command %s originating from %s",command,ctx.getOrigin());
    Integer myCount=counter.incrementAndGet();
    Object pollResult=barrier.poll(15,TimeUnit.SECONDS);
    assertEquals(pollResult,myCount,String.format("Timed out waiting for unblock(%d) call on cache %s",myCount,cache));
    log.tracef("Command unblocked: %s",command);
  }
  Object result=super.visitPutKeyValueCommand(ctx,command);
  return result;
}
