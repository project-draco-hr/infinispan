{
  waitForRehashToComplete(caches);
  for (  Cache c : caches) {
    CacheTopology cacheTopology=extractComponent(c,StateTransferManager.class).getCacheTopology();
    assertEquals(cacheTopology.getTopologyId(),expectedTopologyId,String.format("Wrong topology on cache %s, expected %d and got %s",c,expectedTopologyId,cacheTopology));
  }
}
