{
  Object key=payload.getKey();
  for (  Address leaver : leavers) {
    List<Address> owners=oldCH.locate(key,replCount);
    int leaverIndex=owners.indexOf(leaver);
    if (leaverIndex > -1) {
      int numOwners=owners.size();
      int selfIndex=owners.indexOf(self);
      boolean isLeaverLast=leaverIndex == numOwners - 1;
      if ((isLeaverLast && selfIndex == numOwners - 2) || (!isLeaverLast && selfIndex == leaverIndex + 1)) {
        List<Address> newOwners=newCH.locate(key,replCount);
        newOwners.removeAll(owners);
        if (!newOwners.isEmpty()) {
          for (          Address no : newOwners) {
            Map<Object,InternalCacheValue> s=state.get(no);
            if (s == null) {
              s=new HashMap<Object,InternalCacheValue>();
              state.put(no,s);
            }
            s.put(key,payload.toInternalCacheValue());
          }
        }
      }
    }
  }
  keysHandled.add(key);
}
