{
  int remainingInChunk=getBytesRemainingInChunk();
  if (remainingInChunk == 0) {
    flush();
    localIndex=0;
    remainingInChunk=getChunkSize();
  }
  int bytesToWrite=Math.min(remainingInChunk,src.remaining());
  src.get(currentBuffer,localIndex,bytesToWrite);
  localIndex+=bytesToWrite;
  position+=bytesToWrite;
  return bytesToWrite;
}
