{
  if (!type.hasProperty(propertyName)) {
    throw log.getNoSuchPropertyException(type.toString(),propertyName);
  }
  if (status != Status.DEFINING_SELECT && !type.isEmbedded(propertyName) && type.isAnalyzed(propertyName)) {
    throw log.getQueryOnAnalyzedPropertyNotSupportedException(type.getIndexedEntityType().getCanonicalName(),propertyName);
  }
  if (type.isEmbedded(propertyName)) {
    ProtobufValueWrapperTypeDescriptor sourceType=(ProtobufValueWrapperTypeDescriptor)type;
    Descriptors.Descriptor descriptor=sourceType.getMessageDescriptor().findFieldByName(propertyName).getMessageType();
    return new PathedPropertyReference(propertyName,new ProtobufValueWrapperTypeDescriptor(descriptor),false);
  }
 else {
    return new PathedPropertyReference(propertyName,new HSearchPropertyTypeDescriptor(),false);
  }
}
