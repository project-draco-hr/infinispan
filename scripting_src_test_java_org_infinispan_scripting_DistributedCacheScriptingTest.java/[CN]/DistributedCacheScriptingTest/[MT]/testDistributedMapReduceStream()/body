{
  ScriptingManager scriptingManager=getScriptingManager(manager(0));
  Cache cache=cache(0);
  loadData(cache,"/macbeth.txt");
  loadScript(scriptingManager,"/wordCountStream_dist.js");
  ArrayList<Map<String,Long>> resultsFuture=(ArrayList<Map<String,Long>>)scriptingManager.runScript("wordCountStream_dist.js",new TaskContext().cache(cache(0))).get();
  assertEquals(2,resultsFuture.size());
  assertEquals(3209,resultsFuture.get(0).size());
  assertEquals(3209,resultsFuture.get(1).size());
  assertEquals(resultsFuture.get(0).get("macbeth"),Long.valueOf(287));
  assertEquals(resultsFuture.get(1).get("macbeth"),Long.valueOf(287));
}
