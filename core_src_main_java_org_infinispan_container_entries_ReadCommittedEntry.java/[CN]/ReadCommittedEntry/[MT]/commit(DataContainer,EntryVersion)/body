{
  if (isChanged()) {
    if (trace)     log.tracef("Updating entry (key=%s removed=%s valid=%s changed=%s created=%s value=%s]",getKey(),isRemoved(),isValid(),isChanged(),isCreated(),value);
    if (value instanceof AtomicHashMap) {
      AtomicHashMap ahm=(AtomicHashMap)value;
      ahm.commit();
      if (isRemoved() && !isEvicted())       ahm.markRemoved(true);
    }
    if (isRemoved()) {
      container.remove(key);
    }
 else     if (value != null) {
      container.put(key,value,newVersion,lifespan,maxIdle);
    }
    reset();
  }
}
