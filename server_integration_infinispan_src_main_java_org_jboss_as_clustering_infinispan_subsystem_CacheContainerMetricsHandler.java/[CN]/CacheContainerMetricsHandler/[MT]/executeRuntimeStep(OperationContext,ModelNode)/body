{
  final PathAddress address=PathAddress.pathAddress(operation.require(OP_ADDR));
  final String cacheContainerName=address.getLastElement().getValue();
  final String attrName=operation.require(ModelDescriptionConstants.NAME).asString();
  final ServiceController<?> controller=context.getServiceRegistry(false).getService(EmbeddedCacheManagerService.getServiceName(cacheContainerName));
  DefaultEmbeddedCacheManager cacheManager=(DefaultEmbeddedCacheManager)controller.getValue();
  CacheManagerMetrics metric=CacheManagerMetrics.getStat(attrName);
  ModelNode result=new ModelNode();
  if (metric == null) {
    context.getFailureDescription().set(String.format("Unknown metric %s",attrName));
  }
 else   if (cacheManager == null) {
    context.getFailureDescription().set(String.format("Unavailable cache container %s",attrName));
  }
 else {
switch (metric) {
case CACHE_MANAGER_STATUS:
      result.set(SecurityActions.getCacheManagerStatus(cacheManager).toString());
    break;
case IS_COORDINATOR:
  result.set(SecurityActions.getCacheManagerIsCoordinator(cacheManager));
break;
case LOCAL_ADDRESS:
Address localAddress=SecurityActions.getCacheManagerLocalAddress(cacheManager);
result.set(localAddress != null ? localAddress.toString() : "N/A");
break;
case COORDINATOR_ADDRESS:
Address coordinatorAddress=SecurityActions.getCacheManagerCoordinatorAddress(cacheManager);
result.set(coordinatorAddress != null ? coordinatorAddress.toString() : "N/A");
break;
case CLUSTER_NAME:
String clusterName=SecurityActions.getCacheManagerClusterName(cacheManager);
result.set(clusterName != null ? clusterName : "N/A");
break;
case DEFINED_CACHE_NAMES:
String definedCacheNames=SecurityActions.getDefinedCacheNames(cacheManager);
result.set(definedCacheNames != null ? definedCacheNames : "N/A");
break;
case CLUSTER_SIZE:
List<Address> members=SecurityActions.getMembers(cacheManager);
result.set(members != null ? Integer.toString(members.size()) : "N/A");
break;
case CREATED_CACHE_COUNT:
result.set(SecurityActions.getCacheCreatedCount(cacheManager));
break;
case DEFINED_CACHE_COUNT:
result.set(SecurityActions.getDefinedCacheCount(cacheManager));
break;
case MEMBERS:
members=SecurityActions.getMembers(cacheManager);
result.set(members != null ? members.toString() : "N/A");
break;
case RUNNING_CACHE_COUNT:
result.set(SecurityActions.getRunningCacheCount(cacheManager));
break;
case VERSION:
result.set(Version.VERSION);
break;
default :
context.getFailureDescription().set(String.format("Unknown metric %s",metric));
break;
}
context.getResult().set(result);
}
context.stepCompleted();
}
