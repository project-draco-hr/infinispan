{
  Set<String> strings=new HashSet<String>();
  int numElements=state.stringsOutOfIndex.drainTo(strings,5);
  IndexWriter iwriter=LuceneSettings.openWriter(directory);
  for (  String term : strings) {
    Document doc=new Document();
    doc.add(new Field("main",term,Store.NO,Index.NOT_ANALYZED));
    iwriter.addDocument(doc);
  }
  iwriter.commit();
  iwriter.close();
  state.stringsInIndex.addAll(strings);
  state.incrementIndexWriterTaskCount(numElements);
}
