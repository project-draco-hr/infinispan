{
  if (loader != null) {
    if (clmConfig.isPreload()) {
      log.debug("Preloading transient state from cache loader {0}",loader);
      long start=0, stop=0, total=0;
      if (log.isDebugEnabled())       start=System.currentTimeMillis();
      Set<InternalCacheEntry> state;
      try {
        state=loader.loadAll();
      }
 catch (      CacheLoaderException e) {
        throw new CacheException("Unable to preload!",e);
      }
      for (      InternalCacheEntry e : state)       cache.getAdvancedCache().withFlags(SKIP_CACHE_STATUS_CHECK,CACHE_MODE_LOCAL).put(e.getKey(),e.getValue(),e.getLifespan(),MILLISECONDS,e.getMaxIdle(),MILLISECONDS);
      if (log.isDebugEnabled())       stop=System.currentTimeMillis();
      if (log.isDebugEnabled())       total=stop - start;
      log.debug("Preloaded {0} keys in {1} milliseconds",state.size(),total);
    }
  }
}
