{
  if (loader != null) {
    try {
      CacheStore store=getCacheStore();
      if (store != null) {
        InvocationContext ctx=icc.createNonTxInvocationContext();
        if (ctx.hasFlag(REMOVE_DATA_ON_STOP)) {
          if (log.isTraceEnabled())           log.trace("Requested removal of data on stop, so clear cache store");
          store.clear();
        }
      }
      loader.stop();
    }
 catch (    CacheLoaderException e) {
      throw new CacheException(e);
    }
 finally {
      loader=null;
    }
  }
}
