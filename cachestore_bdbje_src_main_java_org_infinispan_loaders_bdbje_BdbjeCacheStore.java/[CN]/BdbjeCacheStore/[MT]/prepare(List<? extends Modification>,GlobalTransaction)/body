{
  if (trace)   log.tracef("preparing transaction %s",tx);
  try {
    transactionRunner.prepare(new ModificationsTransactionWorker(this,mods));
    Transaction txn=currentTransaction.getTransaction();
    if (trace)     log.tracef("transaction %s == sleepycat transaction %s",tx,txn);
    txnMap.put(tx,txn);
    try {
      ThreadLocal<Object> tl=(ThreadLocal<Object>)ReflectionUtil.getValue(currentTransaction,"localTrans");
      tl.remove();
    }
 catch (    Exception e) {
      log.warn("Unable to clean up BDBJE transaction thread locals.");
      throw convertToCacheLoaderException("Unable to clean up BDBJE transaction",e);
    }
  }
 catch (  Exception e) {
    throw convertToCacheLoaderException("Problem preparing transaction",e);
  }
}
