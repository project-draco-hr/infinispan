{
  Configuration config=getDefaultClusteredConfig(Configuration.CacheMode.DIST_SYNC,true);
  config.setEagerLockSingleNode(true);
  config.setNumOwners(2);
  config.setLockAcquisitionTimeout(2000);
  config.setUseEagerLocking(true);
  config.setL1CacheEnabled(false);
  createClusteredCaches(4,config);
  TestingUtil.blockUntilViewReceived(cache(0),4,10000);
  BaseDistFunctionalTest.RehashWaiter.waitForInitRehashToComplete(cache(0),cache(1),cache(2),cache(3));
  poolExecutor=new ThreadPoolExecutor(1,1,1000,TimeUnit.MILLISECONDS,new ArrayBlockingQueue<Runnable>(10));
  kaf=KeyAffinityServiceFactory.newKeyAffinityService(cache(0),poolExecutor,new RndKeyGenerator(),10,true);
}
