{
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<infinispan\n" + "      xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n"+ "      xsi:schemaLocation=\"urn:infinispan:config:4.0 http://www.infinispan.org/schemas/infinispan-config-4.0.xsd\"\n"+ "      xmlns=\"urn:infinispan:config:5.0\">"+ "<default><dataContainer class=\"" + QueryableDataContainer.class.getName() + "\">"+ "<properties><property name=\"foo\" value=\"bar\" /></properties>"+ "</dataContainer></default>"+ "</infinispan>";
  InputStream stream=new ByteArrayInputStream(xml.getBytes());
  EmbeddedCacheManager cm=TestCacheManagerFactory.fromStream(stream);
  try {
    AdvancedCache<Object,Object> cache=cm.getCache().getAdvancedCache();
    QueryableDataContainer.setDelegate(DefaultDataContainer.unBoundedDataContainer(cache.getConfiguration().getConcurrencyLevel()));
    Assert.assertEquals(cm.getDefaultConfiguration().getDataContainerClass(),QueryableDataContainer.class.getName());
    Assert.assertEquals(cache.getDataContainer().getClass(),QueryableDataContainer.class);
    QueryableDataContainer dataContainer=QueryableDataContainer.class.cast(cache.getDataContainer());
    Assert.assertTrue(checkLoggedOperations(dataContainer.getLoggedOperations(),"setFoo(bar)"));
    cache.put("name","Pete");
    Assert.assertTrue(checkLoggedOperations(dataContainer.getLoggedOperations(),"put(name, Pete"));
  }
  finally {
    TestingUtil.killCacheManagers(cm);
  }
}
