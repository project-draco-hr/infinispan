{
  List<TransactionInfo> transactions=new ArrayList<TransactionInfo>();
  if (configuration.transaction().transactionMode().isTransactional()) {
    try {
      stateTransferLock.transactionsExclusiveLock();
      collectTransactionsToTransfer(transactions,transactionTable.getRemoteTransactions(),segments);
      collectTransactionsToTransfer(transactions,transactionTable.getLocalTransactions(),segments);
      log.debugf("Found %d transfer to transfer",transactions.size());
    }
  finally {
      stateTransferLock.transactionsExclusiveUnlock();
    }
  }
  return transactions;
}
