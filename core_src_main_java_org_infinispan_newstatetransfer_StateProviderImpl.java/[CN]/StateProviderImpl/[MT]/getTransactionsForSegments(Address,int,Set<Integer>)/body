{
  try {
    stateTransferLock.acquireTTExclusiveLock();
    List<TransactionInfo> transactions=new ArrayList<TransactionInfo>();
    if (transactionTable != null) {
      collectTransactionsToTransfer(transactions,transactionTable.getRemoteTransactions(),segments);
      collectTransactionsToTransfer(transactions,transactionTable.getLocalTransactions(),segments);
      log.debugf("Found %d transfer to transfer",transactions.size());
    }
    return transactions;
  }
  finally {
    stateTransferLock.releaseTTExclusiveLock();
  }
}
