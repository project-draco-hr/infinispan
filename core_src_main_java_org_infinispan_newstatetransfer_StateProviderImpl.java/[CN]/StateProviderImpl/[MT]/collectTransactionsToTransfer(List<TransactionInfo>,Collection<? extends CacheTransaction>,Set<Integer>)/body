{
  for (  CacheTransaction tx : transactions) {
    Set<Object> lockedKeys=new HashSet<Object>();
    for (    Object key : tx.getLockedKeys()) {
      if (segments.contains(currentCh.getSegment(key))) {
        lockedKeys.add(key);
      }
    }
    for (    Object key : tx.getBackupLockedKeys()) {
      if (segments.contains(currentCh.getSegment(key))) {
        lockedKeys.add(key);
      }
    }
    List<WriteCommand> modifications=tx.getModifications();
    transactionsToTransfer.add(new TransactionInfo(tx.getGlobalTransaction(),modifications.toArray(new WriteCommand[modifications.size()]),lockedKeys));
  }
}
