{
  Set<AbstractComponentRegistry.Component> components=registry.getRegisteredComponents();
  MBeanServer platformMBeanServer;
  if (this.mBeanServer != null) {
    platformMBeanServer=this.mBeanServer;
  }
 else {
    platformMBeanServer=ManagementFactory.getPlatformMBeanServer();
  }
  ComponentGroupJmxRegistration registrator=new ComponentGroupJmxRegistration(platformMBeanServer,components,GLOBAL_JMX_GROUP);
  if (globalConfiguration.getJmxDomain() != null) {
    registrator.setJmxDomain(globalConfiguration.getJmxDomain());
  }
  return registrator;
}
