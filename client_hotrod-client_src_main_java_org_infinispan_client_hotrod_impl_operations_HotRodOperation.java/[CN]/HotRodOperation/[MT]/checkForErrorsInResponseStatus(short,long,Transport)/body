{
  if (log.isTraceEnabled()) {
    log.trace("Received operation status: " + status);
  }
switch ((int)status) {
case HotRodConstants.INVALID_MAGIC_OR_MESSAGE_ID_STATUS:
case HotRodConstants.REQUEST_PARSING_ERROR_STATUS:
case HotRodConstants.UNKNOWN_COMMAND_STATUS:
case HotRodConstants.SERVER_ERROR_STATUS:
case HotRodConstants.UNKNOWN_VERSION_STATUS:
{
      String msgFromServer=transport.readString();
      if (log.isWarnEnabled()) {
        log.warn("Error status received from the server:" + msgFromServer + " for message id "+ messageId);
      }
      throw new HotRodClientException(msgFromServer,messageId,status);
    }
case HotRodConstants.COMMAND_TIMEOUT_STATUS:
{
    String msg=transport.readString();
    if (log.isTraceEnabled()) {
      log.trace("Server-side timeout performing operation: " + msg);
    }
    throw new HotRodTimeoutException(msg,messageId,status);
  }
case HotRodConstants.NO_ERROR_STATUS:
case HotRodConstants.KEY_DOES_NOT_EXIST_STATUS:
case HotRodConstants.NOT_PUT_REMOVED_REPLACED_STATUS:
{
  break;
}
default :
{
throw new IllegalStateException("Unknown status: " + Integer.toHexString(status));
}
}
}
