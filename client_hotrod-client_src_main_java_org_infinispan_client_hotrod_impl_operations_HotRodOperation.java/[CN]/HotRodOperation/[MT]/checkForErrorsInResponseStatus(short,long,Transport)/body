{
  final boolean isTrace=log.isTraceEnabled();
  if (isTrace)   log.trace("Received operation status: %#x",status);
switch ((int)status) {
case HotRodConstants.INVALID_MAGIC_OR_MESSAGE_ID_STATUS:
case HotRodConstants.REQUEST_PARSING_ERROR_STATUS:
case HotRodConstants.UNKNOWN_COMMAND_STATUS:
case HotRodConstants.SERVER_ERROR_STATUS:
case HotRodConstants.COMMAND_TIMEOUT_STATUS:
case HotRodConstants.UNKNOWN_VERSION_STATUS:
{
      readNewTopologyIfPresent(transport);
      String msgFromServer=transport.readString();
      if (status == HotRodConstants.COMMAND_TIMEOUT_STATUS && isTrace) {
        log.trace("Server-side timeout performing operation: %s",msgFromServer);
      }
 else {
        log.warn("Error received from the server: %s",msgFromServer);
      }
      throw new HotRodClientException(msgFromServer,messageId,status);
    }
default :
{
    throw new IllegalStateException(String.format("Unknown status: %#04x",status));
  }
}
}
