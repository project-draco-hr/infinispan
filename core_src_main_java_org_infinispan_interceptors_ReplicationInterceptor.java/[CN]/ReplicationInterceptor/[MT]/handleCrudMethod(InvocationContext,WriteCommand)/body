{
  final Object returnValue=invokeNextInterceptor(ctx,command);
  populateCommandFlags(command,ctx);
  if (!isLocalModeForced(ctx) && command.isSuccessful() && ctx.isOriginLocal()&& !ctx.isInTxScope()) {
    allowStateTransferToComplete(ctx,command,-1);
    if (ctx.isUseFutureReturnType()) {
      NotifyingNotifiableFuture<Object> future=new NotifyingFutureImpl(returnValue);
      rpcManager.broadcastRpcCommandInFuture(command,future);
      return future;
    }
 else {
      rpcManager.broadcastRpcCommand(command,isSynchronous(ctx));
    }
  }
  return returnValue;
}
