{
switch (type) {
case JOIN_REQ:
    return distributionManager.requestPermissionToJoin(sender);
case JOIN_REHASH_START:
  return distributionManager.informRehashOnJoin(sender,true,nodeTopologyInfo);
case JOIN_REHASH_END:
distributionManager.informRehashOnJoin(sender,false,nodeTopologyInfo);
return null;
case PULL_STATE_JOIN:
return pullStateForJoin();
case PULL_STATE_LEAVE:
return pullStateForLeave();
case PUSH_STATE:
return pushState();
case DRAIN_TX:
distributionManager.applyRemoteTxLog(txLogCommands);
return null;
case DRAIN_TX_PREPARES:
for (PrepareCommand pc : pendingPrepares) pc.perform(null);
return null;
}
throw new CacheException("Unknown rehash control command type " + type);
}
