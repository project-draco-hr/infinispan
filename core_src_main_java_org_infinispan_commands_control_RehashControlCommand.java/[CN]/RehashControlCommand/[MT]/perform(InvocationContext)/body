{
switch (type) {
case JOIN_REQ:
    return distributionManager.requestPermissionToJoin(sender);
case JOIN_REHASH_START:
  distributionManager.informRehashOnJoin(sender,true);
return null;
case JOIN_REHASH_END:
distributionManager.informRehashOnJoin(sender,false);
return null;
case JOIN_COMPLETE:
distributionManager.notifyJoinComplete(sender);
return null;
case PULL_STATE:
return pullState();
case PUSH_STATE:
return pushState();
case DRAIN_TX:
distributionManager.applyRemoteTxLog(txLogCommands);
return null;
case DRAIN_TX_PREPARES:
for (PrepareCommand pc : pendingPrepares) pc.perform(null);
return null;
}
throw new CacheException("Unknown rehash control command type " + type);
}
