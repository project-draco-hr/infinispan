{
  final MBeanServerLookup expectedMBeanServerLookup=new PlatformMBeanServerLookup();
  final SpringEmbeddedCacheManagerFactoryBean objectUnderTest=new SpringEmbeddedCacheManagerFactoryBean();
  objectUnderTest.setMBeanServerLookup(expectedMBeanServerLookup);
  objectUnderTest.afterPropertiesSet();
  final SpringEmbeddedCacheManager springEmbeddedCacheManager=objectUnderTest.getObject();
  assertSame("SpringEmbeddedCacheManagerFactoryBean should have used explicitly set MBeanServerLookup. However, it didn't.",expectedMBeanServerLookup.getClass().getName(),springEmbeddedCacheManager.getNativeCacheManager().getCacheManagerConfiguration().globalJmxStatistics().mbeanServerLookup().getClass().getName());
  springEmbeddedCacheManager.stop();
}
