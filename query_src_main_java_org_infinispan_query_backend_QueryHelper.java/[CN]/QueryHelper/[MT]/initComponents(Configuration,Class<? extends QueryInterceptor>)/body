{
  ComponentRegistry cr=cache.getAdvancedCache().getComponentRegistry();
  cr.registerComponent(searchFactory,SearchFactoryImplementor.class);
  cr.registerComponent(new SearchFactoryStopper(searchFactory),SearchFactoryStopper.class);
  InterceptorChainFactory icf=cr.getComponent(InterceptorChainFactory.class);
  CommandInterceptor inter=icf.createInterceptor(interceptorClass);
  cr.registerComponent(inter,QueryInterceptor.class);
  cache.getAdvancedCache().addInterceptorAfter(inter,cfg.getCacheMode().isDistributed() ? DistLockingInterceptor.class : LockingInterceptor.class);
}
