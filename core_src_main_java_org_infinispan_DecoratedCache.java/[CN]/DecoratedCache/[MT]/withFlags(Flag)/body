{
  if (flags == null || flags.length == 0)   return this;
 else {
    final List<Flag> flagsToAdd=Arrays.asList(flags);
    if (this.flags != null && this.flags.containsAll(flagsToAdd)) {
      return this;
    }
 else {
      if (this.flags == null) {
        return new DecoratedCache<K,V>(this.cacheImplementation,this.classLoader.get(),EnumSet.copyOf(flagsToAdd));
      }
 else {
        EnumSet<Flag> newFlags=EnumSet.copyOf(this.flags);
        newFlags.addAll(flagsToAdd);
        return new DecoratedCache<K,V>(this.cacheImplementation,this.classLoader.get(),newFlags);
      }
    }
  }
}
