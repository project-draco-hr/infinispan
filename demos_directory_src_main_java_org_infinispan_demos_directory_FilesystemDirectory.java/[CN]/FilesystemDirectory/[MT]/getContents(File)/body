{
  InputStream in;
  in=new FileInputStream(file);
  try {
    int length=(int)file.length();
    byte[] buffer=new byte[length];
    int read=in.read(buffer,0,length);
    if (read != length)     throw new IllegalStateException("length was " + length + ", but only "+ read+ " bytes were read");
    return buffer;
  }
  finally {
    Util.close(in);
  }
}
