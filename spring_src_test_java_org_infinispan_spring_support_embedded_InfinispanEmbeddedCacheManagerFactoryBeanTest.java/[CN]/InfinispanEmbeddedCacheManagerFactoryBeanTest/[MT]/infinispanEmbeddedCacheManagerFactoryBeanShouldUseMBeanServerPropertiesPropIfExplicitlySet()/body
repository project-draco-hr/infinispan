{
  final Properties expectedMBeanServerProperties=new Properties();
  expectedMBeanServerProperties.setProperty("key","value");
  final InfinispanEmbeddedCacheManagerFactoryBean objectUnderTest=new TestInfinispanEmbeddedCacheManagerFactoryBean();
  objectUnderTest.setMBeanServerProperties(expectedMBeanServerProperties);
  objectUnderTest.afterPropertiesSet();
  withCacheManager(new CacheManagerCallable(objectUnderTest.getObject()){
    @Override public void call(){
      assertEquals("SpringEmbeddedCacheManagerFactoryBean should have used explicitly set MBeanServerProperties. However, it didn't.",expectedMBeanServerProperties,cm.getCacheManagerConfiguration().globalJmxStatistics().properties());
    }
  }
);
}
