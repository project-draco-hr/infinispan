{
  final InfinispanEmbeddedCacheManagerFactoryBean objectUnderTest=new TestInfinispanEmbeddedCacheManagerFactoryBean();
  objectUnderTest.setShutdownHookBehavior(ShutdownHookBehavior.DONT_REGISTER.name());
  objectUnderTest.afterPropertiesSet();
  withCacheManager(new CacheManagerCallable(objectUnderTest.getObject()){
    @Override public void call(){
      assertEquals("SpringEmbeddedCacheManagerFactoryBean should have used explicitly set ShutdownHookBehavior. However, it didn't.",ShutdownHookBehavior.DONT_REGISTER,cm.getGlobalConfiguration().getShutdownHookBehavior());
    }
  }
);
}
