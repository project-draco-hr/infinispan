{
  Properties props=new Properties();
  props.put("infinispan.client.hotrod.server_list","localhost:" + hotRodServer2.getPort() + ";localhost:"+ hotRodServer2.getPort());
  props.put("infinispan.client.hotrod.ping_on_startup","true");
  props.put("timeBetweenEvictionRunsMillis","500");
  RemoteCacheManager remoteCacheManager=new RemoteCacheManager(props);
  TcpTransportFactory tcpConnectionFactory=(TcpTransportFactory)TestingUtil.extractField(remoteCacheManager,"transportFactory");
  for (int i=0; i < 10; i++) {
    try {
      if (tcpConnectionFactory.getServers().size() == 1) {
        Thread.sleep(1000);
      }
 else {
        break;
      }
    }
  finally {
      remoteCacheManager.stop();
    }
  }
  assertEquals(2,tcpConnectionFactory.getServers().size());
}
