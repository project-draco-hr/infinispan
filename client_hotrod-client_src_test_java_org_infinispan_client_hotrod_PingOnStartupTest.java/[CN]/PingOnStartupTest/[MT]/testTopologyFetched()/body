{
  Properties props=new Properties();
  HotRodServer hotRodServer2=server(1);
  props.put("infinispan.client.hotrod.server_list","localhost:" + hotRodServer2.getPort() + ";localhost:"+ hotRodServer2.getPort());
  props.put("infinispan.client.hotrod.ping_on_startup","true");
  withRemoteCacheManager(new RemoteCacheManagerCallable(new InternalRemoteCacheManager(props)){
    @Override public void call(){
      TcpTransportFactory tcpTransportFactory=(TcpTransportFactory)((InternalRemoteCacheManager)rcm).getTransportFactory();
      for (int i=0; i < 10; i++) {
        if (tcpTransportFactory.getServers().size() == 1) {
          TestingUtil.sleepThread(1000);
        }
 else {
          break;
        }
      }
      assertEquals(2,tcpTransportFactory.getServers().size());
    }
  }
);
}
