{
  DistributedSync.SyncResponse sr=distributedSync.blockUntilReleased(distSyncTimeout,MILLISECONDS);
  boolean replayIgnored=sr == DistributedSync.SyncResponse.STATE_ACHIEVED;
  Response resp=handleInternal(cmd);
  if (resp == null || resp.isValid()) {
    if (replayIgnored)     resp=new ExtendedResponse(resp,true);
  }
 else {
    if (trace)     log.trace("Unable to execute command, got invalid response");
  }
  return resp;
}
