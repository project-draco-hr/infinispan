{
  String cacheName=cmd.getCacheName();
  ComponentRegistry cr=gcr.getNamedComponentRegistry(cacheName);
  if (cr == null) {
    if (log.isInfoEnabled())     log.info("Cache named {0} does not exist on this cache manager!",cacheName);
    return null;
  }
  Configuration localConfig=cr.getComponent(Configuration.class);
  if (!cr.getStatus().allowInvocations()) {
    long giveupTime=System.currentTimeMillis() + localConfig.getStateRetrievalTimeout();
    while (cr.getStatus().startingUp() && System.currentTimeMillis() < giveupTime)     Thread.sleep(100);
    if (!cr.getStatus().allowInvocations()) {
      log.warn("Cache named [{0}] exists but isn't in a state to handle invocations.  Its state is {1}.",cacheName,cr.getStatus());
      return RequestIgnoredResponse.INSTANCE;
    }
  }
  InvocationContextContainer icc=cr.getLocalComponent(InvocationContextContainer.class);
  CommandsFactory commandsFactory=cr.getLocalComponent(CommandsFactory.class);
  commandsFactory.initializeReplicableCommand(cmd);
  try {
    Object retval=cmd.perform(icc.get());
    return cr.getComponent(ResponseGenerator.class).getResponse(cmd,retval);
  }
 catch (  Exception e) {
    return new ExceptionResponse(e);
  }
}
