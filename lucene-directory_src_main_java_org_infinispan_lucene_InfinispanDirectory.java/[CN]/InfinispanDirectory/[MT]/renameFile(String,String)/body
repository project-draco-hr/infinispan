{
  ensureOpen();
  int i=-1;
  Object ob;
  do {
    ChunkCacheKey fromChunkKey=new ChunkCacheKey(indexName,from,++i);
    ob=chunksCache.get(fromChunkKey);
    if (ob == null) {
      break;
    }
    ChunkCacheKey toChunkKey=new ChunkCacheKey(indexName,to,i);
    chunksCache.withFlags(Flag.SKIP_REMOTE_LOOKUP,Flag.SKIP_CACHE_LOAD).put(toChunkKey,ob);
  }
 while (true);
  FileCacheKey fromKey=new FileCacheKey(indexName,from);
  FileMetadata metadata=(FileMetadata)metadataCache.get(fromKey);
  metadataCache.put(new FileCacheKey(indexName,to),metadata);
  fileOps.removeAndAdd(from,to);
  readLocks.deleteOrReleaseReadLock(from);
  if (log.isTraceEnabled()) {
    log.tracef("Renamed file from: %s to: %s in index %s",from,to,indexName);
  }
}
