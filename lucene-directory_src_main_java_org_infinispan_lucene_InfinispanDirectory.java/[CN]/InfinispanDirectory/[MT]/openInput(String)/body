{
  final FileCacheKey fileKey=new FileCacheKey(indexName,name);
  FileMetadata fileMetadata=(FileMetadata)metadataCache.withFlags(Flag.SKIP_LOCKING).get(fileKey);
  if (fileMetadata == null) {
    throw new FileNotFoundException("Error loading medatada for index file: " + fileKey);
  }
 else   if (fileMetadata.getSize() <= fileMetadata.getBufferSize()) {
    return new SingleChunkIndexInput(chunksCache,fileKey,fileMetadata);
  }
 else {
    boolean locked=readLocks.acquireReadLock(name);
    if (!locked) {
      throw new FileNotFoundException("Error loading medatada for index file: " + fileKey);
    }
    return new InfinispanIndexInput(chunksCache,fileKey,fileMetadata,readLocks);
  }
}
