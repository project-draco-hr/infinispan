{
  final FileCacheKey fileKey=new FileCacheKey(indexName,name);
  FileMetadata fileMetadata=(FileMetadata)cache.withFlags(Flag.SKIP_LOCKING).get(fileKey);
  if (fileMetadata == null) {
    throw new FileNotFoundException("Error loading medatada for index file: " + fileKey);
  }
 else   if (fileMetadata.getSize() <= chunkSize) {
    return new SingleChunkIndexInput(cache,fileKey,fileMetadata);
  }
 else {
    boolean locked=readLocks.aquireReadLock(name);
    if (!locked) {
      throw new FileNotFoundException("Error loading medatada for index file: " + fileKey);
    }
    return new InfinispanIndexInput(cache,fileKey,chunkSize,fileMetadata,readLocks);
  }
}
