{
  Node<K,V> y=x.right;
  if (y != sentinel) {
    while (y.left != sentinel) {
      y=y.left;
    }
    return y;
  }
  y=x.parent;
  while (x == y.right) {
    x=y;
    y=y.parent;
  }
  if (y == root) {
    return sentinel;
  }
  return y;
}
