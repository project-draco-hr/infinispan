{
  DiscoveryKey key=new DiscoveryKey(testName,group_addr);
  ConcurrentMap<Address,TEST_PING> discoveries=all.get(key);
  if (discoveries == null) {
    discoveries=new ConcurrentHashMap<Address,TEST_PING>();
    ConcurrentMap ret=all.putIfAbsent(key,discoveries);
    if (ret != null)     discoveries=ret;
  }
  boolean traceEnabled=log.isTraceEnabled();
  if (traceEnabled)   log.trace(sf("Discoveries for %s are : %s",key,discoveries));
  TEST_PING prev=discoveries.putIfAbsent(local_addr,this);
  if (prev == null && traceEnabled)   log.trace(sf("Add discovery for %s to cache.  The cache now contains: %s",local_addr,discoveries));
  return discoveries;
}
