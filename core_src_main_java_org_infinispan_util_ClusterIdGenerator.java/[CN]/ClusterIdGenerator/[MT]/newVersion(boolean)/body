{
  if (isClustered && versionPrefix.get() == 0)   throw new IllegalStateException("If clustered, Version prefix cannot be 0. Rank calculator probably not in use.");
  long counter=versionCounter.incrementAndGet();
  if (isClustered) {
    return versionPrefix.get() | counter;
  }
 else {
    return counter;
  }
}
