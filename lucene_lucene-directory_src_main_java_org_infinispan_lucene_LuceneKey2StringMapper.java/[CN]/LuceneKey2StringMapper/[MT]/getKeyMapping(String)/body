{
  if (key == null) {
    throw new IllegalArgumentException("Not supporting null keys");
  }
  if (key.startsWith("*|")) {
    return new FileListCacheKey(key.substring(2));
  }
 else {
    String[] split=singlePipePattern.split(key);
    if (split.length != 3 && split.length != 4) {
      throw log.keyMappperUnexpectedStringFormat(key);
    }
 else {
switch (split[1]) {
case "M":
        if (split.length != 3) {
          throw log.keyMappperUnexpectedStringFormat(key);
        }
      return new FileCacheKey(split[2],split[0]);
case "RL":
    if (split.length != 3)     throw log.keyMappperUnexpectedStringFormat(key);
  return new FileReadLockKey(split[2],split[0]);
default :
if (split.length != 4) throw log.keyMappperUnexpectedStringFormat(key);
try {
int chunkId=Integer.parseInt(split[1]);
int bufferSize=Integer.parseInt(split[2]);
return new ChunkCacheKey(split[3],split[0],chunkId,bufferSize);
}
 catch (NumberFormatException nfe) {
throw log.keyMappperUnexpectedStringFormat(key);
}
}
}
}
}
