{
  if (cacheQuery == null) {
    cacheQuery=sm.getQuery(parsingResult.getQuery(),parsingResult.getTargetEntity());
    if (parsingResult.getSort() != null) {
      cacheQuery=cacheQuery.sort(parsingResult.getSort());
    }
    if (parsingResult.getProjections() != null && !parsingResult.getProjections().isEmpty()) {
      cacheQuery=cacheQuery.projection(parsingResult.getProjections().toArray(new String[parsingResult.getProjections().size()]));
    }
    if (startOffset > 0) {
      cacheQuery=cacheQuery.firstResult((int)startOffset);
    }
    if (maxResults > 0) {
      cacheQuery=cacheQuery.maxResults(maxResults);
    }
  }
  return cacheQuery;
}
