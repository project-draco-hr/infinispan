{
  ConfigurationBuilder configurationBuilder=new ConfigurationBuilder();
  boolean isClustered=cacheManager.getGlobalComponentRegistry().getGlobalConfiguration().isClustered();
  configurationBuilder.clustering().cacheMode(isClustered ? CacheMode.REPL_SYNC : CacheMode.LOCAL);
  configurationBuilder.transaction().transactionMode(TransactionMode.TRANSACTIONAL);
  configurationBuilder.clustering().stateTransfer().fetchInMemoryState(true);
  return configurationBuilder.build();
}
