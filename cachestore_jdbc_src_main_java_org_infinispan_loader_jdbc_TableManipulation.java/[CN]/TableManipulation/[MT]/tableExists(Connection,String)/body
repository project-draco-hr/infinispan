{
  assrtNotNull(tableName,"table name is mandatory");
  ResultSet rs=null;
  try {
    DatabaseMetaData dmd=connection.getMetaData();
    String catalog=connection.getCatalog();
    String schema=null;
    String quote=dmd.getIdentifierQuoteString();
    if (tableName.startsWith(quote)) {
      if (!tableName.endsWith(quote)) {
        throw new IllegalStateException("Mismatched quote in table name: " + tableName);
      }
      int quoteLength=quote.length();
      tableName=tableName.substring(quoteLength,tableName.length() - quoteLength);
      if (dmd.storesLowerCaseQuotedIdentifiers()) {
        tableName=toLowerCase(tableName);
      }
 else       if (dmd.storesUpperCaseQuotedIdentifiers()) {
        tableName=toUpperCase(tableName);
      }
    }
 else {
      if (dmd.storesLowerCaseIdentifiers()) {
        tableName=toLowerCase(tableName);
      }
 else       if (dmd.storesUpperCaseIdentifiers()) {
        tableName=toUpperCase(tableName);
      }
    }
    int dotIndex;
    if ((dotIndex=tableName.indexOf('.')) != -1) {
      schema=tableName.substring(0,dotIndex);
      tableName=tableName.substring(dotIndex + 1);
    }
    rs=dmd.getTables(catalog,schema,tableName,null);
    return rs.next();
  }
 catch (  SQLException e) {
    throw new IllegalStateException("Error while checking if table aleady exists " + tableName,e);
  }
 finally {
    JdbcUtil.safeClose(rs);
  }
}
