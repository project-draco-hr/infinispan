{
  if (lockAndRecord(key,ctx,timeoutMillis)) {
    ctx.addLockedKey(key);
    return true;
  }
 else {
    Object owner=getOwner(key);
    if (key instanceof MarshalledValue) {
      key=((MarshalledValue)key).get();
    }
    throw log.unableToAcquireLock(Util.prettyPrintTime(timeoutMillis),key,ctx.getLockOwner(),owner,ctx.getOrigin());
  }
}
