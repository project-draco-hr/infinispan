{
  if ((subjectMask & perm.getMask()) != perm.getMask()) {
    if (System.getSecurityManager() == null) {
      try {
        if (subject == null) {
          AccessController.getContext().checkPermission(perm.getSecurityPermission());
        }
 else {
          throw new AccessControlException(perm.toString());
        }
      }
 catch (      AccessControlException ace) {
        audit.audit(subject,context,name,perm,AuditResponse.DENY);
        throw log.unauthorizedAccess(String.valueOf(subject),perm.toString());
      }
    }
 else {
      System.getSecurityManager().checkPermission(perm.getSecurityPermission());
    }
  }
  audit.audit(subject,context,name,perm,AuditResponse.ALLOW);
}
