{
  Map<Address,Set<Integer>> targets=new ConcurrentHashMap<>();
  List<Address> addresses=ch.getMembers();
  for (  Address address : addresses) {
    if (address.equals(localAddress)) {
      continue;
    }
    Set<Integer> theirSegments=ch.getPrimarySegmentsForOwner(address);
    if (segments != null && theirSegments.retainAll(segments) && theirSegments.isEmpty()) {
      continue;
    }
    targets.put(address,theirSegments);
  }
  return targets;
}
