{
  ThreadFactory tf=new ThreadFactory(){
    @Override public Thread newThread(    Runnable r){
      return new Thread(r,"KeyGeneratorThread");
    }
  }
;
  filter=new ArrayList<Address>();
  filter.add(caches.get(0).getAdvancedCache().getRpcManager().getTransport().getAddress());
  filter.add(caches.get(1).getAdvancedCache().getRpcManager().getTransport().getAddress());
  cacheManager=caches.get(0).getCacheManager();
  keyAffinityService=(KeyAffinityServiceImpl)KeyAffinityServiceFactory.newKeyAffinityService(cacheManager.getCache(cacheName),filter,new RndKeyGenerator(),Executors.newSingleThreadExecutor(tf),100);
}
