{
  Transport transport=getTransport();
  try {
    long messageId=writeHeader(transport,STATS_REQUEST);
    readHeaderAndValidate(transport,messageId,STATS_RESPONSE);
    int nrOfStats=transport.readVInt();
    Map<String,Number> result=new HashMap<String,Number>();
    for (int i=0; i < nrOfStats; i++) {
      String statName=transport.readString();
      Long statValue=transport.readVLong();
      result.put(statName,statValue);
    }
    return result;
  }
  finally {
    releaseTransport(transport);
  }
}
