{
  short respStatus=readHeaderAndValidate(transport,messageId,REPLACE_IF_UNMODIFIED_RESPONSE);
  VersionedOperationResponse.RspCode code;
  if (respStatus == NO_ERROR_STATUS) {
    code=VersionedOperationResponse.RspCode.SUCCESS;
  }
 else   if (respStatus == NOT_PUT_REMOVED_REPLACED_STATUS) {
    code=VersionedOperationResponse.RspCode.MODIFIED_KEY;
  }
 else   if (respStatus == KEY_DOES_NOT_EXIST_STATUS) {
    code=VersionedOperationResponse.RspCode.NO_SUCH_KEY;
  }
 else {
    throw new IllegalStateException("Unknown response status: " + Integer.toHexString(respStatus));
  }
  byte[] prevValue=returnPossiblePrevValue(transport,flags);
  return new VersionedOperationResponse(prevValue,code);
}
