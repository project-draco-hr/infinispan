{
  long messageId=writeHeader(transport,opCode,flags);
  transport.writeByteArray(key);
  transport.writeVInt(lifespan);
  transport.writeVInt(maxIdle);
  transport.writeByteArray(value);
  transport.flush();
  short status=readHeaderAndValidate(transport,messageId,opCode,opRespCode);
  checkForErrorsInResponseStatus(status,messageId,transport);
  return status;
}
