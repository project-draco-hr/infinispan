{
  if (context.getAvailabilityMode() != AvailabilityMode.AVAILABLE) {
    log.debugf("Cache %s is not available, ignoring graceful leaver %s",context.getCacheName(),leaver);
    return;
  }
  CacheTopology currentTopology=context.getCurrentTopology();
  List<Address> newMembers=new ArrayList<>(currentTopology.getMembers());
  newMembers.retainAll(context.getExpectedMembers());
  if (isDataLost(context.getStableTopology().getCurrentCH(),newMembers)) {
    log.enteringUnavailableModeGracefulLeaver(context.getCacheName(),leaver);
    context.updateAvailabilityMode(AvailabilityMode.UNAVAILABLE);
    return;
  }
  updateMembersAndRebalance(context,newMembers);
}
