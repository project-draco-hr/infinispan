{
  if (enabled) {
    loggingLock.readLock().lock();
    try {
      if (enabled) {
        if (command.isOnePhaseCommit()) {
          if (trace)           log.trace("Logging 1PC prepare for tx {0}",command.getGlobalTransaction());
          logModificationsInTransaction(command);
        }
 else {
          if (trace)           log.trace("Logging 2PC prepare for tx {0}",command.getGlobalTransaction());
          uncommittedPrepares.put(command.getGlobalTransaction(),command);
        }
      }
    }
  finally {
      loggingLock.readLock().unlock();
    }
  }
}
