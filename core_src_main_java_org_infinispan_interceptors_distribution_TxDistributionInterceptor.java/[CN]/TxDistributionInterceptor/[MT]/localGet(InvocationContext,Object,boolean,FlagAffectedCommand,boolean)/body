{
  InternalCacheEntry ice=fetchValueLocallyIfAvailable(dm.getReadConsistentHash(),key);
  if (ice != null) {
    if (isWrite && isPessimisticCache && ctx.isInTxScope()) {
      ((TxInvocationContext)ctx).addAffectedKey(key);
    }
    if (!ctx.replaceValue(key,ice)) {
      if (isWrite)       entryFactory.wrapEntryForPut(ctx,key,ice,false,command,false);
 else       ctx.putLookedUpEntry(key,ice);
    }
    return isGetCacheEntry ? ice : ice.getValue();
  }
  return null;
}
