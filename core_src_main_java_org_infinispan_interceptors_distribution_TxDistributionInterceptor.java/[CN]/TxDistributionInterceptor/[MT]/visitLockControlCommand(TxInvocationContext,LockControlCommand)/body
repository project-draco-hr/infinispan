{
  if (ctx.isOriginLocal()) {
    final Collection<Address> affectedNodes=cdl.getOwners(filterDeltaCompositeKeys(command.getKeys()));
    ((LocalTxInvocationContext)ctx).remoteLocksAcquired(affectedNodes == null ? dm.getConsistentHash().getMembers() : affectedNodes);
    log.tracef("Registered remote locks acquired %s",affectedNodes);
    RpcOptions rpcOptions=rpcManager.getRpcOptionsBuilder(ResponseMode.SYNCHRONOUS_IGNORE_LEAVERS,DeliverOrder.NONE).build();
    Map<Address,Response> responseMap=rpcManager.invokeRemotely(affectedNodes,command,rpcOptions);
    checkTxCommandResponses(responseMap,command,(LocalTxInvocationContext)ctx,((LocalTxInvocationContext)ctx).getRemoteLocksAcquired());
  }
  return ctx.continueInvocation();
}
