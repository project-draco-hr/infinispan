{
  Bucket bucket=null;
  InputStream is=null;
  ObjectInputStream ois=null;
  String key=s3Object.getKey();
  try {
    if (s3Object.getDataInputStream() == null) {
      s3Object=s3Connection.getObjectInBucket(key,rootS3Bucket);
    }
    if (s3Object != null && s3Object.getDataInputStream() != null) {
      is=s3Object.getDataInputStream();
      ois=new ObjectInputStream(is);
      bucket=(Bucket)ois.readObject();
      s3Object.closeDataInputStream();
      bucket.setBucketName(s3Object.getKey());
    }
  }
 catch (  Exception e) {
    throw convertToCacheLoaderException("Error while reading from object: " + key,e);
  }
 finally {
    safeClose(ois);
    safeClose(is);
  }
  return bucket;
}
