{
  byte magic=transport.readByte();
  if (magic != RESPONSE_MAGIC) {
    throw new InvalidResponseException("Invalid magic number. Expected " + RESPONSE_MAGIC + " and received "+ Integer.toHexString(magic));
  }
  long receivedMessageId=transport.readVLong();
  if (receivedMessageId != messageId) {
    throw new InvalidResponseException("Invalid message id. Expected " + messageId + " and received "+ Long.toHexString(receivedMessageId));
  }
  byte receivedOpCode=transport.readByte();
  if (receivedOpCode != opCode) {
    throw new InvalidResponseException("Invalid response operation. Expected " + opCode + " and received "+ Integer.toHexString(receivedOpCode));
  }
  return transport.readByte();
}
