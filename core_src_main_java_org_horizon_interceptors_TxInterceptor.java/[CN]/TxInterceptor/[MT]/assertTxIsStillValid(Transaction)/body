{
  if (!TransactionTable.isActive(tx)) {
    try {
      throw new ReplicationException("prepare() failed -- local transaction status is not STATUS_ACTIVE; is " + tx.getStatus());
    }
 catch (    SystemException e) {
      throw new ReplicationException("prepare() failed -- local transaction status is not STATUS_ACTIVE; Unable to retrieve transaction status.");
    }
  }
}
