{
  try {
    byte[] keyBytes=marshall(key);
    semaphore.acquire();
    try {
      if (stopped) {
        throw new PersistenceException("LevelDB is stopped");
      }
      if (db.get(keyBytes) == null) {
        return false;
      }
      db.delete(keyBytes);
    }
  finally {
      semaphore.release();
    }
    return true;
  }
 catch (  Exception e) {
    throw new PersistenceException(e);
  }
}
