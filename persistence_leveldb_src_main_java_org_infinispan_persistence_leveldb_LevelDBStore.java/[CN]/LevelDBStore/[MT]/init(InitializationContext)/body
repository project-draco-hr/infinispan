{
  this.configuration=ctx.getConfiguration();
  this.dbFactory=newDbFactory();
  this.ctx=ctx;
  this.semaphore=new Semaphore(Integer.MAX_VALUE,true);
  if (this.dbFactory == null) {
    throw log.cannotLoadlevelDBFactories(Arrays.toString(DB_FACTORY_CLASS_NAMES));
  }
  String dbFactoryClassName=this.dbFactory.getClass().getName();
  if (dbFactoryClassName.equals("org.iq80.leveldb.impl.Iq80DBFactory")) {
    log.infoUsingJavaDbFactory(dbFactoryClassName);
  }
 else {
    log.infoUsingJNIDbFactory(dbFactoryClassName);
  }
}
