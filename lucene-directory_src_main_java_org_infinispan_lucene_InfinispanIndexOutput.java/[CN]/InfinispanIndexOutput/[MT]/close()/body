{
  storeCurrentBuffer();
  if (transactionRunning) {
    cache.endBatch(true);
    transactionRunning=false;
  }
  positionInBuffer=0;
  filePosition=0;
  buffer=null;
  if (trace) {
    log.trace("Closed IndexOutput for file:{0} in index: {1}",fileKey.getFileName(),fileKey.getIndexName());
  }
}
