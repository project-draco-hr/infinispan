{
  CacheStatus cacheStatus=cacheStatusMap.get(cacheName);
  if (partitionTopologies.isEmpty())   return;
  int unionTopologyId=0;
  ConsistentHash currentCHUnion=null;
  ConsistentHash pendingCHUnion=null;
  ConsistentHashFactory chFactory=cacheStatus.joinInfo.getConsistentHashFactory();
  for (  CacheTopology topology : partitionTopologies) {
    if (topology.getTopologyId() > unionTopologyId) {
      unionTopologyId=topology.getTopologyId();
    }
    if (currentCHUnion == null) {
      currentCHUnion=topology.getCurrentCH();
      pendingCHUnion=topology.getPendingCH();
    }
 else {
      currentCHUnion=chFactory.union(currentCHUnion,topology.getCurrentCH());
      pendingCHUnion=chFactory.union(pendingCHUnion,topology.getPendingCH());
    }
  }
synchronized (cacheStatus) {
    cacheStatus.cacheTopology=new CacheTopology(unionTopologyId,currentCHUnion,pendingCHUnion);
    clusterTopologyManager.updateConsistentHash(cacheName,cacheStatus.cacheTopology);
  }
}
