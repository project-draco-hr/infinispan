{
  log.debugf("Wait for on-going transactions to finish for %d seconds.",TimeUnit.MILLISECONDS.toSeconds(configuration.getCacheStopTimeout()));
  long failTime=System.currentTimeMillis() + configuration.getCacheStopTimeout();
  boolean txsOnGoing=areTxsOnGoing();
  while (txsOnGoing && System.currentTimeMillis() < failTime) {
    try {
      Thread.sleep(100);
      txsOnGoing=areTxsOnGoing();
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      if (clustered) {
        log.debugf("Interrupted waiting for on-going transactions to finish. %s local transactions and %s remote transactions",localTransactions.size(),remoteTransactions.size());
      }
 else {
        log.debugf("Interrupted waiting for %s on-going transactions to finish.",localTransactions.size());
      }
    }
  }
  if (txsOnGoing) {
    log.unfinishedTransactionsRemain(localTransactions,remoteTransactions);
  }
 else {
    log.trace("All transactions terminated");
  }
}
