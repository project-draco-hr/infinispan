{
  final int concurrencyLevel=configuration.getConcurrencyLevel();
  localTransactions=new ConcurrentHashMap<Transaction,LocalTransaction>(concurrencyLevel,0.75f,concurrencyLevel);
  if (configuration.getCacheMode().isClustered()) {
    minViewRecalculationLock=new ReentrantLock();
    remoteTransactions=new ConcurrentHashMap<GlobalTransaction,RemoteTransaction>(concurrencyLevel,0.75f,concurrencyLevel);
    cleanupService.start(configuration,rpcManager,invoker);
    cm.addListener(cleanupService);
    cm.addListener(this);
    notifier.addListener(cleanupService);
    minTxViewId=rpcManager.getTransport().getViewId();
    currentViewId=minTxViewId;
    log.debugf("Min view id set to %s",minTxViewId);
    clustered=true;
  }
}
