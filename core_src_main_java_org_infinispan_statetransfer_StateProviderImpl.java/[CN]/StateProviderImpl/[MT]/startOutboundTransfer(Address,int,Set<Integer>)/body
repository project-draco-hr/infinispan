{
  log.tracef("Starting outbound transfer of segments %s to node %s with topology id %d",segments,destination,requestTopologyId);
  if (requestTopologyId < topologyId) {
    log.warnf("Segments were requested by node %s with topology %d, smaller than the local " + "topology (%d)",destination,requestTopologyId,topologyId);
  }
 else   if (requestTopologyId > topologyId) {
    log.tracef("Segments were requested by node %s with topology %d, greater than the local " + "topology (%d). Waiting for topology %d to be installed locally.",destination,requestTopologyId,topologyId,requestTopologyId);
    stateTransferLock.waitForTopology(requestTopologyId);
  }
  OutboundTransferTask outboundTransfer=new OutboundTransferTask(destination,segments,chunkSize,topologyId,readCh,this,dataContainer,cacheLoaderManager,rpcManager,commandsFactory,timeout,cacheName);
  addTransfer(outboundTransfer);
  outboundTransfer.execute(executorService);
}
