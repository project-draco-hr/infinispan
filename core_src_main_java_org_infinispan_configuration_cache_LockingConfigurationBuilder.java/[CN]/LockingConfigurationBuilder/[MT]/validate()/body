{
  if (writeSkewCheck) {
    if (isolationLevel != IsolationLevel.REPEATABLE_READ)     throw new ConfigurationException("Write-skew checking only allowed with REPEATABLE_READ isolation level for cache");
    if (transaction().lockingMode != LockingMode.OPTIMISTIC)     throw new ConfigurationException("Write-skew checking only allowed with OPTIMISTIC transactions");
    if (!versioning().enabled || versioning().scheme != VersioningScheme.SIMPLE)     throw new ConfigurationException("Write-skew checking requires versioning to be enabled and versioning scheme 'SIMPLE' to be configured");
    if (clustering().cacheMode() != CacheMode.DIST_SYNC && clustering().cacheMode() != CacheMode.REPL_SYNC && clustering().cacheMode() != CacheMode.LOCAL)     throw new ConfigurationException("Write-skew checking is only supported in REPL_SYNC, DIST_SYNC and LOCAL modes.  " + clustering().cacheMode() + " cannot be used with write-skew checking");
  }
  if (getBuilder().clustering().cacheMode().isClustered() && isolationLevel == IsolationLevel.NONE)   isolationLevel=IsolationLevel.READ_COMMITTED;
  if (isolationLevel == IsolationLevel.READ_UNCOMMITTED)   isolationLevel=IsolationLevel.READ_COMMITTED;
  if (isolationLevel == IsolationLevel.SERIALIZABLE)   isolationLevel=IsolationLevel.REPEATABLE_READ;
}
