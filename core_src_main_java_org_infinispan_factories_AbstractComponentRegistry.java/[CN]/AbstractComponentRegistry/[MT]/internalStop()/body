{
  state=ComponentStatus.STOPPING;
  removeShutdownHook();
  List<PrioritizedMethod> stopMethods=new ArrayList<PrioritizedMethod>(componentLookup.size());
  for (  Component c : componentLookup.values()) {
    Collections.addAll(stopMethods,c.stopMethods);
  }
  Collections.sort(stopMethods);
  boolean traceEnabled=getLog().isTraceEnabled();
  for (  PrioritizedMethod em : stopMethods) {
    if (traceEnabled)     getLog().tracef("Invoking stop method %s on component %s",em.metadata.getMethod(),em.component.getName());
    em.invoke();
  }
  destroy();
}
