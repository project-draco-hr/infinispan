{
  if (component == null)   throw new NullPointerException("Cannot register a null component under name [" + name + "]");
  Component old=componentLookup.get(name);
  if (old != null) {
    if (old.instance.equals(component)) {
      getLog().trace("Attempting to register a component equal to one that already exists under the same name ({0}).  Not doing anything.",name);
      return;
    }
  }
  Component c;
  if (old != null) {
    getLog().trace("Replacing old component {0} with new instance {1}",old,component);
    old.instance=component;
    old.methodsScanned=false;
    c=old;
    if (state == ComponentStatus.RUNNING)     populateLifecycleMethods();
  }
 else {
    c=new Component();
    c.name=name;
    c.instance=component;
    componentLookup.put(name,c);
  }
  c.nonVolatile=ReflectionUtil.isAnnotationPresent(component.getClass(),NonVolatile.class);
  addComponentDependencies(c);
  c.injectDependencies();
  if (old != null)   getLog().trace("Registering component {0} under name {1}",c,name);
}
