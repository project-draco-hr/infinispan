{
  final NotifyingFutureImpl<V> result=new NotifyingFutureImpl<V>();
  final InvocationContext ctx=getInvocationContextWithImplicitTransactionForAsyncOps(false,explicitClassLoader,1);
  Future<V> returnValue=asyncExecutor.submit(new Callable<V>(){
    @Override public V call() throws Exception {
      try {
        associateImplicitTransactionWithCurrentThread(ctx);
        V retval=putInternal(key,value,metadata,explicitFlags,ctx);
        try {
          result.notifyDone(retval);
          log.trace("Finished notifying");
        }
 catch (        Throwable e) {
          log.trace("Exception while notifying the future",e);
        }
        return retval;
      }
 catch (      Exception e) {
        try {
          result.notifyException(e);
          log.trace("Finished notifying");
        }
 catch (        Throwable e2) {
          log.trace("Exception while notifying the future",e2);
        }
        throw e;
      }
    }
  }
);
  result.setFuture(returnValue);
  return result;
}
