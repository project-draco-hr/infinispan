{
  CacheTopologyHandler handler=runningCaches.get(cacheName);
  try {
    handler.rebalance(topologyId,pendingCH);
  }
  finally {
    ReplicableCommand command=new CacheTopologyControlCommand(cacheName,CacheTopologyControlCommand.Type.REBALANCE_CONFIRM,transport.getAddress(),null);
    try {
      executeOnCoordinatorAsync(command);
    }
 catch (    Exception e) {
      log.debugf(e,"Error sending the rebalance completed notification for cache %s to coordinator",cacheName);
    }
  }
}
