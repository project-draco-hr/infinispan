{
  if (!running) {
    log.debugf("Ignoring rebalance request %s for cache %s, the local cache manager is not running",cacheTopology.getTopologyId(),cacheName);
    return;
  }
  final LocalCacheStatus cacheStatus=runningCaches.get(cacheName);
  if (cacheStatus == null) {
    log.tracef("Ignoring rebalance %s for cache %s that doesn't exist locally",cacheTopology.getTopologyId(),cacheName);
    return;
  }
  cacheStatus.getTopologyUpdatesCompletionService().submit(new Runnable(){
    @Override public void run(){
      try {
        doHandleRebalance(viewId,cacheStatus,cacheTopology,cacheName,sender);
      }
 catch (      Throwable t) {
        log.rebalanceStartError(cacheName,t);
      }
    }
  }
,null);
}
