{
  LocalCacheStatus cacheStatus=runningCaches.get(cacheName);
  if (cacheStatus == null) {
    log.tracef("Ignoring rebalance %s for cache %s that doesn't exist locally",cacheTopology.getTopologyId(),cacheName);
    return;
  }
  log.debugf("Starting local rebalance for cache %s, topology = %s",cacheName,cacheTopology);
synchronized (cacheStatus) {
    cacheStatus.setTopology(cacheTopology);
  }
  ConsistentHash unionCH=cacheStatus.getJoinInfo().getConsistentHashFactory().union(cacheTopology.getCurrentCH(),cacheTopology.getPendingCH());
  CacheTopologyHandler handler=cacheStatus.getHandler();
  handler.rebalance(new CacheTopology(cacheTopology.getTopologyId(),cacheTopology.getCurrentCH(),unionCH));
}
