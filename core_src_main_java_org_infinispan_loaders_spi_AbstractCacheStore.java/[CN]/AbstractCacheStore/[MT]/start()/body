{
  if (configuration == null)   throw new IllegalStateException("Make sure you call super.init() from CacheStore " + "extension");
  if (configuration.purgeSynchronously()) {
    purgerService=new WithinThreadExecutor();
  }
 else {
    multiThreadedPurge=supportsMultiThreadedPurge() && configuration.purgerThreads() > 1;
    final String loaderName=getClass().getSimpleName();
    purgerService=Executors.newFixedThreadPool(supportsMultiThreadedPurge() ? configuration.purgerThreads() : 1,new ThreadFactory(){
      @Override public Thread newThread(      Runnable r){
        Thread t=new Thread(r,(cache == null ? "" : cache.getName() + '-') + loaderName + '-'+ THREAD_COUNTER.getAndIncrement());
        t.setDaemon(true);
        return t;
      }
    }
);
  }
  transactions=CollectionFactory.makeConcurrentMap(64,getConcurrencyLevel());
}
