{
  MapReduceTask mapReduceTask=new MapReduceTask<>((Cache<?,?>)binding.get(SystemBindings.CACHE.toString()));
  mapReduceTask.mappedWith(new MapperScript<>(metadata));
  String reducerScript=metadata.property(MetadataProperties.REDUCER);
  if (reducerScript != null) {
    mapReduceTask.reducedWith(new ReducerScript<>(scriptManager.getScriptMetadata(reducerScript)));
  }
  String combinerScript=metadata.property(MetadataProperties.COMBINER);
  if (combinerScript != null) {
    mapReduceTask.combinedWith(new ReducerScript<>(scriptManager.getScriptMetadata(combinerScript)));
  }
  String collatorScript=metadata.property(MetadataProperties.COLLATOR);
  if (collatorScript != null) {
    return (NotifyingFuture<T>)mapReduceTask.executeAsynchronously(new CollatorScript<>(scriptManager.getScriptMetadata(collatorScript),scriptManager));
  }
 else {
    return (NotifyingFuture<T>)mapReduceTask.executeAsynchronously();
  }
}
