{
  GlobalConfigurationBuilder globalConfigurationBuilder=new GlobalConfigurationBuilder();
  globalConfigurationBuilder.globalJmxStatistics().enable().jmxDomain("org.infinispan");
  withCacheManager(new CacheManagerCallable(TestCacheManagerFactory.createCacheManager(globalConfigurationBuilder,new ConfigurationBuilder())){
    @Override public void call(){
      ConfigurationBuilder configurationBuilder=new ConfigurationBuilder();
      configurationBuilder.jmxStatistics().enable();
      configurationBuilder.eviction().maxEntries(123);
      configurationBuilder.expiration().maxIdle(180000);
      cm.defineConfiguration(MY_CUSTOM_CACHE,configurationBuilder.build());
      Cache<String,String> cache=cm.getCache(MY_CUSTOM_CACHE);
      cache.put("myKey","myValue");
      int i=0;
      while (i < Integer.MAX_VALUE) {
        try {
          Thread.sleep(12000);
        }
 catch (        InterruptedException e) {
          Thread.currentThread().interrupt();
        }
        cache.put("key" + i,String.valueOf(i));
        cache.get("key" + ((int)(10000 * Math.random())));
        i++;
        if (i % 10 == 0) {
          System.out.print(".");
          System.out.flush();
        }
      }
    }
  }
);
}
