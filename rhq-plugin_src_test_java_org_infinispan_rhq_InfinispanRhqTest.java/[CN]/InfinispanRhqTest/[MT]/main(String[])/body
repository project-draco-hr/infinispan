{
  GlobalConfiguration myGlobalConfig=new GlobalConfiguration();
  myGlobalConfig.setJmxDomain("org.infinispan");
  myGlobalConfig.setExposeGlobalJmxStatistics(true);
  withCacheManager(new CacheManagerCallable(TestCacheManagerFactory.createCacheManager(myGlobalConfig)){
    @Override public void call(){
      Configuration config=new Configuration();
      config.setExposeJmxStatistics(true);
      config.setEvictionMaxEntries(123);
      config.setExpirationMaxIdle(180000);
      cm.defineConfiguration(MY_CUSTOM_CACHE,config);
      Cache<String,String> cache=cm.getCache(MY_CUSTOM_CACHE);
      cache.put("myKey","myValue");
      int i=0;
      while (i < Integer.MAX_VALUE) {
        try {
          Thread.sleep(12000);
        }
 catch (        InterruptedException e) {
          Thread.currentThread().interrupt();
        }
        cache.put("key" + i,String.valueOf(i));
        cache.get("key" + ((int)(10000 * Math.random())));
        i++;
        if (i % 10 == 0) {
          System.out.print(".");
          System.out.flush();
        }
      }
    }
  }
);
}
