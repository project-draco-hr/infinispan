{
  if (advancedCache instanceof CacheAdapter) {
    return (CacheAdapter<K,V>)advancedCache;
  }
 else   if (advancedCache instanceof DecoratedCache) {
    DecoratedCache dc=(DecoratedCache)advancedCache;
    Cache<K,V> delegate=dc.getDelegate();
    if (delegate instanceof AdvancedCache)     return new DecoratedCacheAdapter<K,V>((AdvancedCache)delegate,tcc,dc.getFlags());
 else     return new DecoratedCacheAdapter<K,V>(delegate.getAdvancedCache(),tcc,dc.getFlags());
  }
 else {
    return new CacheAdapter<K,V>(advancedCache,tcc);
  }
}
