{
  int numSegments=baseCH.getNumSegments();
  List<Address> leavers=new ArrayList<Address>(baseCH.getMembers());
  leavers.removeAll(newMembers);
  boolean segmentsWithZeroOwners=false;
  List<Address>[] newSegmentOwners=new List[numSegments];
  for (int i=0; i < numSegments; i++) {
    List<Address> owners=baseCH.locateOwnersForSegment(i);
    owners.removeAll(leavers);
    segmentsWithZeroOwners|=owners.isEmpty();
    newSegmentOwners[i]=owners;
  }
  if (segmentsWithZeroOwners) {
    assignSegmentsWithZeroOwners(baseCH,newMembers,newSegmentOwners);
  }
  return new DefaultConsistentHash(baseCH.getHashFunction(),numSegments,baseCH.getNumOwners(),newMembers,newSegmentOwners);
}
