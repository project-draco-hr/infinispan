{
  List<Address> newPrimaryOwners=new LinkedList<Address>();
  int[] toAdd=new int[nodes.size()];
  for (int i=0; i < nodes.size(); i++) {
    Address node=nodes.get(i);
    toAdd[i]=expectedPrimaryOwned.get(node) - stats.getPrimaryOwned(node);
  }
  boolean changed=true;
  while (changed) {
    changed=false;
    for (int i=0; i < nodes.size(); i++) {
      if (toAdd[i] > 0) {
        newPrimaryOwners.add(nodes.get(i));
        toAdd[i]--;
        changed=true;
      }
    }
  }
  return newPrimaryOwners;
}
