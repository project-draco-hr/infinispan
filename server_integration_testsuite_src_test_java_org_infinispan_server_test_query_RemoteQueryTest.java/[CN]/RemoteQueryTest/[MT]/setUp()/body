{
  jmxConnectionProvider=new MBeanServerConnectionProvider(getServer().getHotrodEndpoint().getInetAddress().getHostName(),9999);
  rcmFactory=new RemoteCacheManagerFactory();
  ConfigurationBuilder clientBuilder=new ConfigurationBuilder();
  clientBuilder.addServer().host(getServer().getHotrodEndpoint().getInetAddress().getHostName()).port(getServer().getHotrodEndpoint().getPort()).marshaller(new ProtoStreamMarshaller());
  remoteCacheManager=rcmFactory.createManager(clientBuilder);
  remoteCache=remoteCacheManager.getCache(cacheName);
  String mbean="jboss.infinispan:type=RemoteQuery,name=" + ObjectName.quote(cacheContainerName) + ",component=ProtobufMetadataManager";
  byte[] descriptor=readClasspathResource("/sample_bank_account/bank.protobin");
  invokeOperation(jmxConnectionProvider,mbean,"registerProtofile",new Object[]{descriptor},new String[]{byte[].class.getName()});
  MarshallerRegistration.registerMarshallers(ProtoStreamMarshaller.getSerializationContext(remoteCacheManager));
}
