{
  if (row.length != rowLength) {
    throw new IllegalArgumentException("Row length mismatch");
  }
  if (groupFieldPositions != null) {
    GroupRowKey groupRowKey=new GroupRowKey(row,groupFieldPositions);
    Object[] existingGroup=groups.get(groupRowKey);
    if (existingGroup == null) {
      if (accumulators != null) {
        for (        FieldAccumulator acc : accumulators) {
          acc.init(row);
        }
      }
      groups.put(groupRowKey,row);
    }
 else {
      if (accumulators != null) {
        for (        FieldAccumulator acc : accumulators) {
          acc.update(row,existingGroup);
        }
      }
    }
  }
 else {
    if (globalGroup == null) {
      globalGroup=row;
      for (      FieldAccumulator acc : accumulators) {
        acc.init(row);
      }
    }
 else {
      for (      FieldAccumulator acc : accumulators) {
        acc.update(row,globalGroup);
      }
    }
  }
}
