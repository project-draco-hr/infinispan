{
  try {
    Set<InternalCacheEntry> entries=new HashSet<InternalCacheEntry>();
    for (    InternalCacheEntry e : dataContainer) {
      if (!e.isExpired())       entries.add(e);
    }
    if (log.isDebugEnabled())     log.debugf("Writing %s StoredEntries to stream",entries.size());
    marshaller.objectToObjectStream(entries,oo);
  }
 catch (  Exception e) {
    throw new StateTransferException(e);
  }
}
