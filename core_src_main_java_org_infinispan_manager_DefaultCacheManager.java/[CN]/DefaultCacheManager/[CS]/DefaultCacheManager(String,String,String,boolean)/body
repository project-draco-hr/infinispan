{
  try {
    InfinispanConfiguration gconfiguration=InfinispanConfiguration.newInfinispanConfiguration(globalConfigurationFile,InfinispanConfiguration.resolveSchemaPath(),Thread.currentThread().getContextClassLoader());
    globalConfiguration=gconfiguration.parseGlobalConfiguration();
    globalConfiguration.accept(configurationValidator);
    InfinispanConfiguration dconfiguration=InfinispanConfiguration.newInfinispanConfiguration(defaultConfigurationFile,InfinispanConfiguration.resolveSchemaPath(),Thread.currentThread().getContextClassLoader());
    defaultConfiguration=dconfiguration.parseDefaultConfiguration();
    if (namedCacheFile != null) {
      InfinispanConfiguration NCconfiguration=InfinispanConfiguration.newInfinispanConfiguration(namedCacheFile,InfinispanConfiguration.resolveSchemaPath(),Thread.currentThread().getContextClassLoader());
      for (      Map.Entry<String,Configuration> entry : NCconfiguration.parseNamedConfigurations().entrySet()) {
        Configuration c=defaultConfiguration.clone();
        c.applyOverrides(entry.getValue());
        configurationOverrides.put(entry.getKey(),c);
      }
    }
    globalComponentRegistry=new GlobalComponentRegistry(this.globalConfiguration,this,caches.keySet());
    cacheCreateLock=new ReentrantLock();
  }
 catch (  RuntimeException re) {
    throw new ConfigurationException(re);
  }
  if (start)   start();
}
