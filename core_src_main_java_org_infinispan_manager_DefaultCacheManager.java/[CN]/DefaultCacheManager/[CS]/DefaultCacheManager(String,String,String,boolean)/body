{
  Parser parser=new Parser(Thread.currentThread().getContextClassLoader());
  ConfigurationBuilderHolder globalConfigurationBuilderHolder=parser.parse(globalConfigurationFile);
  ConfigurationBuilderHolder defaultConfigurationBuilderHolder=parser.parse(defaultConfigurationFile);
  globalConfiguration=new LegacyGlobalConfigurationAdaptor().adapt(globalConfigurationBuilderHolder.getGlobalConfigurationBuilder().build());
  defaultConfiguration=new LegacyConfigurationAdaptor().adapt(defaultConfigurationBuilderHolder.getDefaultConfigurationBuilder().build());
  if (namedCacheFile != null) {
    ConfigurationBuilderHolder namedConfigurationBuilderHolder=parser.parse(namedCacheFile);
    org.infinispan.configuration.cache.Configuration c=namedConfigurationBuilderHolder.getConfigurationBuilders().iterator().next().build();
    defineConfiguration(c.name(),new LegacyConfigurationAdaptor().adapt(c));
  }
  globalComponentRegistry=new GlobalComponentRegistry(this.globalConfiguration,this,caches.keySet());
  cacheCreateLock=new ReentrantLock();
  if (start)   start();
}
