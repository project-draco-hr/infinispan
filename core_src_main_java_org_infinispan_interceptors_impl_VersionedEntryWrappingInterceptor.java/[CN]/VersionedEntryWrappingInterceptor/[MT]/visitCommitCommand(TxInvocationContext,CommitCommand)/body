{
  VersionedCommitCommand versionedCommitCommand=(VersionedCommitCommand)command;
  try {
    if (ctx.isOriginLocal()) {
      versionedCommitCommand.setUpdatedVersions(ctx.getCacheTransaction().getUpdatedEntryVersions());
    }
    return ctx.shortCircuit(ctx.forkInvocationSync(command));
  }
  finally {
    if (!ctx.isOriginLocal()) {
      ctx.getCacheTransaction().setUpdatedEntryVersions(versionedCommitCommand.getUpdatedVersions());
    }
    commitContextEntries(ctx,null,null);
  }
}
