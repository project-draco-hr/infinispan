{
  super.start();
  String location=config.getLocation();
  if (location == null || location.trim().length() == 0) {
    location="Infinispan-FileCacheStore";
  }
  location+=File.separator + cache.getName();
  root=new File(location);
  if (!root.exists()) {
    if (!root.mkdirs()) {
      log.problemsCreatingDirectory(root);
    }
  }
  if (!root.exists()) {
    throw new ConfigurationException("Directory " + root.getAbsolutePath() + " does not exist and cannot be created!");
  }
  streamBufferSize=config.getStreamBufferSize();
switch (config.getFsyncMode()) {
case DEFAULT:
    fileSync=new BufferedFileSync();
  break;
case PER_WRITE:
fileSync=new PerWriteFileSync();
break;
case PERIODIC:
fileSync=new PeriodicFileSync(config.getFsyncInterval());
break;
}
}
