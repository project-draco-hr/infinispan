{
  boolean trace=log.isTraceEnabled();
  JMXComponent parentComponent=ctx.getParentResourceComponent();
  EmsConnection conn=parentComponent.getEmsConnection();
  if (conn != null) {
    if (trace)     log.tracef("Connection to ems server established: %s",conn);
    ObjectNameQueryUtility queryUtility=new ObjectNameQueryUtility(objectName);
    List<EmsBean> beans=conn.queryBeans(queryUtility.getTranslatedQuery());
    if (trace)     log.tracef("Querying [%s] returned beans: %s",queryUtility.getTranslatedQuery(),beans);
    Set<DiscoveredResourceDetails> discoveredResources=new HashSet<DiscoveredResourceDetails>();
    for (    EmsBean bean : beans) {
      String managerName=bean.getBeanName().getCanonicalName();
      String resourceName=bean.getAttribute("Name").getValue().toString();
      String version=bean.getAttribute("Version").getValue().toString();
      if (trace)       log.tracef("Add resource with version '%s' and type %s",version,ctx.getResourceType());
      DiscoveredResourceDetails detail=new DiscoveredResourceDetails(ctx.getResourceType(),resourceName,resourceName,version,"A cache manager within Infinispan",null,null);
      log.discoveredInfinispanInstance(resourceName,managerName);
      discoveredResources.add(detail);
    }
    return discoveredResources;
  }
 else {
    log.debug("Unable to establish connection");
    return null;
  }
}
