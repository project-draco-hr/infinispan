{
  Transport transport=getTransport(key,true);
  int retryCount=0;
  do {
    try {
      try {
        short status=sendKeyOperation(key,transport,GET_REQUEST,flags,GET_RESPONSE);
        if (status == KEY_DOES_NOT_EXIST_STATUS) {
          return null;
        }
        if (status == NO_ERROR_STATUS) {
          return transport.readArray();
        }
      }
  finally {
        releaseTransport(transport);
      }
    }
 catch (    TransportException te) {
      logErrorAndThrowExceptionIfNeeded(retryCount,te);
    }
    if (shouldRetry(retryCount)) {
      transport=getTransport(key,false);
    }
    retryCount++;
  }
 while (shouldRetry(retryCount));
  throw new IllegalStateException("We should not reach here!");
}
