{
  for (int i=0; i < transportFactory.getTransportCount(); i++) {
    Transport transport=getTransport(key,i == 0);
    try {
      long messageId=HotRodOperationsHelper.writeHeader(transport,REPLACE_IF_UNMODIFIED_REQUEST,cacheName,topologyId,flags);
      transport.writeArray(key);
      transport.writeVInt(lifespan);
      transport.writeVInt(maxIdle);
      transport.writeLong(version);
      transport.writeArray(value);
      return returnVersionedOperationResponse(transport,messageId,REPLACE_IF_UNMODIFIED_RESPONSE,flags);
    }
 catch (    TransportException te) {
      logErrorAndThrowExceptionIfNeeded(i,te);
    }
 finally {
      releaseTransport(transport);
    }
  }
  throw new IllegalStateException(" should not reach here!");
}
