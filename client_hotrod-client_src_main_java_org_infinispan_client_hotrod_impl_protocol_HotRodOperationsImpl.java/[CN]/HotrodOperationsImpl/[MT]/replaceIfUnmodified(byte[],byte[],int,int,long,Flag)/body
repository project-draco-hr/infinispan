{
  Transport transport=transportFactory.getTransport(key);
  try {
    long messageId=HotRodOperationsHelper.writeHeader(transport,REPLACE_IF_UNMODIFIED_REQUEST,cacheName,topologyId,flags);
    transport.writeArray(key);
    transport.writeVInt(lifespan);
    transport.writeVInt(maxIdle);
    transport.writeLong(version);
    transport.writeArray(value);
    return returnVersionedOperationResponse(transport,messageId,REPLACE_IF_UNMODIFIED_RESPONSE,flags);
  }
  finally {
    releaseTransport(transport);
  }
}
