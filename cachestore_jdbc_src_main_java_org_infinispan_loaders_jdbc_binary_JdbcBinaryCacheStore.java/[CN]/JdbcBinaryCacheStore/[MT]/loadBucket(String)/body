{
  Connection conn=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    String sql=tableManipulation.getSelectRowSql();
    if (log.isTraceEnabled()) {
      log.tracef("Running loadBucket. Sql: '%s', on key: %s",sql,keyHashCode);
    }
    conn=connectionFactory.getConnection();
    ps=conn.prepareStatement(sql);
    ps.setString(1,keyHashCode);
    rs=ps.executeQuery();
    if (!rs.next())     return null;
    String bucketName=rs.getString(1);
    InputStream inputStream=rs.getBinaryStream(2);
    Bucket bucket=(Bucket)JdbcUtil.unmarshall(getMarshaller(),inputStream);
    bucket.setBucketName(bucketName);
    return bucket;
  }
 catch (  SQLException e) {
    log.sqlFailureLoadingKey(keyHashCode,e);
    throw new CacheLoaderException(String.format("Sql failure while loading key: %s",keyHashCode),e);
  }
 finally {
    JdbcUtil.safeClose(rs);
    JdbcUtil.safeClose(ps);
    connectionFactory.releaseConnection(conn);
  }
}
