{
  boolean entryExists=loadedEntry != null;
  if (log.isTraceEnabled()) {
    log.trace("Entry exists in loader? " + entryExists);
  }
  if (getStatisticsEnabled()) {
    if (entryExists) {
      cacheLoads.incrementAndGet();
    }
 else {
      cacheMisses.incrementAndGet();
    }
  }
  if (entryExists) {
    final Object value=loadedEntry.getValue();
    sendNotification(key,value,true,ctx,cmd);
    entry.setValue(value);
    Metadata metadata=cmd.getMetadata();
    Metadata loadedMetadata=loadedEntry.getMetadata();
    if (metadata != null && loadedMetadata != null)     metadata=metadata.builder().read(loadedMetadata).build();
 else     if (metadata == null)     metadata=loadedMetadata;
    entry.setMetadata(metadata);
    entry.setValid(true);
    entry.setLoaded(true);
    sendNotification(key,value,false,ctx,cmd);
  }
}
