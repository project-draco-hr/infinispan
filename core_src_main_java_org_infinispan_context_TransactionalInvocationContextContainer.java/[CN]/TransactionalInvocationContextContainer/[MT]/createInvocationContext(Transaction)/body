{
  if (tx == null)   throw new IllegalArgumentException("Cannot create a transactional context without a valid Transaction instance.");
  LocalTxInvocationContext localContext=new LocalTxInvocationContext();
  LocalTransaction localTransaction=transactionTable.getLocalTransaction(tx);
  localContext.setLocalTransaction(localTransaction);
  localContext.setTransaction(tx);
  ctxHolder.set(localContext);
  return localContext;
}
