{
  for (  Address target : targets) {
    if (leavers.contains(target)) {
      log.debugf("One of the nodes we were supposed to push state to (%s) has already left, cancelling state push",target);
      throw new CacheException("One of the nodes we were supposed to push state to has already left, cancelling state push");
    }
  }
  log.debugf("Pushing to nodes %s %d keys",targets,state.size());
  log.tracef("Pushing to nodes %s keys: %s",targets,keys(state));
  final StateTransferControlCommand cmd=cf.buildStateTransferCommand(StateTransferControlCommand.Type.APPLY_STATE,getAddress(),viewId,state);
  rpcManager.invokeRemotelyInFuture(targets,cmd,false,stateTransferFuture,configuration.getRehashRpcTimeout());
}
