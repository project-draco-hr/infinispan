{
  Address self=getAddress();
  if (trace)   log.tracef("Node %s finished pushing state for view %s, broadcasting push complete signal.",self,viewId);
  pushConfirmations.confirmPush(self,viewId);
  final StateTransferControlCommand cmd=cf.buildStateTransferCommand(StateTransferControlCommand.Type.PUSH_COMPLETED,self,viewId);
  rpcManager.invokeRemotely(null,cmd,ResponseMode.SYNCHRONOUS,configuration.getRehashRpcTimeout());
  boolean clusterPushCompleted=pushConfirmations.waitForClusterToCompletePush(viewId,configuration.getRehashWaitTime());
  if (!clusterPushCompleted) {
    throw new PendingStateTransferException();
  }
}
