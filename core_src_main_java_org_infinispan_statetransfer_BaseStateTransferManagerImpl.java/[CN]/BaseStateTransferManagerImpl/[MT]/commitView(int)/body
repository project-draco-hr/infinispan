{
  if (stateTransferTask == null) {
    if (viewId == oldView.getViewId()) {
      log.tracef("Ignoring commit for cache view %d as we have already committed it",viewId);
      return;
    }
 else {
      throw new IllegalArgumentException(String.format("Cannot commit view %d, we are at view %d",viewId,oldView.getViewId()));
    }
  }
  stateTransferTask.commitStateTransfer();
  stateTransferTask=null;
  endStateTransfer();
}
