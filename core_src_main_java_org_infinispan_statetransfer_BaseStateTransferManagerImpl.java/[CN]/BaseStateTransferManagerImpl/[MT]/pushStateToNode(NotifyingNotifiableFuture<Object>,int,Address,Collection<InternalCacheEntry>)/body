{
  if (leavers.contains(target)) {
    log.debugf("Not pushing state to node %s since it has already left",target);
    return;
  }
  log.debugf("Pushing to node %s %d keys",target,state.size());
  log.tracef("Pushing to node %s keys: %s",target,keys(state));
  final StateTransferControlCommand cmd=cf.buildStateTransferCommand(StateTransferControlCommand.Type.APPLY_STATE,getAddress(),viewId,state);
  rpcManager.invokeRemotelyInFuture(Collections.singleton(target),cmd,false,stateTransferFuture,configuration.getRehashRpcTimeout());
}
