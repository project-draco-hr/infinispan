{
  if (masterCacheNode == null)   throw new IllegalArgumentException("Can not use null cache for MapReduceTask");
  ensureProperCacheState(masterCacheNode.getAdvancedCache());
  this.cache=masterCacheNode.getAdvancedCache();
  this.keys=new LinkedList<KIn>();
  this.marshaller=cache.getComponentRegistry().getComponent(StreamingMarshaller.class,CACHE_MARSHALLER);
  this.mapReduceManager=cache.getComponentRegistry().getComponent(MapReduceManager.class);
  this.taskId=UUID.randomUUID();
  this.distributeReducePhase=distributeReducePhase;
  this.useIntermediateSharedCache=useIntermediateSharedCache;
}
