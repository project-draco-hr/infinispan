{
  rc.init(mapReduceManager);
  Map<KOut,VOut> localReduceResult=null;
  try {
    log.debugf("Invoking %s locally ",rc);
    if (rc.emitsIntoResultingCache()) {
      mapReduceManager.reduce(rc,rc.getResultCacheName());
      localReduceResult=Collections.emptyMap();
    }
 else {
      localReduceResult=mapReduceManager.reduce(rc);
    }
    log.debugf("Invoked %s locally",rc);
  }
 catch (  Throwable e1) {
    throw new MapReduceException("Could not invoke MapReduce task locally ",e1);
  }
  return localReduceResult;
}
