{
  if (cache.getRpcManager() == null)   throw new IllegalStateException("Can not use non-clustered cache for MapReduceTask");
  if (cache.getStatus() != ComponentStatus.RUNNING)   throw new IllegalStateException("Invalid cache state " + cache.getStatus());
  if (cache.getDistributionManager() == null) {
    throw new IllegalStateException("Cache mode should be DIST, rather than " + cache.getConfiguration().getCacheModeString());
  }
}
