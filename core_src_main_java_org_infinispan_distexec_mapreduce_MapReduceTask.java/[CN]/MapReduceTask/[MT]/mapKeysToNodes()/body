{
  DistributionManager dm=cache.getDistributionManager();
  Map<Address,List<KIn>> addressToKey=new HashMap<Address,List<KIn>>();
  for (  KIn key : keys) {
    List<Address> nodesForKey=dm.locate(key);
    Address ownerOfKey=nodesForKey.get(0);
    List<KIn> keysAtNode=addressToKey.get(ownerOfKey);
    if (keysAtNode == null) {
      keysAtNode=new ArrayList<KIn>();
      addressToKey.put(ownerOfKey,keysAtNode);
    }
    keysAtNode.add(key);
  }
  return addressToKey;
}
