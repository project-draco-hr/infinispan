{
  RpcManager rpc=cache.getRpcManager();
  CommandsFactory factory=cache.getComponentRegistry().getComponent(CommandsFactory.class);
  final CreateCacheCommand ccc=factory.buildCreateCacheCommand(tmpCacheName,intermediateCacheConfigurationName,rpc.getMembers().size());
  log.debugf("Invoking %s across members %s ",ccc,cache.getRpcManager().getMembers());
  CompletableFuture<Map<Address,Response>> remoteFuture=rpc.invokeRemotelyAsync(cache.getRpcManager().getMembers(),ccc,rpcOptionsBuilder.build());
  try {
    ccc.init(cache.getCacheManager());
    ccc.perform(null);
  }
 catch (  Throwable e) {
    throw new MapReduceException(e);
  }
  try {
    Map<Address,Response> map=remoteFuture.get();
    for (    Entry<Address,Response> e : map.entrySet()) {
      if (!e.getValue().isSuccessful()) {
        throw new MapReduceException("Could not initialize tmp cache " + tmpCacheName + " at "+ e.getKey()+ " for  "+ this);
      }
    }
  }
 catch (  InterruptedException|ExecutionException e) {
    throw new MapReduceException("Could not initialize temporary caches for MapReduce task on remote nodes ",e);
  }
}
