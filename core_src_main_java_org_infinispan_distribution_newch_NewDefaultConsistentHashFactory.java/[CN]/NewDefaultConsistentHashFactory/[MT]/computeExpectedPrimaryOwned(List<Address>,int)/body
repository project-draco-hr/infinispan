{
  int numNodes=nodes.size();
  Map<Address,Integer> expectedPrimaryOwned=new HashMap<Address,Integer>(numNodes);
  for (int i=0; i < numNodes; i++) {
    if (i < numSegments % numNodes) {
      expectedPrimaryOwned.put(nodes.get(i),numSegments / numNodes + 1);
    }
 else {
      expectedPrimaryOwned.put(nodes.get(i),numSegments / numNodes);
    }
  }
  return expectedPrimaryOwned;
}
