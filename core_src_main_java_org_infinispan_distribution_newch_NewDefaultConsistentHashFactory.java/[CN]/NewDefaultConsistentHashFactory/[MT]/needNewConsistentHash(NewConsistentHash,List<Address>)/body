{
  NewDefaultConsistentHash baseDCH=(NewDefaultConsistentHash)existingCH;
  if (!newMembers.equals(baseDCH.getNodes()))   return true;
  int actualNumOwners=Math.min(baseDCH.getNumOwners(),newMembers.size());
  int numSegments=baseDCH.getNumSegments();
  for (int i=0; i < numSegments; i++) {
    if (baseDCH.locateOwnersForSegment(i).size() != actualNumOwners)     return true;
  }
  int maxPrimaryOwnedSegments=(int)Math.ceil((double)numSegments / newMembers.size());
  int maxOwnedSegments=(int)Math.ceil((double)numSegments / newMembers.size() * actualNumOwners);
  CHStatistics stats=computeStatistics(baseDCH,newMembers);
  for (  Address a : newMembers) {
    if (stats.getPrimaryOwned(a) > maxPrimaryOwnedSegments || stats.getOwned(a) > maxOwnedSegments)     return true;
  }
  return false;
}
