{
  super.start();
  try {
    String location=config.getLocation();
    if (location == null || location.trim().length() == 0)     location="Infinispan-FileCacheStore";
    File dir=new File(location);
    if (!dir.exists() && !dir.mkdirs())     throw new ConfigurationException("Directory " + dir.getAbsolutePath() + " does not exist and cannot be created!");
    File f=new File(location,cache.getName() + ".dat");
    file=new RandomAccessFile(f,"rw").getChannel();
    final Map<Object,FileEntry> entryMap;
    if (config.getMaxEntries() > 0)     entryMap=new LinkedHashMap<Object,FileEntry>(16,0.75f,true);
 else     entryMap=new HashMap<Object,FileEntry>();
    entries=Collections.synchronizedMap(entryMap);
    freeList=Collections.synchronizedSortedSet(new TreeSet<FileEntry>());
    byte[] header=new byte[MAGIC.length];
    if (file.read(ByteBuffer.wrap(header),0) == MAGIC.length && Arrays.equals(MAGIC,header) && cache.getCacheConfiguration().loaders().preload())     preload();
 else     clear();
  }
 catch (  Exception e) {
    throw new CacheLoaderException(e);
  }
}
