{
synchronized (freeList) {
    SortedSet<FileEntry> candidates=freeList.tailSet(new FileEntry(0,len));
    for (Iterator<FileEntry> it=candidates.iterator(); it.hasNext(); ) {
      FileEntry free=it.next();
      if (free.isLocked())       continue;
      it.remove();
      return free;
    }
    FileEntry fe=new FileEntry(filePos,len);
    filePos+=len;
    return fe;
  }
}
