{
  if ("GSSAPI".equals(mechanismName)) {
    return new GSSAPIEndpointAuthorizingCallbackHandler();
  }
 else   if ("PLAIN".equals(mechanismName)) {
    return new RealmAuthorizingCallbackHandler(realm.getAuthorizingCallbackHandler(AuthenticationMechanism.PLAIN));
  }
 else   if ("DIGEST-MD5".equals(mechanismName)) {
    return new RealmAuthorizingCallbackHandler(realm.getAuthorizingCallbackHandler(AuthenticationMechanism.DIGEST));
  }
 else   if ("EXTERNAL".equals(mechanismName)) {
    return new RealmAuthorizingCallbackHandler(realm.getAuthorizingCallbackHandler(AuthenticationMechanism.CLIENT_CERT));
  }
 else {
    throw new IllegalArgumentException("Unsupported mech " + mechanismName);
  }
}
