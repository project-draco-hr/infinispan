{
  if (acquireLockForWriteNoWait())   return true;
  if (!ctx.isOriginLocal() && isSync)   return false;
  long timeout=lockTimeout;
  long endTime=currentTimeMillisFromNanotime() + lockTimeout;
synchronized (lock) {
    while (true) {
      if (acquireLockForWriteNoWait())       return true;
      lock.wait(timeout);
      timeout=endTime - currentTimeMillisFromNanotime();
      if (timeout <= 0)       return false;
    }
  }
}
