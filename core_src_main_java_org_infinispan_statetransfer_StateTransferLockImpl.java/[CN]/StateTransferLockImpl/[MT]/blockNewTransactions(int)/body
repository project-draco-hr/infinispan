{
  log.debugf("Blocking new write commands for cache view %d",cacheViewId);
synchronized (lock) {
    writesShouldBlock=true;
    if (writesBlocked == true)     throw new IllegalStateException("Trying to block write commands but they are already blocked");
    while (runningWritesCount.get() != 0) {
      lock.wait();
    }
    writesBlocked=true;
    blockingCacheViewId=cacheViewId;
  }
  log.tracef("New write commands blocked");
}
