{
  if (ignored != null)   throw new IllegalStateException("Expected null context!");
  RemoteTransaction remoteTransaction=txTable.getRemoteTransaction(globalTx);
  boolean remoteTxinitiated=remoteTransaction != null;
  if (!remoteTxinitiated) {
    remoteTransaction=txTable.createRemoteTransaction(globalTx,modifications);
  }
 else {
    remoteTransaction.setModifications(getModifications());
  }
  RemoteTxInvocationContext ctx=icc.createRemoteTxInvocationContext();
  ctx.setRemoteTransaction(remoteTransaction);
  if (trace)   log.trace("Invoking remotely originated prepare: " + this + " with invocation context: "+ ctx);
  notifier.notifyTransactionRegistered(ctx.getGlobalTransaction(),ctx);
  try {
    return invoker.invoke(ctx,this);
  }
  finally {
    if (this.isOnePhaseCommit()) {
      txTable.removeRemoteTransaction(globalTx);
    }
  }
}
