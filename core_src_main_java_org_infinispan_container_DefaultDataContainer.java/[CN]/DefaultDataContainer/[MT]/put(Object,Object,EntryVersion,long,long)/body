{
  InternalCacheEntry e=peek(k);
  if (e != null) {
    e.setValue(v);
    InternalCacheEntry original=e;
    e.setVersion(version);
    e=entryFactory.update(e,lifespan,maxIdle);
    if (original == e) {
      e.reincarnate();
    }
  }
 else {
    e=entryFactory.create(k,v,version,lifespan,maxIdle);
  }
  entries.put(k,e);
}
