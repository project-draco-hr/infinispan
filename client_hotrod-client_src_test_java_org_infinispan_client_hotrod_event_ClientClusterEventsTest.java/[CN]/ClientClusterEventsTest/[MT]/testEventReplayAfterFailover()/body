{
  org.infinispan.client.hotrod.configuration.ConfigurationBuilder builder=new org.infinispan.client.hotrod.configuration.ConfigurationBuilder();
  HotRodServer server=server(0);
  builder.addServers(server.getHost() + ":" + server.getPort());
  builder.balancingStrategy(FirstServerAvailableBalancer.class);
  RemoteCacheManager newClient=new RemoteCacheManager(builder.build());
  EventLogListener<Integer> eventListener=new EventLogListener<>();
  RemoteCache<Integer,String> c=newClient.getCache();
  c.put(0,"zero");
  c.remove(0);
  c.addClientListener(eventListener);
  c.put(1,"one");
  eventListener.expectOnlyCreatedEvent(1,cache(0));
  findServerAndKill(FirstServerAvailableBalancer.serverToKill);
  c.put(2,"two");
  eventListener.expectFailoverEvent(eventListener);
  eventListener.expectUnorderedEvents(ClientEvent.Type.CLIENT_CACHE_ENTRY_CREATED,1,2);
  c.remove(1);
  c.remove(2);
}
