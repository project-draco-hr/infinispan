{
  Object key=command.getKey();
  TypeConverter<Object,Object,Object,Object> converter=determineTypeConverter(command.getFlags());
  if (ctx.isOriginLocal()) {
    command.setKey(converter.boxKey(key));
  }
  Object ret=invokeNextInterceptor(ctx,command);
  if (ret != null) {
    if (command.isReturnEntry()) {
      InternalCacheEntry entry=(InternalCacheEntry)ret;
      Object returnValue=entry.getValue();
      if (command.getRemotelyFetchedValue() == null) {
        returnValue=converter.unboxValue(entry.getValue());
      }
      return entryFactory.create(entry.getKey(),returnValue,entry.getMetadata(),entry.getLifespan(),entry.getMaxIdle());
    }
 else {
      if (command.getRemotelyFetchedValue() == null) {
        return converter.unboxValue(ret);
      }
      return ret;
    }
  }
  return null;
}
