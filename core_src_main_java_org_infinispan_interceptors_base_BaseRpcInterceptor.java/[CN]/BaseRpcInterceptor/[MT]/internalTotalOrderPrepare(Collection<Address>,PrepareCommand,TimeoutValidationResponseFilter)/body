{
  if (defaultSynchronous) {
    RpcOptionsBuilder builder=rpcManager.getRpcOptionsBuilder(ResponseMode.SYNCHRONOUS_IGNORE_LEAVERS,false);
    if (responseFilter != null) {
      builder.responseFilter(responseFilter);
    }
    builder.totalOrder(true);
    Map<Address,Response> responseMap=rpcManager.invokeRemotely(recipients,prepareCommand,builder.build());
    if (responseFilter != null) {
      responseFilter.validate();
    }
    return responseMap;
  }
 else {
    RpcOptionsBuilder builder=rpcManager.getRpcOptionsBuilder(ResponseMode.getAsyncResponseMode(cacheConfiguration),false);
    builder.totalOrder(true);
    return rpcManager.invokeRemotely(recipients,prepareCommand,builder.build());
  }
}
