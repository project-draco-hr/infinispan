{
  return new FilterRegistry<Integer>(new BETreeMaker.AttributePathTranslator<Integer>(){
    @Override public List<Integer> translatePath(    List<String> path){
      List<Integer> propPath=new ArrayList<Integer>(path.size());
      Descriptors.Descriptor md=messageDescriptor;
      for (      String prop : path) {
        Descriptors.FieldDescriptor fd=md.findFieldByName(prop);
        propPath.add(fd.getNumber());
        if (fd.getJavaType() == Descriptors.FieldDescriptor.JavaType.MESSAGE) {
          md=fd.getMessageType();
        }
 else {
          md=null;
        }
      }
      return propPath;
    }
    @Override public boolean isRepeated(    List<String> path){
      Descriptors.Descriptor md=messageDescriptor;
      for (      String prop : path) {
        Descriptors.FieldDescriptor fd=md.findFieldByName(prop);
        if (fd.isRepeated()) {
          return true;
        }
        if (fd.getJavaType() == Descriptors.FieldDescriptor.JavaType.MESSAGE) {
          md=fd.getMessageType();
        }
 else {
          md=null;
        }
      }
      return false;
    }
  }
,messageDescriptor.getFullName());
}
