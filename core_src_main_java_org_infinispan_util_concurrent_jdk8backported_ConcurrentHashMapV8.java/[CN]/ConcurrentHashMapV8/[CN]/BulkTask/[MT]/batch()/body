{
  ConcurrentHashMapV8<K,V> m;
  int b;
  Node[] t;
  if ((b=batch) < 0 && (m=map) != null) {
    if ((t=tab) == null && (t=tab=m.table) != null)     baseLimit=baseSize=t.length;
    if (t != null) {
      long n=m.counter.sum();
      int sp=getPool().getParallelism() << 3;
      b=batch=(n <= 0L) ? 0 : (n < (long)sp) ? (int)n : sp;
    }
  }
  return b;
}
