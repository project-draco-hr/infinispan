{
  if (trace)   log.trace("purgeInternal");
  Cassandra.Client cassandraClient=null;
  try {
    cassandraClient=dataSource.getConnection();
    SlicePredicate predicate=new SlicePredicate();
    predicate.setSlice_range(new SliceRange(emptyByteArray,longToBytes(System.currentTimeMillis()),false,SLICE_SIZE));
    Map<String,Map<String,List<Mutation>>> mutationMap=new HashMap<String,Map<String,List<Mutation>>>();
    for (boolean complete=false; !complete; ) {
      List<ColumnOrSuperColumn> slice=cassandraClient.get_slice(config.keySpace,expirationKey,expirationColumnParent,predicate,readConsistencyLevel);
      complete=slice.size() < SLICE_SIZE;
      for (      ColumnOrSuperColumn crumb : slice) {
        SuperColumn scol=crumb.getSuper_column();
        for (Iterator<Column> i=scol.getColumnsIterator(); i.hasNext(); ) {
          Column col=i.next();
          remove0(new String(col.getName(),"UTF-8"),mutationMap);
        }
        addMutation(mutationMap,expirationKey,config.expirationColumnFamily,scol.getName(),null,null);
      }
    }
    cassandraClient.batch_mutate(config.keySpace,mutationMap,writeConsistencyLevel);
  }
 catch (  Exception e) {
    throw new CacheLoaderException(e);
  }
 finally {
    dataSource.releaseConnection(cassandraClient);
  }
}
