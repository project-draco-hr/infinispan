{
  Cassandra.Client cassandraClient=null;
  try {
    cassandraClient=dataSource.getConnection();
    Map<ByteBuffer,Map<String,List<Mutation>>> mutationMap=new HashMap<ByteBuffer,Map<String,List<Mutation>>>();
    for (    Modification m : mods) {
switch (m.getType()) {
case STORE:
        store0(((Store)m).getStoredEntry(),mutationMap);
      break;
case CLEAR:
    clear();
  break;
case REMOVE:
remove0(ByteBufferUtil.bytes(hashKey(((Remove)m).getKey())),mutationMap);
break;
default :
throw new AssertionError();
}
}
cassandraClient.batch_mutate(mutationMap,writeConsistencyLevel);
}
 catch (Exception e) {
throw new CacheLoaderException(e);
}
 finally {
dataSource.releaseConnection(cassandraClient);
}
}
