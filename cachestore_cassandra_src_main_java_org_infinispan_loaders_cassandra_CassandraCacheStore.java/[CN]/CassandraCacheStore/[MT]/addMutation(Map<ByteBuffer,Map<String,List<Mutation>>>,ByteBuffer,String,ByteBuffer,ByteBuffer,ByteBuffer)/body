{
  Map<String,List<Mutation>> keyMutations=mutationMap.get(key);
  if (keyMutations == null) {
    keyMutations=new HashMap<String,List<Mutation>>();
    mutationMap.put(key,keyMutations);
  }
  List<Mutation> columnFamilyMutations=keyMutations.get(columnFamily);
  if (columnFamilyMutations == null) {
    columnFamilyMutations=new ArrayList<Mutation>();
    keyMutations.put(columnFamily,columnFamilyMutations);
  }
  if (value == null) {
    Deletion deletion=new Deletion(microTimestamp());
    if (superColumn != null) {
      deletion.setSuper_column(superColumn);
    }
    if (column != null) {
      deletion.setPredicate(new SlicePredicate().setColumn_names(Collections.singletonList(column)));
    }
    columnFamilyMutations.add(new Mutation().setDeletion(deletion));
  }
 else {
    ColumnOrSuperColumn cosc=new ColumnOrSuperColumn();
    if (superColumn != null) {
      List<Column> columns=new ArrayList<Column>();
      columns.add(new Column(column,value,microTimestamp()));
      cosc.setSuper_column(new SuperColumn(superColumn,columns));
    }
 else {
      cosc.setColumn(new Column(column,value,microTimestamp()));
    }
    columnFamilyMutations.add(new Mutation().setColumn_or_supercolumn(cosc));
  }
}
