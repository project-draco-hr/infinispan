{
  Map<String,List<Mutation>> keyMutations=mutationMap.get(key);
  if (keyMutations == null) {
    keyMutations=new HashMap<String,List<Mutation>>();
    mutationMap.put(key,keyMutations);
  }
  List<Mutation> columnFamilyMutations=keyMutations.get(columnFamily);
  if (columnFamilyMutations == null) {
    columnFamilyMutations=new ArrayList<Mutation>();
    keyMutations.put(columnFamily,columnFamilyMutations);
  }
  if (value == null) {
    Deletion deletion=new Deletion();
    deletion.setTimestamp(microTimestamp());
    if (superColumn != null) {
      deletion.setSuper_column(superColumn);
    }
    if (columnName != null) {
      deletion.setPredicate(new SlicePredicate().setColumn_names(Collections.singletonList(columnName)));
    }
    columnFamilyMutations.add(new Mutation().setDeletion(deletion));
  }
 else {
    ColumnOrSuperColumn cosc=new ColumnOrSuperColumn();
    if (superColumn != null) {
      List<Column> columns=new ArrayList<Column>();
      Column col=new Column(columnName);
      col.setValue(value);
      col.setTimestamp(microTimestamp());
      columns.add(col);
      cosc.setSuper_column(new SuperColumn(superColumn,columns));
    }
 else {
      Column col=new Column(columnName);
      col.setValue(value);
      col.setTimestamp(microTimestamp());
      cosc.setColumn(col);
    }
    columnFamilyMutations.add(new Mutation().setColumn_or_supercolumn(cosc));
  }
}
