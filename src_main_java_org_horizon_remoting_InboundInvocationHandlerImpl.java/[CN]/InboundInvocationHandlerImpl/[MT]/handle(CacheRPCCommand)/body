{
  String cacheName=cmd.getCacheName();
  ComponentRegistry cr=gcr.getNamedComponentRegistry(cacheName);
  if (cr == null) {
    if (log.isInfoEnabled())     log.info("Cache named {0} does not exist on this cache manager!",cacheName);
    return null;
  }
  if (!cr.getStatus().allowInvocations()) {
    long giveupTime=System.currentTimeMillis() + 10000;
    while (cr.getStatus() == ComponentStatus.INITIALIZING && System.currentTimeMillis() < giveupTime)     Thread.sleep(100);
    if (!cr.getStatus().allowInvocations())     throw new IllegalStateException("Cache named " + cacheName + " exists but isn't in a state to handle invocations.  Its state is "+ cr.getStatus());
  }
  InterceptorChain ic=cr.getLocalComponent(InterceptorChain.class);
  InvocationContextContainer icc=cr.getLocalComponent(InvocationContextContainer.class);
  CommandsFactory commandsFactory=cr.getLocalComponent(CommandsFactory.class);
  cmd.setInterceptorChain(ic);
  commandsFactory.initializeReplicableCommand(cmd);
  return cmd.perform(icc.get());
}
