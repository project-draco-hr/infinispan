{
  setFlagsOnContext(flags);
  try {
    startAtomic();
    try {
      createNodeInCache(fqn);
      Map<K,V> m=getAtomicMap(new NodeKey(fqn,NodeKey.Type.DATA));
      return m.put(key,value);
    }
  finally {
      endAtomic();
    }
  }
  finally {
    tcc.suspend();
  }
}
