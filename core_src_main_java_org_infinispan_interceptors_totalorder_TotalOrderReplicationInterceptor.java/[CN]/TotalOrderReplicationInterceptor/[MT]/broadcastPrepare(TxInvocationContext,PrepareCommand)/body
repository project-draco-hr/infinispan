{
  if (!context.hasModifications()) {
    return;
  }
  if (!context.isOriginLocal()) {
    throw new IllegalStateException("Expected a local context before TO-Broadcast prepare command");
  }
  try {
    totalOrderBroadcastPrepare(command,isSyncCommitPhase() ? null : getSelfDeliverFilter());
  }
  finally {
    totalOrderTxPrepare(context);
  }
}
