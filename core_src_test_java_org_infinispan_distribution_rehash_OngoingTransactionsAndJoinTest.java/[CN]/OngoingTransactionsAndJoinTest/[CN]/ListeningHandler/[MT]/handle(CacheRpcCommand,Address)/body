{
  boolean notifyRehashStarted=false;
  if (cmd instanceof CacheTopologyControlCommand) {
    CacheTopologyControlCommand rcc=(CacheTopologyControlCommand)cmd;
    log.debugf("Intercepted command: %s",cmd);
switch (rcc.getType()) {
case REBALANCE_START:
      txsReady.await();
    notifyRehashStarted=true;
  break;
case CH_UPDATE:
joinEnded.countDown();
break;
}
}
Response r=delegate.handle(cmd,origin);
if (notifyRehashStarted) rehashStarted.countDown();
return r;
}
