{
  boolean notifyRehashStarted=false;
  if (cmd instanceof CacheTopologyControlCommand) {
    CacheTopologyControlCommand rcc=(CacheTopologyControlCommand)cmd;
    log.debugf("Intercepted command: %s",cmd);
switch (rcc.getType()) {
case REBALANCE_START:
      txsReady.await(10,SECONDS);
    notifyRehashStarted=true;
  break;
case CH_UPDATE:
joinEnded.countDown();
break;
}
}
delegate.handle(cmd,origin,response,preserveOrder);
if (notifyRehashStarted) rehashStarted.countDown();
}
