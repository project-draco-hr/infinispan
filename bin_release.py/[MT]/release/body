def release():
    global settings
    global uploader
    global svn_conn
    assert_python_minimum_version(2, 5)
    require_settings_file()
    if (len(sys.argv) < 2):
        helpAndExit()
    base_dir = os.getcwd()
    version = validateVersion(sys.argv[1])
    branch = 'trunk'
    if (len(sys.argv) > 2):
        branch = sys.argv[2]
    print ("Releasing Infinispan version %s from branch '%s'" + (version, branch))
    print 'Please stand by!'
    if settings['dry_run']:
        print '*** This is a DRY RUN.  No changes will be committed.  Used to test this release script only. ***'
        print ('Your settings are %s' % settings)
        uploader = DryRunUploader()
        svn_conn = DryRunSvnConn()
    else:
        uploader = Uploader()
        svn_conn = SvnConn()
    newVersion = ('%s/tags/%s' % (settings[svn_base_key], version))
    print ('Step 1: Tagging trunk in SVN as %s' % newVersion)
    tagInSubversion(version, newVersion, branch)
    print 'Step 1: Complete'
    workingDir = ((settings[local_tags_dir_key] + '/') + version)
    print 'Step 2: Updating version number in source files'
    updateVersions(version, workingDir, base_dir)
    print 'Step 2: Complete'
    print 'Step 3: Build and test in Maven2'
    buildAndTest(workingDir)
    print 'Step 3: Complete'
    async_processes = []
    unzip_archive(workingDir, version)
    print 'Step 4: Uploading Javadocs'
    do_task(uploadJavadocs, [workingDir, version], async_processes)
    print 'Step 4: Complete'
    print 'Step 5: Uploading to Sourceforge'
    do_task(uploadArtifactsToSourceforge, [version], async_processes)
    print 'Step 5: Complete'
    print 'Step 6: Uploading to configuration XML schema'
    do_task(uploadSchema, [workingDir, version], async_processes)
    print 'Step 6: Complete'
    for p in async_processes:
        p.start()
    for p in async_processes:
        p.join()
    print '\n\n\nDone!  Now all you need to do is the remaining post-release tasks as outlined in https://docspace.corp.redhat.com/docs/DOC-28594'
