{
  boolean alreadyAdded=false;
  for (  Address owner : owners) {
switch (level) {
case SITE:
      alreadyAdded=((TopologyAwareAddress)owner).isSameSite(address);
    break;
case RACK:
  alreadyAdded=((TopologyAwareAddress)owner).isSameRack(address);
break;
case MACHINE:
alreadyAdded=((TopologyAwareAddress)owner).isSameMachine(address);
break;
case NONE:
alreadyAdded=owner == address;
}
if (alreadyAdded) break;
}
if (!alreadyAdded) {
owners.add(address);
if (owners.size() >= replCount || address == target) return true;
}
return false;
}
