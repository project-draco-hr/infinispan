{
  IndexSearcherWithPayload openSearcher=buildSearcher();
  try {
    QueryHits queryHits=getQueryHits(openSearcher,calculateTopDocsRetrievalSize());
    return buildDocumentExtractor(queryHits,openSearcher);
  }
 catch (  IOException e) {
    closeSearcher(openSearcher);
    throw new SearchException("Unable to query Lucene index",e);
  }
}
