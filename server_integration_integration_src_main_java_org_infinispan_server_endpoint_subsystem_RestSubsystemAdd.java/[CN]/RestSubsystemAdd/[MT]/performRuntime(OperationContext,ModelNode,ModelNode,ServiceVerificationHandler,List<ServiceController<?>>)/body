{
  ModelNode config=Resource.Tools.readModel(context.readResource(PathAddress.EMPTY_ADDRESS));
  final RestService service=new RestService(config);
  ServiceBuilder<?> builder=context.getServiceTarget().addService(EndpointUtils.getServiceName(operation,"rest"),service);
  EndpointUtils.addCacheContainerDependency(builder,service.getCacheContainerName(),service.getCacheManager());
  builder.addDependency(PathManagerService.SERVICE_NAME,PathManager.class,service.getPathManagerInjector());
  builder.addDependency(WebSubsystemServices.JBOSS_WEB_HOST.append(service.getVirtualServer()),VirtualHost.class,service.getHostInjector());
  if (service.getSecurityDomain() != null) {
    EndpointUtils.addSecurityDomainDependency(builder,service.getSecurityDomain(),service.getSecurityDomainContextInjector());
  }
  builder.addListener(verificationHandler);
  builder.setInitialMode(ServiceController.Mode.ACTIVE);
  builder.install();
}
