{
  for (int segment=builder.getNumSegments() - 1; segment >= 0; segment--) {
    if (builder.getOwners(segment).isEmpty())     continue;
    if (builder.getPrimaryOwned(builder.getPrimaryOwner(segment)) > maxSegments) {
      Address newPrimary=findNewPrimaryOwner(builder,builder.getBackupOwners(segment),maxSegments);
      if (newPrimary != null) {
        builder.replacePrimaryOwner(segment,newPrimary);
      }
    }
  }
}
