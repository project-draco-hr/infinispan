{
  for (int segment=builder.getNumSegments() - 1; segment >= 0; segment--) {
    if (builder.getOwners(segment).size() >= maxOwners)     continue;
    boolean zeroOwners=builder.getOwners(segment).isEmpty();
    if (!zeroOwners && builder.getPrimaryOwned(builder.getPrimaryOwner(segment)) <= maxSegments)     continue;
    Address newPrimary=findNewPrimaryOwner(builder,builder.getMembers(),maxSegments);
    if (newPrimary != null) {
      builder.replacePrimaryOwner(segment,newPrimary);
    }
  }
}
