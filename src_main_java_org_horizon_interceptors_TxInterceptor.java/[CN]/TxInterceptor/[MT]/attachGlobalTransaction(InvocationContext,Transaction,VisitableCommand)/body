{
  if (trace) {
    log.trace(" local transaction exists - registering global tx if not present for " + Thread.currentThread());
  }
  if (trace) {
    GlobalTransaction tempGtx=txTable.get(tx);
    log.trace("Associated gtx in txTable is " + tempGtx);
  }
  GlobalTransaction gtx=registerTransaction(tx,ctx);
  if (gtx == null) {
    gtx=txTable.get(tx);
  }
  ctx.setGlobalTransaction(gtx);
  return command;
}
