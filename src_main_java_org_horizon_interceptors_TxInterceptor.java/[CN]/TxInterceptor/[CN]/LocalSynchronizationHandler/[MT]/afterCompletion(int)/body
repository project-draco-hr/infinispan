{
  if (ctx == null)   ctx=invocationContextContainer.get();
  ctx.setLocalRollbackOnly(localRollbackOnly);
  setTransactionalContext(tx,gtx,transactionContext,ctx);
  if (transactionalOptions != null)   ctx.setOptions(transactionalOptions);
  try {
    super.afterCompletion(status);
  }
  finally {
    ctx.setOptions(originalOptions);
    if (getStatisticsEnabled()) {
      if (status == Status.STATUS_ROLLEDBACK)       rollbacks.incrementAndGet();
 else       if (status == Status.STATUS_COMMITTED)       commits.incrementAndGet();
    }
  }
}
