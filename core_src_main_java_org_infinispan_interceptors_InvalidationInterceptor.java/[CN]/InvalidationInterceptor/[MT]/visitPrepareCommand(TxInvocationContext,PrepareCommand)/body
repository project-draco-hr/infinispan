{
  Object retval=invokeNextInterceptor(ctx,command);
  log.tracef("Entering InvalidationInterceptor's prepare phase.  Ctx flags are %s",ctx.getFlags());
  if (shouldInvokeRemoteTxCommand(ctx)) {
    List<WriteCommand> mods=Arrays.asList(command.getModifications());
    Transaction runningTransaction=ctx.getTransaction();
    if (runningTransaction == null)     throw new IllegalStateException("we must have an associated transaction");
    broadcastInvalidateForPrepare(mods,runningTransaction,ctx);
  }
 else {
    log.tracef("Nothing to invalidate - no modifications in the transaction.");
  }
  return retval;
}
