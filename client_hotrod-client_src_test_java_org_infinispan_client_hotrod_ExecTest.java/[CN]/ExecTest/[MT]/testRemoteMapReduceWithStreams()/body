{
  String cacheName="testRemoteMapReduce_Streams";
  ConfigurationBuilder builder=getDefaultClusteredCacheConfig(CacheMode.DIST_SYNC,true);
  builder.dataContainer().keyEquivalence(new AnyServerEquivalence()).valueEquivalence(new AnyServerEquivalence()).compatibility().enable().marshaller(new GenericJBossMarshaller());
  defineInAll(cacheName,builder);
  RemoteCache<String,String> cache=clients.get(0).getCache(cacheName);
  RemoteCache<String,String> scriptCache=clients.get(0).getCache(SCRIPT_CACHE);
  loadData(cache,"/macbeth.txt");
  loadScript(scriptCache,"/wordCountStream.js");
  Map<String,Long> results=cache.execute("wordCountStream.js",new HashMap<String,String>());
  assertEquals(3209,results.size());
  assertTrue(results.get("macbeth").equals(Long.valueOf(287)));
}
