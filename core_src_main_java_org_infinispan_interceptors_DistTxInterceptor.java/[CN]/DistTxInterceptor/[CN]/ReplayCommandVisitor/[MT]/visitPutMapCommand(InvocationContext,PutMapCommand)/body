{
  Map newMap=new HashMap();
  for (  Map.Entry entry : command.getMap().entrySet()) {
    if (dm.isLocal(entry.getKey()))     newMap.put(entry.getKey(),entry.getValue());
  }
  if (newMap.isEmpty())   return null;
  if (newMap.size() == command.getMap().size())   return command;
  return commandsFactory.buildPutMapCommand(newMap,command.getLifespanMillis(),command.getMaxIdleTimeMillis());
}
