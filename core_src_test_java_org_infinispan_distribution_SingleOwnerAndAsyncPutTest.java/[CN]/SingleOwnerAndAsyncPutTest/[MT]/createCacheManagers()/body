{
  Configuration c=getDefaultClusteredConfig(Configuration.CacheMode.DIST_SYNC);
  c.setNumOwners(1);
  c.setL1CacheEnabled(true);
  createCluster(c,2);
  TestingUtil.blockUntilViewsReceived(10000,cache(0),cache(1));
  BaseDistFunctionalTest.RehashWaiter.waitForInitRehashToComplete(cache(0),cache(1));
  KeyAffinityService<Object> kaf=KeyAffinityServiceFactory.newKeyAffinityService(cache(0),Executors.newSingleThreadExecutor(),new RndKeyGenerator(),100,true);
  k0=kaf.getKeyForAddress(address(0));
  kaf.stop();
}
