{
  String ideFriendlyPath="cdi/extension/pom.xml";
  String pomPath=new File(ideFriendlyPath).getAbsoluteFile().exists() ? ideFriendlyPath : "pom.xml";
  return ShrinkWrap.create(WebArchive.class,"test.war").addAsWebInfResource(Deployments.class.getResource("/beans.xml"),"beans.xml").addAsLibrary(ShrinkWrap.create(JavaArchive.class,"infinispan-cdi.jar").addPackage(ConfigureCache.class.getPackage()).addPackage(AbstractEventBridge.class.getPackage()).addPackage(CacheEventBridge.class.getPackage()).addPackage(CacheManagerEventBridge.class.getPackage()).addPackage(CachePutInterceptor.class.getPackage()).addAsManifestResource(ConfigureCache.class.getResource("/META-INF/beans.xml"),"beans.xml").addAsManifestResource(ConfigureCache.class.getResource("/META-INF/services/javax.enterprise.inject.spi.Extension"),"services/javax.enterprise.inject.spi.Extension")).addAsLibraries(DependencyResolvers.use(MavenDependencyResolver.class).loadMetadataFromPom(pomPath).artifact("org.jboss.solder:solder-impl").resolveAs(JavaArchive.class));
}
