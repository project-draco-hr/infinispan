{
  if (o == null) {
    NULL_TYPE.write(o,encoder);
  }
 else {
    Class<?> clazz=o.getClass();
    MarshallableType type;
    if (clazz.equals(String.class))     type=STRING_TYPE;
 else     if (clazz.equals(byte[].class))     type=BYTES_TYPE;
 else     if (clazz.equals(Boolean.class))     type=BOOLEAN_TYPE;
 else     if (clazz.equals(Integer.class))     type=INT_TYPE;
 else     if (clazz.equals(Long.class))     type=LONG_TYPE;
 else     if (clazz.equals(Float.class))     type=FLOAT_TYPE;
 else     if (clazz.equals(Double.class))     type=DOUBLE_TYPE;
 else     if (clazz.equals(String[].class))     type=STRING_ARRAY_TYPE;
 else     if (clazz.equals(Integer[].class))     type=INT_ARRAY_TYPE;
 else     if (clazz.equals(Long[].class))     type=LONG_ARRAY_TYPE;
 else     if (clazz.equals(Float[].class))     type=FLOAT_ARRAY_TYPE;
 else     if (clazz.equals(Double[].class))     type=DOUBLE_ARRAY_TYPE;
 else     if (clazz.equals(Boolean[].class))     type=BOOLEAN_ARRAY_TYPE;
 else     if (o instanceof List)     type=listType;
 else     if (o instanceof Map)     type=mapType;
 else     if (o instanceof Set)     type=setType;
 else     throw new CacheException("Unsupported type: " + clazz);
    type.write(o,encoder);
  }
}
