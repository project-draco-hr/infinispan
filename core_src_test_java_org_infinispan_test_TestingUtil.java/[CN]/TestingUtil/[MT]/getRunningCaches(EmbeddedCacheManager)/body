{
  Set<Cache> running=new HashSet<Cache>();
  if (cacheContainer == null || !cacheContainer.getStatus().allowInvocations())   return running;
  for (  String cacheName : cacheContainer.getCacheNames()) {
    if (cacheContainer.isRunning(cacheName)) {
      Cache c=cacheContainer.getCache(cacheName,false);
      if (c != null && c.getStatus().allowInvocations()) {
        running.add(c);
      }
    }
  }
  if (cacheContainer.isDefaultRunning()) {
    Cache defaultCache=cacheContainer.getCache(EmbeddedCacheManager.DEFAULT_CACHE_NAME,false);
    if (defaultCache != null && defaultCache.getStatus().allowInvocations()) {
      running.add(defaultCache);
    }
  }
  return running;
}
