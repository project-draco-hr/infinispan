{
  while (lastValue < counterMaxValue) {
    try {
      Integer value=0;
      try {
        transactionManager.begin();
        value=cache.get("counter");
        value=value + 1;
        lastValue=value;
        cache.put("counter",value);
        transactionManager.commit();
        result=result && uniqueValuesSet.add(value);
        log.warnf("Add value=%s, result is %b",value,result);
      }
 catch (      Throwable t) {
        log.errorf("Exception with value=%d",value);
        transactionManager.rollback();
      }
    }
 catch (    Throwable t) {
    }
  }
}
