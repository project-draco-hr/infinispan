{
  if (getClusteringBuilder().cacheMode().isReplicated() && fetchInMemoryState == null) {
    log.debug("Cache is replicated but state transfer was not defined, so force enabling it");
    fetchInMemoryState(true);
  }
  if (fetchInMemoryState == null)   fetchInMemoryState=false;
  return new StateRetrievalConfiguration(alwaysProvideInMemoryState,fetchInMemoryState.booleanValue(),initialRetryWaitTime,logFlushTimeout,maxNonPorgressingLogWrites,numRetries,retryWaitTimeIncreaseFactor,timeout);
}
