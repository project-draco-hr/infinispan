{
  if (!isCancelled && segments.contains(segmentId)) {
    if (isLastChunk) {
      finishedSegments.add(segmentId);
      if (finishedSegments.containsAll(segments)) {
        stateConsumer.onTaskCompletion(this);
      }
    }
  }
}
