{
  if (trace) {
    log.tracef("Requesting segments %s of cache %s from node %s",segments,cacheName,source);
  }
  try {
    StateRequestCommand cmd=commandsFactory.buildStateRequestCommand(StateRequestCommand.Type.START_STATE_TRANSFER,rpcManager.getAddress(),topologyId,segments);
    Map<Address,Response> responses=rpcManager.invokeRemotely(Collections.singleton(source),cmd,ResponseMode.SYNCHRONOUS_IGNORE_LEAVERS,timeout);
    Response response=responses.get(source);
    boolean success=response instanceof SuccessfulResponse;
    if (!success) {
      log.failedToRequestSegments(segments,cacheName,source,null);
    }
    return success;
  }
 catch (  CacheException e) {
    log.failedToRequestSegments(segments,cacheName,source,e);
    return false;
  }
}
