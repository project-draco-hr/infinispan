{
  if (trace) {
    log.tracef("Requesting transactions for segments %s of cache %s from node %s",segments,cacheName,source);
  }
  StateRequestCommand cmd=commandsFactory.buildStateRequestCommand(StateRequestCommand.Type.GET_TRANSACTIONS,rpcManager.getAddress(),topologyId,segments);
  Map<Address,Response> responses=rpcManager.invokeRemotely(Collections.singleton(source),cmd,ResponseMode.SYNCHRONOUS_IGNORE_LEAVERS,timeout);
  Response response=responses.get(source);
  if (response instanceof SuccessfulResponse) {
    List<TransactionInfo> transactions=(List<TransactionInfo>)((SuccessfulResponse)response).getResponseValue();
    stateConsumer.applyTransactions(source,topologyId,transactions);
    return true;
  }
 else {
    return false;
  }
}
