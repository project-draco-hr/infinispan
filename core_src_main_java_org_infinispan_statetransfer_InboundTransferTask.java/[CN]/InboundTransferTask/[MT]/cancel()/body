{
  if (!isCancelled) {
    isCancelled=true;
    StateRequestCommand cmd=commandsFactory.buildStateRequestCommand(StateRequestCommand.Type.CANCEL_STATE_TRANSFER,rpcManager.getAddress(),topologyId,segments);
    rpcManager.invokeRemotely(Collections.singleton(source),cmd,ResponseMode.SYNCHRONOUS_IGNORE_LEAVERS,timeout);
    notifyCompletion();
  }
}
