{
  if (!isCancelled) {
    isCancelled=true;
    if (trace) {
      log.tracef("Cancelling inbound state transfer of segments %s of cache %s",segments,cacheName);
    }
    StateRequestCommand cmd=commandsFactory.buildStateRequestCommand(StateRequestCommand.Type.CANCEL_STATE_TRANSFER,rpcManager.getAddress(),topologyId,segments);
    rpcManager.invokeRemotely(Collections.singleton(source),cmd,ResponseMode.SYNCHRONOUS_IGNORE_LEAVERS,timeout,false);
    notifyCompletion();
  }
}
