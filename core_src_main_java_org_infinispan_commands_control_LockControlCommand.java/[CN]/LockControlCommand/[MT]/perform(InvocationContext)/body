{
  if (ignored != null)   throw new IllegalStateException("Expected null context!");
  RemoteTxInvocationContext ctxt=icc.createRemoteTxInvocationContext(getOrigin());
  RemoteTransaction transaction=txTable.getRemoteTransaction(globalTx);
  if (transaction == null) {
    if (unlock) {
      if (log.isTraceEnabled()) {
        log.tracef("Unlock for non-existant transaction %s.  Not doing anything.",globalTx);
      }
      return null;
    }
    transaction=txTable.createRemoteTransaction(globalTx);
  }
  ctxt.setRemoteTransaction(transaction);
  TxInvocationContext ctx=ctxt;
  if (flags != null && !flags.isEmpty()) {
    ctx=new TransactionalInvocationContextFlagsOverride(ctxt,flags);
  }
  if (log.isTraceEnabled())   log.tracef("Global transaction received is %s (%s)",globalTx,System.identityHashCode(globalTx));
  if (log.isTraceEnabled())   log.tracef("Lock owner is %s(%s)",ctx.getLockOwner(),System.identityHashCode(ctx.getLockOwner()));
  return invoker.invoke(ctx,this);
}
