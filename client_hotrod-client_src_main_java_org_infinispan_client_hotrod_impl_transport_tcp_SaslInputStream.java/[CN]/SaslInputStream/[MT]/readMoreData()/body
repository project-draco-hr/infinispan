{
  try {
    inStream.readFully(lengthBuf);
    int length=unsignedBytesToInt(lengthBuf);
    if (LOG.isDebugEnabled())     LOG.debug("Actual length is " + length);
    saslToken=new byte[length];
    inStream.readFully(saslToken);
  }
 catch (  EOFException e) {
    return -1;
  }
  try {
    obuffer=saslClient.unwrap(saslToken,0,saslToken.length);
  }
 catch (  SaslException se) {
    try {
      disposeSasl();
    }
 catch (    SaslException ignored) {
    }
    throw se;
  }
  ostart=0;
  if (obuffer == null)   ofinish=0;
 else   ofinish=obuffer.length;
  return ofinish;
}
