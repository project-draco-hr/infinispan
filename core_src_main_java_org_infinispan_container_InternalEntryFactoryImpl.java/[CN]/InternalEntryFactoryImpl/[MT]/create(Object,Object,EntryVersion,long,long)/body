{
  if (version == null) {
    if (lifespan < 0 && maxIdle < 0)     return new ImmortalCacheEntry(key,value);
    if (lifespan > -1 && maxIdle < 0)     return new MortalCacheEntry(key,value,lifespan);
    if (lifespan < 0 && maxIdle > -1)     return new TransientCacheEntry(key,value,maxIdle);
    return new TransientMortalCacheEntry(key,value,maxIdle,lifespan);
  }
 else {
    if (lifespan < 0 && maxIdle < 0)     return new VersionedImmortalCacheEntry(key,value,version);
    if (lifespan > -1 && maxIdle < 0)     new VersionedMortalCacheEntry(key,value,version,lifespan);
    if (lifespan < 0 && maxIdle > -1)     new VersionedTransientCacheEntry(key,value,version,maxIdle);
    return new VersionedTransientMortalCacheEntry(key,value,version,maxIdle,lifespan);
  }
}
