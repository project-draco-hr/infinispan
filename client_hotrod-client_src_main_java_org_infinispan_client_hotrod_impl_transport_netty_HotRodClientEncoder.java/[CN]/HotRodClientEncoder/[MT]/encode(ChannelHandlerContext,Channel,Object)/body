{
  if (msg instanceof byte[]) {
    return wrappedBuffer((byte[])msg);
  }
 else   if (msg instanceof Integer) {
    int intMsg=(Integer)msg;
    ChannelBuffer buffer=getBuffer(channel);
    writeUnsignedInt(buffer.toByteBuffer(),intMsg);
    return buffer;
  }
 else   if (msg instanceof Long) {
    ChannelBuffer buffer=getBuffer(channel);
    long longMsg=(Long)msg;
    writeUnsignedLong(buffer.toByteBuffer(),longMsg);
    return buffer;
  }
 else   if (msg instanceof Short) {
    ChannelBuffer buffer=getBuffer(channel);
    short byteMsg=(Short)msg;
    buffer.writeByte(byteMsg);
    return buffer;
  }
 else {
    throw new TransportException("Unknown msg type: " + msg.getClass());
  }
}
