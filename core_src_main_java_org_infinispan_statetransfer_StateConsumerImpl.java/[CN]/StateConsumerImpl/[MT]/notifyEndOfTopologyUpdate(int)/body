{
  if (!isStateTransferInProgress()) {
    if (rebalanceInProgress.compareAndSet(true,false)) {
      log.debugf("Finished receiving of segments for cache %s for topology %d.",cacheName,topologyId);
      stopApplyingState();
      stateTransferManager.notifyEndOfTopologyUpdate(topologyId);
    }
  }
}
