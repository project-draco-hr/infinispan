{
  Set<Integer> segmentsToInvalidate=new HashSet<Integer>();
  if (configuration.clustering().l1().enabled() && previousWriteCh != null) {
    for (int i=0; i < previousWriteCh.getNumSegments(); i++) {
      if (newSegments.contains(i))       continue;
      if (!previousWriteCh.locateOwnersForSegment(i).containsAll(newWriteCh.locateOwnersForSegment(i))) {
        segmentsToInvalidate.add(i);
      }
    }
  }
  return segmentsToInvalidate;
}
