{
  ErrorInducingListener listener=new ErrorInducingListener();
  byte[] key=TestHelper.getKeyForServer(hotRodServer1);
  try {
    assertNull(remoteCache.putIfAbsent(key,1));
    hotRodServer1.getCacheManager().getCache().addListener(listener);
    assertFalse(listener.errorInduced);
    assertEquals(1,remoteCache.replace(key,2));
    assertTrue(listener.errorInduced);
    assertEquals(2,remoteCache.get(key));
  }
  finally {
    hotRodServer1.getCacheManager().removeListener(listener);
  }
}
