{
  queues=new ArrayBlockingQueue[segments];
  for (int i=0; i < segments; ++i) {
    queues[i]=new ArrayBlockingQueue(capacity);
  }
  this.keyEquivalence=keyEquivalence;
}
