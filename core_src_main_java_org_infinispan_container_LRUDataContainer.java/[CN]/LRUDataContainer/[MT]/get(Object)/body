{
  int h=hash(k.hashCode());
  Segment s=segmentFor(h);
  LinkedEntry le=s.get(k,h);
  InternalCacheEntry ice=null;
  if (le != null)   ice=le.e;
  if (ice != null) {
    if (ice.isExpired()) {
      remove(k);
      ice=null;
    }
 else {
      ice.touch();
      boolean needToUnlockSegment=false;
      try {
        s.lock();
        needToUnlockSegment=true;
        updateLinks(le);
      }
  finally {
        if (needToUnlockSegment)         s.unlock();
      }
    }
  }
  return ice;
}
