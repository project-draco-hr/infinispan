{
  DataContainer current=TestingUtil.extractComponent(cache,DataContainer.class);
  ClusteringDependentLogic clusteringDependentLogic=TestingUtil.extractComponent(cache,ClusteringDependentLogic.class);
  ControlledDataContainer controlledDataContainer=new ControlledDataContainer(current,clusteringDependentLogic);
  controlledDataContainer.beforeRemove=new Runnable(){
    @Override public void run(){
      latch.blockIfNeeded();
    }
  }
;
  TestingUtil.replaceComponent(cache,DataContainer.class,controlledDataContainer,true);
  return controlledDataContainer;
}
