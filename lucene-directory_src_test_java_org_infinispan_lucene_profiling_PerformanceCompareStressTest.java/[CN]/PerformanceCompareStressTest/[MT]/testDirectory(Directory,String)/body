{
  SharedState state=new SharedState(1000);
  CacheTestSupport.initializeDirectory(dir);
  ExecutorService e=Executors.newFixedThreadPool(THREADS);
  for (int i=0; i < THREADS; i++) {
    e.execute(new LuceneUserThread(dir,state));
  }
  e.shutdown();
  state.startWaitingThreads();
  Thread.sleep(DURATION_MS);
  state.quit();
  long searchesCount=state.incrementIndexSearchesCount(0);
  long writerTaskCount=state.incrementIndexWriterTaskCount(0);
  e.awaitTermination(10,TimeUnit.SECONDS);
  System.out.println("Test " + testLabel + " run in "+ DURATION_MS+ "ms:\n\tSearches: "+ searchesCount+ "\n\t"+ "Writes: "+ writerTaskCount);
}
