{
  try {
    String location=configuration.location();
    if (location == null || location.trim().length() == 0)     location="Infinispan-SingleFileStore";
    File f=new File(location + File.separator + ctx.getCache().getName()+ ".dat");
    if (!f.exists()) {
      File dir=f.getParentFile();
      if (!dir.mkdirs() && !dir.exists()) {
        throw log.directoryCannotBeCreated(dir.getAbsolutePath());
      }
    }
    file=new RandomAccessFile(f,"rw").getChannel();
    entries=newEntryMap();
    freeList=Collections.synchronizedSortedSet(new TreeSet<FileEntry>());
    byte[] header=new byte[MAGIC.length];
    if (file.read(ByteBuffer.wrap(header),0) == MAGIC.length && Arrays.equals(MAGIC,header))     rebuildIndex();
 else     clear();
  }
 catch (  Exception e) {
    throw new CacheLoaderException(e);
  }
}
