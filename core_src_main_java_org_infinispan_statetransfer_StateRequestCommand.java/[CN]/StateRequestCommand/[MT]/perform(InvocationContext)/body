{
  final boolean trace=log.isTraceEnabled();
  LogFactory.pushNDC(cacheName,trace);
  try {
switch (type) {
case GET_TRANSACTIONS:
      return stateProvider.getTransactionsForSegments(getOrigin(),topologyId,segments);
case START_STATE_TRANSFER:
    stateProvider.startOutboundTransfer(getOrigin(),topologyId,segments);
  return true;
case CANCEL_STATE_TRANSFER:
stateProvider.cancelOutboundTransfer(getOrigin(),topologyId,segments);
return null;
case GET_CACHE_LISTENERS:
return stateProvider.getClusterListenersToInstall();
default :
throw new CacheException("Unknown state request command type: " + type);
}
}
  finally {
LogFactory.popNDC(trace);
}
}
