{
  GlobalConfiguration gc=mode.isClustered() ? GlobalConfiguration.getClusteredDefault() : GlobalConfiguration.getNonClusteredDefault();
  Configuration c=new Configuration();
  FluentConfiguration fluentConfiguration=c.fluent();
  if (indexing) {
    fluentConfiguration.indexing().addProperty("hibernate.search.lucene_version","LUCENE_CURRENT");
  }
  fluentConfiguration.mode(mode);
  return createCacheManager(gc,fluentConfiguration.build());
}
