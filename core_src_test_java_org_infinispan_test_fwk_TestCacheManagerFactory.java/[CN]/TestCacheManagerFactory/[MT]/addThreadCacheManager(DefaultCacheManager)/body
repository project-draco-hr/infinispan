{
  if (shuttingDown) {
    try {
      shutDownLatch.await();
    }
 catch (    InterruptedException e) {
      throw new IllegalStateException(e);
    }
  }
  PerThreadCacheManagers threadCacheManagers=perThreadCacheManagers.get();
  Throwable allocationThrowable=new Throwable();
  if (cm.getAddress() != null) {
    String uuid=((org.jgroups.util.UUID)((JGroupsAddress)cm.getAddress()).getJGroupsAddress()).toStringLong();
    log.debugf("Started cache manager %s, UUID is %s",cm.getAddress(),uuid);
  }
  if (log.isTraceEnabled()) {
    log.tracef(allocationThrowable,"Adding DCM (%s), allocation stacktrace follows",cm.getCacheManagerConfiguration().transport().nodeName());
  }
  threadCacheManagers.add(allocationThrowable,cm);
  return cm;
}
