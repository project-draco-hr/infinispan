{
  tm().begin();
  cache().getAdvancedCache().lock("k");
  assertLockingOnRollback();
  assertNull(cache().get("k"));
  tm().begin();
  cache().getAdvancedCache().lock("k");
  cache().put("k","v");
  assertLockingOnRollback();
  assertNull(cache().get("k"));
}
