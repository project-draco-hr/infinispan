{
  Cache cache1=cache(0,"replSync");
  Cache cache2=cache(1,"replSync");
  TransactionManager tm1=TestingUtil.getTransactionManager(cache1);
  TransactionManager tm2=TestingUtil.getTransactionManager(cache2);
  ReplListener replListener1=replListener(cache1);
  ReplListener replListener2=replListener(cache2);
  replListener2.expect(PutKeyValueCommand.class);
  cache1.put(key + "0",value);
  replListener2.waitForRpc();
  replListener2.expect(PutKeyValueCommand.class);
  tm1.begin();
  cache1.get(key + "0");
  cache1.putForExternalRead(key,value);
  Transaction t=tm1.suspend();
  replListener2.waitForRpc();
  assertEquals("PFER should have completed",value,cache1.get(key));
  assertEquals("PFER should have completed",value,cache2.get(key));
  tm1.resume(t);
  tm1.commit();
  assertEquals("tx should have completed",value,cache1.get(key + "0"));
  assertEquals("tx should have completed",value,cache2.get(key + "0"));
}
