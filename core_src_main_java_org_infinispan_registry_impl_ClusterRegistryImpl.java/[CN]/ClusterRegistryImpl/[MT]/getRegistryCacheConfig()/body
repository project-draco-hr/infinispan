{
  ConfigurationBuilder configurationBuilder=new ConfigurationBuilder();
  CacheMode cacheMode=isClustered() ? CacheMode.REPL_SYNC : CacheMode.LOCAL;
  configurationBuilder.clustering().cacheMode(cacheMode);
  configurationBuilder.transaction().transactionMode(TransactionMode.TRANSACTIONAL);
  configurationBuilder.clustering().stateTransfer().fetchInMemoryState(true);
  return configurationBuilder.build();
}
