{
  for (  Map.Entry<Integer,Address> e : primarySegments.entrySet()) {
    Integer segment=e.getKey();
    Address primaryOwner=e.getValue();
    builder.getOwners(segment).add(primaryOwner);
  }
  boolean modified=true;
  while (modified) {
    modified=false;
    for (    Address member : builder.getSortedMembers()) {
      int initSegment=normalizedHash(builder.getHashFunction(),member.hashCode()) / builder.getSegmentSize();
      for (int i=0; i < builder.getNumSegments(); i++) {
        int segment=(builder.getNumSegments() + initSegment - i) % builder.getNumSegments();
        List<Address> owners=builder.getOwners(segment);
        if (owners.size() < builder.getActualNumOwners() && !owners.contains(member)) {
          owners.add(member);
          modified=true;
          break;
        }
      }
    }
  }
}
