{
  Builder builder=new Builder(hashFunction,numOwners,numSegments,members);
  SortedMap<Integer,Address> primarySegments=populatePrimarySegments(builder);
  if (numSegments >= members.size()) {
    populateOwnersManySegments(builder,primarySegments);
  }
 else {
    populateOwnersFewSegments(builder,primarySegments);
  }
  return new DefaultConsistentHash(hashFunction,numSegments,numOwners,members,builder.getAllOwners());
}
