{
  ClassLoader existingCl=Thread.currentThread().getContextClassLoader();
  DefaultCacheManager dcm=null;
  Cache<Object,Object> sampleDistributedCache2=null;
  try {
    ClassLoader delegatingCl=new Jbc2InfinispanTransformerTest.TestClassLoader(existingCl);
    Thread.currentThread().setContextClassLoader(delegatingCl);
    String fileName=getFileName(coherenceFileName);
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    convertor.parse(fileName,baos,XSLT_FILE);
    File out=new File("zzzz2.xml");
    if (out.exists())     out.delete();
    out.createNewFile();
    FileOutputStream fos=new FileOutputStream(out);
    fos.write(baos.toByteArray());
    baos.close();
    fos.close();
    dcm=new DefaultCacheManager(new ByteArrayInputStream(baos.toByteArray()));
    Cache<Object,Object> defaultCache=dcm.getCache();
    defaultCache.put("key","value");
  }
  finally {
    Thread.currentThread().setContextClassLoader(existingCl);
    TestingUtil.killCaches(sampleDistributedCache2);
    TestingUtil.killCacheManagers(dcm);
  }
}
