{
  config=getDefaultClusteredConfig(Configuration.CacheMode.DIST_SYNC);
  CacheManager cm1=TestCacheManagerFactory.createClusteredCacheManager(config);
  CacheManager cm2=TestCacheManagerFactory.createClusteredCacheManager(config);
  registerCacheManager(cm1);
  registerCacheManager(cm2);
  hotRodServer1=TestHelper.startHotRodServer(manager(0));
  hotRodServer2=TestHelper.startHotRodServer(manager(1));
  manager(0).getCache();
  manager(1).getCache();
  TestingUtil.blockUntilViewReceived(manager(0).getCache(),2,10000);
  TestingUtil.blockUntilCacheStatusAchieved(manager(0).getCache(),ComponentStatus.RUNNING,10000);
  TestingUtil.blockUntilCacheStatusAchieved(manager(1).getCache(),ComponentStatus.RUNNING,10000);
  manager(0).getCache().put("k","v");
  manager(0).getCache().get("k").equals("v");
  manager(1).getCache().get("k").equals("v");
  log.info("Local replication test passed!");
  remoteCacheManager=new RemoteCacheManager("localhost",hotRodServer2.getPort());
  remoteCache=remoteCacheManager.getCache();
  tcpConnectionFactory=(TcpTransportFactory)TestingUtil.extractField(remoteCacheManager,"transportFactory");
}
