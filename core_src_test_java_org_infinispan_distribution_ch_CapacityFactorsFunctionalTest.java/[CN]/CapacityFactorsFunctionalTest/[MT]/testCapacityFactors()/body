{
  ConfigurationBuilder cb=new ConfigurationBuilder();
  cb.clustering().cacheMode(CacheMode.DIST_SYNC);
  cb.clustering().hash().numSegments(60);
  cb.clustering().hash().capacityFactor(0.5f);
  addClusterEnabledCacheManager(cb);
  waitForClusterToForm();
  assertCapacityFactors(0.5f);
  assertPrimaryOwned(60);
  assertOwned(60);
  cb.clustering().hash().capacityFactor(1.5f);
  addClusterEnabledCacheManager(cb);
  waitForClusterToForm();
  assertCapacityFactors(0.5f,1.5f);
  assertPrimaryOwned(15,45);
  assertOwned(60,60);
  cb.clustering().hash().capacityFactor(0.0f);
  addClusterEnabledCacheManager(cb);
  waitForClusterToForm();
  assertCapacityFactors(0.5f,1.5f,0.0f);
  assertPrimaryOwned(15,45);
  assertOwned(60,60,0);
  cb.clustering().hash().capacityFactor(1.0f);
  addClusterEnabledCacheManager(cb);
  waitForClusterToForm();
  assertCapacityFactors(0.5f,1.5f,0.0f,1.0f);
  assertPrimaryOwned(10,30,0,20);
  assertOwned(20,60,0,40);
}
