{
  chunkNumber=getChunkNumberFromPosition(filePosition - 1,bufferSize);
  ChunkCacheKey key=new ChunkCacheKey(fileKey.getIndexName(),fileKey.getFileName(),chunkNumber);
  file.touch();
  if (file.getSize() < filePosition) {
    file.setSize(filePosition);
  }
  cache.startBatch();
  cache.withFlags(Flag.SKIP_REMOTE_LOOKUP).put(key,buffer);
  cache.withFlags(Flag.SKIP_REMOTE_LOOKUP).put(fileKey,file);
  cache.endBatch(true);
}
