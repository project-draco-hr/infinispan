{
  int mapSize=map.size();
  writeUnsignedInt(out,mapSize);
  if (mapSize == 0)   return;
  for (  Map.Entry me : (Set<Map.Entry>)map.entrySet()) {
    marshallObject(me.getKey(),out,refMap);
    marshallObject(me.getValue(),out,refMap);
  }
}
