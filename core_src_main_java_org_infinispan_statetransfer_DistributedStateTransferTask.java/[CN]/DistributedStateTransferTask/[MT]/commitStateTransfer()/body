{
  dm.setConsistentHash(chNew);
  if (configuration.isRehashEnabled() && !initialView) {
    stateTransferManager.invalidateKeys(keysToRemove,newViewId);
    cacheNotifier.notifyDataRehashed(oldCacheSet,newCacheSet,newViewId,false);
  }
  try {
    stateTransferLock.unblockNewTransactions();
  }
 catch (  Exception e) {
    log.errorUnblockingTransactions(e);
  }
  stateTransferManager.endStateTransfer();
  log.debugf("Node %s completed rehash for view %d in %s!",self,newViewId,Util.prettyPrintTime(System.currentTimeMillis() - stateTransferStartMillis));
}
