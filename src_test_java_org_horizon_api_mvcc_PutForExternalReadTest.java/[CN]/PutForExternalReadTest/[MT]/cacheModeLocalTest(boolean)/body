{
  RPCManager rpcManager=EasyMock.createMock(RPCManager.class);
  RPCManager originalRpcManager=TestingUtil.replaceComponent(cache1.getCacheManager(),RPCManager.class,rpcManager,true);
  try {
    replay(rpcManager);
    if (transactional)     tm1.begin();
    cache1.getAdvancedCache().putForExternalRead(key,value,Flag.CACHE_MODE_LOCAL);
    if (transactional)     tm1.commit();
    verify(rpcManager);
  }
  finally {
    if (originalRpcManager != null) {
      TestingUtil.replaceComponent(cache1.getCacheManager(),RPCManager.class,originalRpcManager,true);
      cache1.remove(key);
    }
  }
}
