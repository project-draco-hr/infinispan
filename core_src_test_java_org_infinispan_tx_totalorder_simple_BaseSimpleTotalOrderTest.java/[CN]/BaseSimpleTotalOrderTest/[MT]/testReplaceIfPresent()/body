{
  preCheckBeforeTest(KEY_1,KEY_2);
  cache(index1).put(KEY_1,VALUE_1);
  assertTransactionSeenByEverybody(index1,true,KEY_1);
  assertCacheValue(KEY_1,VALUE_1);
  assertFalse(cache(index1).replace(KEY_1,VALUE_2,VALUE_3));
  assertTransactionSeenByEverybody(index1,false);
  assertCacheValue(KEY_1,VALUE_1);
  assertTrue(cache(index1).replace(KEY_1,VALUE_1,VALUE_4));
  assertTransactionSeenByEverybody(index1,true,KEY_1);
  assertCacheValue(KEY_1,VALUE_4);
  cache(index1).put(KEY_2,VALUE_1);
  assertTransactionSeenByEverybody(index1,true,KEY_2);
  assertCacheValue(KEY_2,VALUE_1);
  assertFalse(cache(index1).replace(KEY_2,VALUE_2,VALUE_3));
  assertTransactionSeenByEverybody(index1,false);
  assertCacheValue(KEY_2,VALUE_1);
  assertTrue(cache(index1).replace(KEY_2,VALUE_1,VALUE_4));
  assertTransactionSeenByEverybody(index1,true,KEY_2);
  assertCacheValue(KEY_2,VALUE_4);
  assertNoTransactions();
}
