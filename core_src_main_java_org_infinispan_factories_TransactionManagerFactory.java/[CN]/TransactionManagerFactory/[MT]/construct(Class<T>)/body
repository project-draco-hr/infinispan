{
  TransactionManager transactionManager=null;
  TransactionManagerLookup lookup=configuration.getTransactionManagerLookup();
  if (lookup == null) {
    if (configuration.getTransactionManagerLookupClass() != null) {
      lookup=(TransactionManagerLookup)Util.getInstance(configuration.getTransactionManagerLookupClass(),configuration.getClassLoader());
    }
  }
  try {
    if (lookup != null) {
      componentRegistry.wireDependencies(lookup);
      transactionManager=lookup.getTransactionManager();
    }
  }
 catch (  Exception e) {
    log.info("failed looking up TransactionManager, will not use transactions",e);
  }
  if (transactionManager == null && configuration.isInvocationBatchingEnabled()) {
    log.info("Using a batchMode transaction manager");
    transactionManager=BatchModeTransactionManager.getInstance();
  }
  return componentType.cast(transactionManager);
}
