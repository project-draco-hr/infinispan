{
  checkNotNull(metadataCache,"metadataCache");
  checkNotNull(chunksCache,"chunksCache");
  checkNotNull(indexName,"indexName");
  checkNotNull(lf,"LockFactory");
  checkNotNull(readLocker,"SegmentReadLocker");
  if (chunkSize <= 0)   throw new IllegalArgumentException("chunkSize must be a positive integer");
  this.impl=new DirectoryImplementor(metadataCache,chunksCache,indexName,chunkSize,readLocker);
  this.indexName=indexName;
  this.lockFactory=lf;
  this.lockFactory.setLockPrefix(this.getLockID());
}
