{
  mc=createMemcachedClient(server);
  int numEntries=1000;
  String keyPrefix="testPutRemove-k-";
  String valuePrefix="testPutRemove-k-";
  for (int i=0; i != numEntries; i++) {
    mc.set(keyPrefix + i,valuePrefix + i);
  }
  for (int i=0; i != numEntries; i++) {
    if (!dbServer.stringTable.exists()) {
      System.out.println("Table does not exist");
    }
    assertNotNull("Key " + keyPrefix + i+ " was not found in DB in "+ DBServer.TIMEOUT+ " ms",dbServer.stringTable.getValueByKeyAwait(keyPrefix + i));
  }
  for (int i=0; i != numEntries; i++) {
    mc.delete(keyPrefix + i);
  }
  long limit=System.currentTimeMillis() + DBServer.TIMEOUT;
  while (!dbServer.stringTable.getAllRows().isEmpty()) {
    if (System.currentTimeMillis() > limit) {
      throw new RuntimeException("Timeout exceeded. The DB table is still not empty");
    }
  }
}
