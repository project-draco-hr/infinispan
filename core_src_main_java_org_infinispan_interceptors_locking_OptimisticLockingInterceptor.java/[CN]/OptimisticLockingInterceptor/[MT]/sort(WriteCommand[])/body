{
  Set<Object> set=new HashSet<Object>();
  for (  WriteCommand wc : writes) {
switch (wc.getCommandId()) {
case ClearCommand.COMMAND_ID:
      return null;
case PutKeyValueCommand.COMMAND_ID:
case RemoveCommand.COMMAND_ID:
case ReplaceCommand.COMMAND_ID:
    set.add(((DataWriteCommand)wc).getKey());
  break;
case PutMapCommand.COMMAND_ID:
set.addAll(wc.getAffectedKeys());
break;
case ApplyDeltaCommand.COMMAND_ID:
ApplyDeltaCommand command=(ApplyDeltaCommand)wc;
if (cdl.localNodeIsOwner(command.getKey())) {
Object[] compositeKeys=command.getCompositeKeys();
set.addAll(Arrays.asList(compositeKeys));
}
break;
}
}
Object[] sorted=set.toArray(new Object[set.size()]);
TimSort.sort(sorted,keyComparator);
return sorted;
}
