{
  super.setCaches(newCaches);
  siteIdChangeIndexes.clear();
  rackIdChangeIndexes.clear();
  machineIdChangeIndexes.clear();
  TopologyAwareAddress lastSiteAddr=(TopologyAwareAddress)positionValues[positionValues.length - 1];
  TopologyAwareAddress lastRackAddr=(TopologyAwareAddress)positionValues[positionValues.length - 1];
  TopologyAwareAddress lastMachineAddr=(TopologyAwareAddress)positionValues[positionValues.length - 1];
  for (int i=0; i < positionKeys.length; i++) {
    TopologyAwareAddress a=(TopologyAwareAddress)positionValues[i];
    if (!lastSiteAddr.isSameSite(a)) {
      siteIdChangeIndexes.add(i);
      lastSiteAddr=a;
    }
    if (!lastRackAddr.isSameRack(a)) {
      rackIdChangeIndexes.add(i);
      lastRackAddr=a;
    }
    if (!lastMachineAddr.isSameMachine(a)) {
      machineIdChangeIndexes.add(i);
      lastMachineAddr=a;
    }
  }
}
