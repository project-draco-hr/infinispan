{
  long start=System.currentTimeMillis();
  boolean timeoutReached=false;
  boolean receivedAcks=false;
  leaveAcksLock.lock();
  try {
    while (!timeoutReached) {
      receivedAcks=stateReceivers.equals(leaveRehashAcks);
      if (receivedAcks)       break;
 else       acksArrived.await(1000,TimeUnit.MILLISECONDS);
      timeoutReached=(System.currentTimeMillis() - start) > timeout;
    }
  }
  finally {
    leaveRehashAcks.clear();
    leaveAcksLock.unlock();
  }
  return !timeoutReached;
}
