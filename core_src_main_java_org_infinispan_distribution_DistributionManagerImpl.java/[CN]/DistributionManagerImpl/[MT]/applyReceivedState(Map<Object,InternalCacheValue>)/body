{
  applyState(consistentHash,state);
  boolean unlocked=false;
  try {
    drainTransactionLog();
    unlocked=true;
  }
  finally {
    if (!unlocked)     transactionLogger.unlockAndDisable();
  }
}
