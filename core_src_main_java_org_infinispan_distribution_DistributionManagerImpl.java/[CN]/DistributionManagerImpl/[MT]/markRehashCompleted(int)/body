{
  waitForJoinToStart();
  if (viewId < lastViewId) {
    if (trace)     log.tracef("Ignoring old rehash completed confirmation for view %d, last view is %d",viewId,lastViewId);
    return;
  }
  if (viewId > lastViewId) {
    throw new IllegalStateException("Received rehash completed confirmation before confirming it ourselves");
  }
  if (trace)   log.tracef("Rehash completed on node %s, data container has %d keys",getSelf(),dataContainer.size());
  rehashInProgress=false;
synchronized (rehashInProgressMonitor) {
    if (trace)     log.tracef("Updating last rehashed CH to %s",this.lastSuccessfulCH);
    lastSuccessfulCH=this.consistentHash;
    rehashInProgressMonitor.notifyAll();
  }
  joinCompletedLatch.countDown();
}
