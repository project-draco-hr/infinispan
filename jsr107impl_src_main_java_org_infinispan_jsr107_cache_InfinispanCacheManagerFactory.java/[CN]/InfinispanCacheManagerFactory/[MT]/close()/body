{
synchronized (cacheManagers) {
    IdentityHashMap<CacheManager,Exception> failures=new IdentityHashMap<CacheManager,Exception>();
    for (    Map<String,CacheManager> cacheManagerMap : cacheManagers.values()) {
      try {
        shutdown(cacheManagerMap);
      }
 catch (      CachingShutdownException e) {
        failures.putAll(e.getFailures());
      }
    }
    cacheManagers.clear();
    if (!failures.isEmpty()) {
      throw new CachingShutdownException(failures);
    }
  }
}
