{
  String cacheNameConfig="notCreatedOnAllNodes";
  Cache<String,String> c=cache(0,cacheName());
  MapReduceTask<String,String,String,Integer> t=new MapReduceTask<>(c,true,false);
  ConfigurationBuilder cacheConfig=new ConfigurationBuilder();
  cacheConfig.unsafe().unreliableReturnValues(true).clustering().cacheMode(CacheMode.DIST_SYNC).hash().numOwners(2).stateTransfer().timeout(5,TimeUnit.SECONDS);
  manager(0).defineConfiguration(cacheNameConfig,cacheConfig.build());
  t.usingSharedIntermediateCache("irrelevant",cacheNameConfig);
  t.mappedWith(new WordCountMapper()).reducedWith(new WordCountReducer());
  t.execute();
}
