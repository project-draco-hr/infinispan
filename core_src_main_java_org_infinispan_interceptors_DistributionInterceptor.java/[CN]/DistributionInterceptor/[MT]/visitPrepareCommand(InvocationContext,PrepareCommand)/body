{
  Object retVal=invokeNextInterceptor(ctx,command);
  TransactionContext transactionContext=ctx.getTransactionContext();
  if (transactionContext.hasLocalModifications()) {
    PrepareCommand replicablePrepareCommand=command.copy();
    replicablePrepareCommand.removeModifications(transactionContext.getLocalModifications());
    command=replicablePrepareCommand;
  }
  if (!skipReplicationOfTransactionMethod(ctx)) {
    boolean sync=configuration.getCacheMode().isSynchronous();
    if (trace) {
      log.trace("[" + rpcManager.getTransport().getAddress() + "] Running remote prepare for global tx {1}.  Synchronous? {2}",rpcManager.getTransport().getAddress(),command.getGlobalTransaction(),sync);
    }
    List<Address> recipients=new ArrayList<Address>(ctx.getTransactionContext().getTransactionParticipants());
    replicateCall(ctx,recipients,command,sync,false);
  }
  return retVal;
}
