{
  Object retVal=invokeNextInterceptor(ctx,command);
  boolean sync=isSynchronous(ctx);
  if (shouldInvokeRemoteTxCommand(ctx)) {
    int newCacheViewId=-1;
    stateTransferLock.waitForStateTransferToEnd(ctx,command,newCacheViewId);
    NotifyingNotifiableFuture<Object> f=null;
    if (isL1CacheEnabled && command.isOnePhaseCommit())     f=l1Manager.flushCache(ctx.getLockedKeys(),null,null);
    Collection<Address> recipients=dm.getAffectedNodes(ctx.getAffectedKeys());
    rpcManager.invokeRemotely(recipients,command,sync);
    ((LocalTxInvocationContext)ctx).remoteLocksAcquired(recipients);
    if (f != null)     f.get();
  }
  return retVal;
}
