{
  if (flags == null || flags.length == 0)   return this;
 else {
    boolean containsAll;
    if (this.flags != null) {
      containsAll=true;
      for (      Flag flag : flags) {
        if (!this.flags.contains(flag)) {
          containsAll=false;
        }
      }
    }
 else {
      containsAll=false;
    }
    if (containsAll) {
      return this;
    }
 else {
      EnumSet<Flag> newFlags=this.flags != null ? EnumSet.copyOf(this.flags) : EnumSet.noneOf(Flag.class);
      Collections.addAll(newFlags,flags);
      return new DecoratedCache<K,V>(this.cacheImplementation,this.classLoader.get(),newFlags);
    }
  }
}
