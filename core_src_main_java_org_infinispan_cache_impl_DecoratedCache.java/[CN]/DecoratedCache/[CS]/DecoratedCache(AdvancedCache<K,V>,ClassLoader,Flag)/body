{
  super(delegate);
  if (flags == null || flags.length == 0)   this.flags=null;
 else {
    this.flags=EnumSet.noneOf(Flag.class);
    this.flags.addAll(Arrays.asList(flags));
  }
  this.classLoader=new WeakReference<ClassLoader>(classLoader);
  if (flags == null && classLoader == null)   throw new IllegalArgumentException("There is no point in using a DecoratedCache if neither a ClassLoader nor any Flags are set.");
  cacheImplementation=(CacheImpl<K,V>)delegate;
}
