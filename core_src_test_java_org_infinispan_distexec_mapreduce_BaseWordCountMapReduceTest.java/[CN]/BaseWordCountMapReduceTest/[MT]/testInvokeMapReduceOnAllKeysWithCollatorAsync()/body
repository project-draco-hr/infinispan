{
  MapReduceTask<String,String,String,Integer> task=invokeMapReduce(null);
  Future<Integer> future=task.executeAsynchronously(new Collator<String,Integer,Integer>(){
    @Override public Integer collate(    final Map<String,Integer> reducedResults){
      log.tracef("Executing collator");
      int sum=0;
      for (      Entry<String,Integer> e : reducedResults.entrySet()) {
        sum+=e.getValue();
      }
      return sum;
    }
  }
);
  Integer totalWords=future.get();
  assertTotalWordCount(totalWords);
}
