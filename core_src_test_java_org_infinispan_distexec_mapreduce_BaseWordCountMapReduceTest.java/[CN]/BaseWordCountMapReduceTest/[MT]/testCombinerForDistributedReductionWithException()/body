{
  MapReduceTask<String,String,String,Integer> task=invokeMapReduce(null);
  task.combinedWith(new SimulatedRuntimeExceptionReducer());
  try {
    task.execute();
    Assert.fail("Should have thrown exception");
  }
 catch (  Exception e) {
    Assert.assertTrue("Exception thrown should be CacheException but it is " + e,e instanceof CacheException);
    Throwable cause=e.getCause();
    while (cause.getCause() != null) {
      cause=cause.getCause();
    }
    Assert.assertTrue("Exception thrown should be RuntimeException but it is " + cause,cause instanceof RuntimeException);
  }
}
