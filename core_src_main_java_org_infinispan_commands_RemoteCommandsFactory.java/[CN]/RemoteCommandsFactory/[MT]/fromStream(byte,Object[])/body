{
  ReplicableCommand command;
switch (id) {
case PutKeyValueCommand.COMMAND_ID:
    command=new PutKeyValueCommand();
  break;
case LockControlCommand.COMMAND_ID:
command=new LockControlCommand();
break;
case PutMapCommand.COMMAND_ID:
command=new PutMapCommand();
break;
case RemoveCommand.COMMAND_ID:
command=new RemoveCommand();
break;
case ReplaceCommand.COMMAND_ID:
command=new ReplaceCommand();
break;
case GetKeyValueCommand.COMMAND_ID:
command=new GetKeyValueCommand();
break;
case ClearCommand.COMMAND_ID:
command=new ClearCommand();
break;
case PrepareCommand.COMMAND_ID:
command=new PrepareCommand();
break;
case CommitCommand.COMMAND_ID:
command=new CommitCommand();
break;
case RollbackCommand.COMMAND_ID:
command=new RollbackCommand();
break;
case MultipleRpcCommand.COMMAND_ID:
command=new MultipleRpcCommand();
break;
case SingleRpcCommand.COMMAND_ID:
command=new SingleRpcCommand();
break;
case InvalidateCommand.COMMAND_ID:
command=new InvalidateCommand();
break;
case InvalidateL1Command.COMMAND_ID:
command=new InvalidateL1Command();
break;
case StateTransferControlCommand.COMMAND_ID:
command=new StateTransferControlCommand();
((StateTransferControlCommand)command).init(transport);
break;
case ClusteredGetCommand.COMMAND_ID:
command=new ClusteredGetCommand();
break;
case RehashControlCommand.COMMAND_ID:
command=new RehashControlCommand(transport);
break;
case RemoveCacheCommand.COMMAND_ID:
command=new RemoveCacheCommand(cacheManager,registry);
break;
case RemoveRecoveryInfoCommand.COMMAND_ID:
command=new RemoveRecoveryInfoCommand();
break;
case GetInDoubtTransactionsCommand.COMMAND_ID:
command=new GetInDoubtTransactionsCommand();
break;
default :
ModuleCommandFactory mcf=commandFactories.get(id);
if (mcf != null) return mcf.fromStream(id,parameters);
 else throw new CacheException("Unknown command id " + id + "!");
}
command.setParameters(id,parameters);
return command;
}
