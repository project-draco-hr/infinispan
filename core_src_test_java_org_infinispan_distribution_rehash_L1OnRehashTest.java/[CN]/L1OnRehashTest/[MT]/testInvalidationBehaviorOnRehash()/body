{
  List<MagicKey> keys=init();
  System.out.println("Old CH positions are " + getConsistentHash(c1));
  performRehashEvent();
  int joinerPos=waitForRehashCompletion();
  System.out.println("New CH positions are " + getConsistentHash(c1));
  TestingUtil.sleepThread(2000);
  Cache<Object,String> cacheToCheckForInvalidation=joinerPos + 1 == caches.size() ? caches.get(0) : caches.get(joinerPos + 1);
  MagicKey rehashedKey=keys.get(joinerPos == 1 ? 0 : 1);
  if (l1OnRehash)   assertIsInL1(cacheToCheckForInvalidation,rehashedKey);
 else   assertIsNotInL1(cacheToCheckForInvalidation,rehashedKey);
  assertIsInContainerImmortal(joiner,rehashedKey);
}
