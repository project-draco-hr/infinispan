{
  if (log.isTraceEnabled())   log.trace("Discover resources with context: " + discoveryContext);
  Set<DiscoveredResourceDetails> discoveredResources=new HashSet<DiscoveredResourceDetails>();
  EmsConnection conn=discoveryContext.getParentResourceComponent().getConnection();
  if (log.isTraceEnabled())   log.trace("Connection to ems server stablished: " + conn);
  ObjectNameQueryUtility queryUtility=new ObjectNameQueryUtility(CACHE_QUERY);
  List<EmsBean> beans=conn.queryBeans(queryUtility.getTranslatedQuery());
  if (log.isTraceEnabled())   log.trace("Querying [" + queryUtility.getTranslatedQuery() + "] returned beans: "+ beans);
  for (  EmsBean bean : beans) {
    String name=bean.getBeanName().getCanonicalName();
    name=name.substring(name.indexOf("jmx-resource=") + 13);
    DiscoveredResourceDetails detail=new DiscoveredResourceDetails(discoveryContext.getResourceType(),bean.getBeanName().getCanonicalName(),name,null,"One cache within Infinispan",discoveryContext.getDefaultPluginConfiguration(),null);
    discoveredResources.add(detail);
    log.info("Discovered new ...  " + bean.getBeanName().getCanonicalName());
  }
  return discoveredResources;
}
