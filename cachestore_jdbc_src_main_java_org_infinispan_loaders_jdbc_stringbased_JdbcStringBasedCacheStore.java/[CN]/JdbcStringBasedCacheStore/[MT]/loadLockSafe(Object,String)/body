{
  Connection conn=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    String sql=tableManipulation.getSelectRowSql();
    conn=connectionFactory.getConnection();
    ps=conn.prepareStatement(sql);
    ps.setString(1,lockingKey);
    rs=ps.executeQuery();
    if (rs.next()) {
      InputStream inputStream=rs.getBinaryStream(2);
      InternalCacheValue icv=(InternalCacheValue)JdbcUtil.unmarshall(getMarshaller(),inputStream);
      InternalCacheEntry storedEntry=icv.toInternalCacheEntry(key);
      if (storedEntry.isExpired()) {
        if (log.isTraceEnabled()) {
          log.trace("Not returning '" + storedEntry + "' as it is expired. It will be removed from DB by purging thread!");
        }
        return null;
      }
      return storedEntry;
    }
    return null;
  }
 catch (  SQLException e) {
    String message="SQL error while fetching strored entry with key:" + key + " lockingKey: "+ lockingKey;
    log.error(message,e);
    throw new CacheLoaderException(message,e);
  }
 finally {
    JdbcUtil.safeClose(rs);
    JdbcUtil.safeClose(ps);
    connectionFactory.releaseConnection(conn);
  }
}
