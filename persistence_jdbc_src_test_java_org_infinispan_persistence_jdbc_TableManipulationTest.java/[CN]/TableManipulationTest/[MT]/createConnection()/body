{
  JdbcStringBasedStoreConfigurationBuilder storeBuilder=TestCacheManagerFactory.getDefaultCacheConfiguration(false).persistence().addStore(JdbcStringBasedStoreConfigurationBuilder.class);
  UnitTestDatabaseManager.setDialect(storeBuilder);
  UnitTestDatabaseManager.buildTableManipulation(storeBuilder.table(),false);
  factoryConfiguration=UnitTestDatabaseManager.configureUniqueConnectionFactory(storeBuilder).create();
  tableManipulation=new TableManipulation(storeBuilder.table().create(),storeBuilder.create().dialect());
  if (factoryConfiguration instanceof SimpleConnectionFactoryConfiguration) {
    SimpleConnectionFactoryConfiguration simpleConfiguration=(SimpleConnectionFactoryConfiguration)factoryConfiguration;
    connection=DriverManager.getConnection(simpleConfiguration.connectionUrl(),simpleConfiguration.username(),simpleConfiguration.password());
  }
 else   if (factoryConfiguration instanceof PooledConnectionFactoryConfiguration) {
    PooledConnectionFactoryConfiguration pooledConfiguration=(PooledConnectionFactoryConfiguration)factoryConfiguration;
    connection=DriverManager.getConnection(pooledConfiguration.connectionUrl(),pooledConfiguration.username(),pooledConfiguration.password());
  }
  tableManipulation.setCacheName("aName");
}
