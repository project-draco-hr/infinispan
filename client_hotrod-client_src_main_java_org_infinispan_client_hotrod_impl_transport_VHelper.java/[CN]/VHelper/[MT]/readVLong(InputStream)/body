{
  long result=0;
  for (int i=0; i < MAX_VLONG_BYTES; i++) {
    long aByte=nextByte(is);
    boolean hasMore=(aByte & 128) > 0;
    aByte&=127;
    result=result | (aByte << (i * 7));
    if (!hasMore)     break;
  }
  if (result < 0)   throw new TransportException("negative number read: " + result);
  return result;
}
