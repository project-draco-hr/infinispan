{
  if (ch instanceof UnionConsistentHash)   return removeAddressFromUnionConsistentHash((UnionConsistentHash)ch,toRemove,c,withTopology);
 else {
    ConsistentHash newCH=constructConsistentHashInstance(c,withTopology);
    Set<Address> caches=new HashSet<Address>(ch.getCaches());
    caches.remove(toRemove);
    newCH.setCaches(caches);
    return newCH;
  }
}
