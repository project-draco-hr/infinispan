{
  Hash hf=null;
  int numVirtualNodes=1;
  GroupManager groupManager=null;
  if (template instanceof AbstractWheelConsistentHash) {
    AbstractWheelConsistentHash wTemplate=(AbstractWheelConsistentHash)template;
    hf=wTemplate.hashFunction;
    numVirtualNodes=wTemplate.numVirtualNodes;
    groupManager=wTemplate.groupManager;
  }
  ConsistentHash ch=constructConsistentHashInstance(template.getClass(),hf,numVirtualNodes,groupManager);
  if (addresses != null && !addresses.isEmpty())   ch.setCaches(toSet(addresses));
  return ch;
}
