{
  if (ch instanceof UnionConsistentHash)   return removeAddressFromUnionConsistentHash((UnionConsistentHash)ch,toRemove,c,topologyInfo);
 else {
    ConsistentHash newCH=constructConsistentHashInstance(c);
    Set<Address> caches=new HashSet<Address>(ch.getCaches());
    caches.remove(toRemove);
    newCH.setCaches(caches);
    newCH.setTopologyInfo(topologyInfo);
    return newCH;
  }
}
