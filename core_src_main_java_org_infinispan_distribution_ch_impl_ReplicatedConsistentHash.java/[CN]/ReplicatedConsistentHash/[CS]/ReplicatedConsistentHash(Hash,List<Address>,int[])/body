{
  this.hashFunction=hashFunction;
  this.members=Collections.unmodifiableList(new ArrayList<>(members));
  this.membersSet=Collections.unmodifiableSet(new HashSet<>(members));
  this.primaryOwners=primaryOwners;
  Set<Integer> segmentIds=new HashSet<>(primaryOwners.length);
  for (int i=0; i < primaryOwners.length; i++) {
    segmentIds.add(i);
  }
  segments=Collections.unmodifiableSet(segmentIds);
  segmentSize=Util.getSegmentSize(primaryOwners.length);
}
