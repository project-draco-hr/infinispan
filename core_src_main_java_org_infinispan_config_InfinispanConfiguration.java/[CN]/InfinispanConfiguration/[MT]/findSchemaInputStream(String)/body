{
  boolean validating=!skipSchemaValidation();
  if (!validating)   return null;
  FileLookup fileLookup=new FileLookup();
  InputStream is=null;
  if (localPathToSchema != null) {
    is=fileLookup.lookupFile(localPathToSchema,null);
    if (is != null) {
      log.debugf("Using schema %s",localPathToSchema);
      return is;
    }
    if (log.isDebugEnabled()) {
      log.debugf("Could not find schema on path %s, resolving %s to %s",localPathToSchema,SCHEMA_SYSTEM_PROPERTY,schemaPath());
    }
  }
  is=fileLookup.lookupFile(schemaPath(),null);
  if (is != null) {
    log.debugf("Using schema %s",schemaPath());
    return is;
  }
  if (log.isDebugEnabled()) {
    log.debugf("Could not find schema on path %s, resolving %s to %s",schemaPath(),SCHEMA_SYSTEM_PROPERTY,schemaURL());
  }
  try {
    is=new URL(schemaURL()).openStream();
    log.debugf("Using schema %s",schemaURL());
    return is;
  }
 catch (  Exception e) {
  }
  log.couldNotResolveConfigurationSchema(localPathToSchema,schemaPath(),schemaURL());
  return null;
}
