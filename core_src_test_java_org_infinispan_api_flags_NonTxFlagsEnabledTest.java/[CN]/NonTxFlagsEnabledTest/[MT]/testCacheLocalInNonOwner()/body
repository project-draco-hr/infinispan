{
  addClusterEnabledCacheManager(getConfigurationBuilder());
  waitForClusterToForm("replication");
  final AdvancedCache<Object,String> cache1=advancedCache(0,"replication");
  final AdvancedCache<Object,String> cache2=advancedCache(1,"replication");
  final AdvancedCache<Object,String> cache3=advancedCache(2,"replication");
  final Object key=new MagicKey("k-no",cache1);
  cache3.withFlags(CACHE_MODE_LOCAL).put(key,"value");
  assertEquals("Cache '" + cache3 + "' should have the key.","value",cache3.get(key));
  assertNull("Cache '" + cache1 + "' should *not* have the key.",cache1.get(key));
  assertNull("Cache '" + cache2 + "' should *not* have the key.",cache2.get(key));
}
