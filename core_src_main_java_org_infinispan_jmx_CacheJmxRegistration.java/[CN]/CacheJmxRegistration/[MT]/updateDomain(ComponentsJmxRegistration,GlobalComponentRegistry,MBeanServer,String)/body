{
  CacheManagerJmxRegistration managerJmxReg=componentRegistry.getComponent(CacheManagerJmxRegistration.class);
  if (!globalConfig.isExposeGlobalJmxStatistics() && jmxDomain == null) {
    String tmpJmxDomain=JmxUtil.buildJmxDomain(globalConfig,mBeanServer,groupName);
synchronized (managerJmxReg) {
      if (managerJmxReg.jmxDomain == null) {
        if (!tmpJmxDomain.equals(globalConfig.getJmxDomain()) && !globalConfig.isAllowDuplicateDomains()) {
          log.cacheManagerAlreadyRegistered(globalConfig.getJmxDomain());
          throw new JmxDomainConflictException(String.format("Domain already registered %s",globalConfig.getJmxDomain()));
        }
        managerJmxReg.jmxDomain=tmpJmxDomain;
      }
      jmxDomain=managerJmxReg.jmxDomain;
    }
  }
 else {
    jmxDomain=managerJmxReg.jmxDomain == null ? globalConfig.getJmxDomain() : managerJmxReg.jmxDomain;
  }
  registrar.setJmxDomain(jmxDomain);
}
