{
  CacheManagerJmxRegistration managerJmxReg=componentRegistry.getComponent(CacheManagerJmxRegistration.class);
  if (!globalConfig.globalJmxStatistics().enabled() && jmxDomain == null) {
    String tmpJmxDomain=JmxUtil.buildJmxDomain(globalConfig,mBeanServer,groupName);
synchronized (managerJmxReg) {
      if (managerJmxReg.jmxDomain == null) {
        if (!tmpJmxDomain.equals(globalConfig.globalJmxStatistics().domain()) && !globalConfig.globalJmxStatistics().allowDuplicateDomains()) {
          log.cacheManagerAlreadyRegistered(globalConfig.globalJmxStatistics().domain());
          throw new JmxDomainConflictException(String.format("Domain already registered %s",globalConfig.globalJmxStatistics().domain()));
        }
        managerJmxReg.jmxDomain=tmpJmxDomain;
      }
      jmxDomain=managerJmxReg.jmxDomain;
    }
  }
 else {
    jmxDomain=managerJmxReg.jmxDomain == null ? globalConfig.globalJmxStatistics().domain() : managerJmxReg.jmxDomain;
  }
  registrar.setJmxDomain(jmxDomain);
}
