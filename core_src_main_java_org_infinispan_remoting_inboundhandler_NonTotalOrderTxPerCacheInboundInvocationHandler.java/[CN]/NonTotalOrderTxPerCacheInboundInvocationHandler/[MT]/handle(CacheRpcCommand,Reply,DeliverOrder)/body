{
  if (order == DeliverOrder.TOTAL) {
    unexpectedDeliverMode(command,order);
  }
  try {
    final int commandTopologyId=extractCommandTopologyId(command);
    final boolean waitTransactionalData=command.getCommandId() != StateRequestCommand.COMMAND_ID;
    final boolean onExecutorService=executeOnExecutorService(order,command);
    handleRunnable(createDefaultRunnable(command,reply,commandTopologyId,waitTransactionalData,onExecutorService),onExecutorService);
  }
 catch (  Throwable throwable) {
    reply.reply(exceptionHandlingCommand(command,throwable));
  }
}
