{
  if (!shouldInvokeRemoteTxCommand(ctx))   return super.visitPrepareCommand(ctx,command);
  LocalTransaction remoteTx=txTable.getLocalTransaction(command.getGlobalTransaction());
  if (remoteTx.isFromRemoteSite()) {
    return invokeNextInterceptor(ctx,command);
  }
  BackupResponse backupResponse=backupSender.backupPrepare(command);
  Object result=invokeNextInterceptor(ctx,command);
  backupSender.processResponses(backupResponse,command,ctx.getTransaction());
  return result;
}
