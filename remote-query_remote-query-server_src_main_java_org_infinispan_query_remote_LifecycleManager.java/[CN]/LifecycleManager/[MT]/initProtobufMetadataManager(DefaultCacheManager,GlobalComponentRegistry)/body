{
  SerializationContext serCtx=ProtobufUtil.newSerializationContext(new org.infinispan.protostream.ConfigurationBuilder().build());
  try {
    MarshallerRegistration.registerMarshallers(serCtx);
  }
 catch (  IOException|DescriptorParserException e) {
    throw new CacheException("Failed to initialise serialization context",e);
  }
  ProtobufMetadataManager protobufMetadataManager=new ProtobufMetadataManager(serCtx);
  gcr.registerComponent(protobufMetadataManager,ProtobufMetadataManager.class);
  registerProtobufMetadataManagerMBean(protobufMetadataManager,gcr,cacheManager.getName());
}
