{
  SerializationContext serCtx=ProtobufUtil.newSerializationContext();
  try {
    MarshallerRegistration.registerMarshallers(serCtx);
  }
 catch (  IOException e) {
    throw new CacheException("Failed to initialise serialization context",e);
  }
catch (  Descriptors.DescriptorValidationException e) {
    throw new CacheException("Failed to initialise serialization context",e);
  }
  ProtobufMetadataManager protobufMetadataManager=new ProtobufMetadataManager(serCtx);
  gcr.registerComponent(protobufMetadataManager,ProtobufMetadataManager.class);
  registerProtobufMetadataManagerMBean(protobufMetadataManager,gcr,cacheManager.getName());
}
