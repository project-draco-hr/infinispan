{
  boolean shouldSkipLocking=ctx.hasFlag(Flag.SKIP_LOCKING);
  if (!ctx.hasLockedKey(key) && !shouldSkipLocking) {
    if (lockManager.lockAndRecord(key,ctx)) {
      return true;
    }
 else {
      Object owner=lockManager.getOwner(key);
      throw new TimeoutException("Unable to acquire lock after [" + Util.prettyPrintTime(getLockAcquisitionTimeout(ctx)) + "] on key ["+ key+ "] for requestor ["+ ctx.getLockOwner()+ "]! Lock held by ["+ owner+ "]");
    }
  }
  return false;
}
