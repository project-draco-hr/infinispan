{
  L lock=locks.get(key);
  if (lock == null) {
    lock=newLock();
    L existingLock=locks.putIfAbsent(key,lock);
    if (existingLock != null)     lock=existingLock;
  }
  return lock;
}
