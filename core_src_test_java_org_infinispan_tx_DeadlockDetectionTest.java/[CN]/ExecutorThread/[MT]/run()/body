{
  Operations operation;
  boolean run=true;
  while (run) {
    try {
      operation=(Operations)toExecute.take();
    }
 catch (    InterruptedException e) {
      throw new RuntimeException(e);
    }
    System.out.println("about to process operation " + operation);
switch (operation) {
case BEGGIN_TX:
{
        TransactionManager txManager=TestingUtil.getTransactionManager(cache);
        try {
          txManager.begin();
          setResponse(OperationsResult.BEGGIN_TX_OK);
        }
 catch (        Exception e) {
          log.trace("Failure on beggining tx",e);
          setResponse(e);
        }
        break;
      }
case COMMIT_TX:
{
      TransactionManager txManager=TestingUtil.getTransactionManager(cache);
      try {
        txManager.commit();
        setResponse(OperationsResult.COMMIT_TX_OK);
      }
 catch (      Exception e) {
        log.trace("Exception while committing tx",e);
        setResponse(e);
      }
      break;
    }
case PUT_KEY_VALUE:
{
    try {
      cache.put(key,value);
      log.trace("Successfully exucuted putKeyValue(" + key + ", "+ value+ ")");
      setResponse(OperationsResult.PUT_KEY_VALUE_OK);
    }
 catch (    Exception e) {
      log.trace("Exception while executing putKeyValue(" + key + ", "+ value+ ")",e);
      setResponse(e);
    }
    break;
  }
case STOP_THREAD:
{
  System.out.println("Exiting...");
  toExecute=null;
  run=false;
  break;
}
}
if (responseLatch != null) responseLatch.countDown();
}
setResponse("EXIT");
}
