{
  commandsFactory.initializeReplicableCommand(command,false);
  final NotifyingNotifiableFuture<Map<Address,Response>> remoteFuture=new NotifyingFutureImpl<>();
  rpcManager.invokeRemotelyInFuture(remoteFuture,null,command,rpcManager.getDefaultRpcOptions(true,false));
  final Future<Response> localFuture=asyncExecutor.submit(LocalInvocation.newInstance(responseGenerator,command,commandsFactory,rpcManager.getAddress()));
  final Map<Address,Response> responseMap=new HashMap<>();
  responseMap.put(rpcManager.getAddress(),localFuture.get());
  responseMap.putAll(remoteFuture.get());
  return responseMap;
}
