{
  int minMembers=Math.min(oldMembers.size(),newMembers.size());
  int maxMembers=Math.max(oldMembers.size(),newMembers.size());
  if (maxMembers > numSegments)   return numSegments * numOwners;
  Set<Address> addedMembers=new HashSet<Address>(newMembers);
  addedMembers.removeAll(oldMembers);
  Set<Address> removedMembers=new HashSet<Address>(oldMembers);
  removedMembers.removeAll(newMembers);
  int minMoves=(addedMembers.size() + removedMembers.size()) * numSegments * numOwners / minMembers;
  int extraMoves=maxMembers % numSegments;
  return (int)(1.5 * (minMoves + extraMoves));
}
