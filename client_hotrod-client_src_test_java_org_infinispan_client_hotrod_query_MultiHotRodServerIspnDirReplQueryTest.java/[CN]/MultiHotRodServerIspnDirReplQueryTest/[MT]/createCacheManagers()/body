{
  ConfigurationBuilder defaultConfiguration=getDefaultClusteredCacheConfig(CacheMode.REPL_SYNC,false);
  ConfigurationBuilder builder=hotRodCacheConfiguration(getDefaultClusteredCacheConfig(CacheMode.REPL_SYNC,false));
  builder.indexing().index(Index.LOCAL).addProperty("default.directory_provider","infinispan").addProperty("default.exclusive_index_use","false").addProperty("lucene_version","LUCENE_CURRENT");
  createHotRodServers(2,defaultConfiguration);
  for (  EmbeddedCacheManager cm : cacheManagers) {
    cm.defineConfiguration("queryableCache",builder.build());
    cm.getGlobalComponentRegistry().getComponent(ProtobufMetadataManager.class).registerProtofiles("/sample_bank_account/bank.proto","/infinispan/indexing.proto","/google/protobuf/descriptor.proto");
  }
  for (  RemoteCacheManager rcm : clients) {
    MarshallerRegistration.registerMarshallers(ProtoStreamMarshaller.getSerializationContext(rcm));
  }
  waitForClusterToForm();
  remoteCache0=client(0).getCache("queryableCache");
  remoteCache1=client(1).getCache("queryableCache");
}
