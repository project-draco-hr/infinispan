{
  if (tableName == null || "".equals(tableName)) {
    throw new HBaseException("Table name must not be empty.");
  }
  if (isEmpty(key)) {
    throw new IllegalArgumentException("key cannot be null or empty.");
  }
  if (isEmpty(columnFamilies)) {
    throw new IllegalArgumentException("columnFamilies cannot be null or empty.");
  }
  log.debugf("Reading row from table %s and key %s.",tableName,key);
  HTable table=null;
  try {
    table=new HTable(CONFIG,tableName);
    Get g=new Get(Bytes.toBytes(key));
    Result result=table.get(g);
    Map<String,Map<String,byte[]>> resultMap=new HashMap<String,Map<String,byte[]>>(columnFamilies.size());
    if (result.isEmpty()) {
      return resultMap;
    }
    for (    String cfName : columnFamilies) {
      Map<String,byte[]> cfDataMap=new HashMap<String,byte[]>();
      Map<byte[],byte[]> familyMap=result.getFamilyMap(Bytes.toBytes(cfName));
      for (      Entry<byte[],byte[]> familyMapEntry : familyMap.entrySet()) {
        cfDataMap.put(new String(familyMapEntry.getKey()),familyMapEntry.getValue());
      }
      resultMap.put(cfName,cfDataMap);
    }
    return resultMap;
  }
 catch (  IOException ex) {
    throw new HBaseException("Exception happened while reading row from HBase.",ex);
  }
 finally {
    try {
      table.close();
    }
 catch (    Exception ex) {
    }
  }
}
