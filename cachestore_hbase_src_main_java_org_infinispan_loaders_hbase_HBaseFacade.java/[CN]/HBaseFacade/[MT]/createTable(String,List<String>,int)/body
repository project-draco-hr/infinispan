{
  if (name == null || "".equals(name)) {
    throw new HBaseException("Table name must not be empty.");
  }
  HBaseAdmin admin=null;
  try {
    admin=new HBaseAdmin(CONFIG);
    HTableDescriptor desc=new HTableDescriptor(name.getBytes());
    if (columnFamilies != null) {
      for (      String cf : columnFamilies) {
        HColumnDescriptor colFamilyDesc=new HColumnDescriptor(cf.getBytes());
        colFamilyDesc.setMaxVersions(maxVersions);
        desc.addFamily(colFamilyDesc);
      }
    }
    int retries=0;
    do {
      try {
        admin.createTable(desc);
        return;
      }
 catch (      PleaseHoldException e) {
        TimeUnit.SECONDS.sleep(1);
        retries++;
      }
    }
 while (retries < 10);
    admin.createTable(desc);
  }
 catch (  Exception ex) {
    throw new HBaseException("Exception occurred when creating HBase table.",ex);
  }
 finally {
    close(admin);
  }
}
