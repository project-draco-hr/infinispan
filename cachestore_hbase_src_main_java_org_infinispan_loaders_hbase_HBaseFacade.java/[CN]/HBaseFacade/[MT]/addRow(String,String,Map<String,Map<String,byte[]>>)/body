{
  if (tableName == null || "".equals(tableName)) {
    throw new HBaseException("Table name must not be empty.");
  }
  if (isEmpty(key)) {
    throw new IllegalArgumentException("key cannot be null or empty.");
  }
  if (isEmpty(dataMap)) {
    throw new IllegalArgumentException("dataMap cannot be null or empty.");
  }
  log.debugf("Writing %s data values to table %s and key %s.",dataMap.size(),tableName,key);
  HTable table=null;
  try {
    table=new HTable(CONFIG,tableName);
    Put p=new Put(Bytes.toBytes(key));
    for (    Entry<String,Map<String,byte[]>> columFamilyEntry : dataMap.entrySet()) {
      String cfName=columFamilyEntry.getKey();
      Map<String,byte[]> cfDataCells=columFamilyEntry.getValue();
      for (      Entry<String,byte[]> dataCellEntry : cfDataCells.entrySet()) {
        p.add(Bytes.toBytes(cfName),Bytes.toBytes(dataCellEntry.getKey()),Bytes.toBytes(ByteBuffer.wrap(dataCellEntry.getValue())));
      }
    }
    table.put(p);
  }
 catch (  IOException ex) {
    throw new HBaseException("Exception happened while " + "writing row to HBase.",ex);
  }
 finally {
    try {
      table.close();
    }
 catch (    Exception ex) {
    }
  }
}
