{
  serCtx=ProtobufMetadataManagerImpl.getSerializationContextInternal(cache.getCacheManager());
  queryCache=cache.getCacheManager().getGlobalComponentRegistry().getComponent(QueryCache.class);
  matcher=cache.getAdvancedCache().getComponentRegistry().getComponent(matcherImplClass);
  if (matcher == null) {
    throw new CacheException("Expected component not found in registry: " + matcherImplClass.getName());
  }
  Configuration cfg=cache.getCacheConfiguration();
  usesValueWrapper=cfg.indexing().index().isEnabled() && !cfg.compatibility().enabled();
}
