{
  CacheEntry e=ctx.lookupEntry(key);
  if (e == null || e.isNull() || e.isRemoved()) {
    nonExistent=true;
    log.trace("Nothing to remove since the entry is null or we have a null entry");
    if (value == null) {
      if (e != null) {
        e.setChanged(true);
        e.setRemoved(true);
      }
      return null;
    }
 else {
      successful=false;
      return false;
    }
  }
  if (isConditional() && ctx.isInTxScope() && !ctx.isOriginLocal()&& !(this instanceof InvalidateCommand)) {
    if (ignorePreviousValue) {
      return performRemove(e,ctx);
    }
 else {
      return value == null ? null : true;
    }
  }
  if (!(e instanceof MVCCEntry))   ctx.putLookedUpEntry(key,null);
  if (!ignorePreviousValue && value != null && e.getValue() != null && !e.getValue().equals(value)) {
    successful=false;
    return false;
  }
  if (this instanceof EvictCommand) {
    e.setEvicted(true);
  }
  return performRemove(e,ctx);
}
