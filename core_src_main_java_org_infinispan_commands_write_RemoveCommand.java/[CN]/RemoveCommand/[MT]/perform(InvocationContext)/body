{
  MVCCEntry e=(MVCCEntry)ctx.lookupEntry(key);
  if (e == null || e.isNull()) {
    nonExistent=true;
    log.trace("Nothing to remove since the entry is null or we have a null entry");
    if (value == null) {
      return null;
    }
 else {
      successful=false;
      return false;
    }
  }
  if (value != null && e.getValue() != null && !e.getValue().equals(value)) {
    successful=false;
    return false;
  }
  notify(ctx,e.getValue(),true);
  e.setRemoved(true);
  e.setValid(false);
  notify(ctx,null,false);
  return value == null ? e.getValue() : true;
}
