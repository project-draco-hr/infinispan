{
  try {
    if (!blockAfter) {
      blockIfNeeded(ctx,command);
    }
    return ctx.shortCircuit(ctx.forkInvocationSync(command));
  }
  finally {
    if (blockAfter) {
      blockIfNeeded(ctx,command);
    }
  }
}
