{
  c1=TestCacheManagerFactory.createLocalCacheManager(false).getCache();
  c2=TestCacheManagerFactory.createLocalCacheManager(false).getCache();
  registerCacheManager(c1.getCacheManager(),c2.getCacheManager());
  hotRodServer1=TestHelper.startHotRodServer(c1.getCacheManager());
  hotRodServer2=TestHelper.startHotRodServer(c2.getCacheManager());
  String servers=TestHelper.getServersString(hotRodServer1,hotRodServer2);
  Properties hotrodClientConf=new Properties();
  hotrodClientConf.setProperty(ConfigurationProperties.SERVER_LIST,servers);
  hotrodClientConf.setProperty("maxActive","2");
  hotrodClientConf.setProperty("maxTotal","8");
  hotrodClientConf.setProperty("maxIdle","6");
  hotrodClientConf.setProperty("whenExhaustedAction","1");
  hotrodClientConf.setProperty("testOnBorrow","false");
  hotrodClientConf.setProperty("testOnReturn","false");
  hotrodClientConf.setProperty("timeBetweenEvictionRunsMillis","-2");
  hotrodClientConf.setProperty("minEvictableIdleTimeMillis","7");
  hotrodClientConf.setProperty("testWhileIdle","true");
  hotrodClientConf.setProperty("minIdle","-5");
  hotrodClientConf.setProperty("lifo","true");
  hotrodClientConf.setProperty("infinispan.client.hotrod.ping_on_startup","false");
  remoteCacheManager=new RemoteCacheManager(hotrodClientConf);
  remoteCache=remoteCacheManager.getCache();
  TcpTransportFactory tcpConnectionFactory=(TcpTransportFactory)extractField(remoteCacheManager,"transportFactory");
  connectionPool=(GenericKeyedObjectPool<?,?>)extractField(tcpConnectionFactory,"connectionPool");
  workerThread1=new WorkerThread(remoteCache);
  workerThread2=new WorkerThread(remoteCache);
  workerThread3=new WorkerThread(remoteCache);
  workerThread4=new WorkerThread(remoteCache);
  workerThread5=new WorkerThread(remoteCache);
  workerThread6=new WorkerThread(remoteCache);
  hrServ1Addr=new InetSocketAddress("localhost",hotRodServer1.getPort());
  hrServ2Addr=new InetSocketAddress("localhost",hotRodServer2.getPort());
}
