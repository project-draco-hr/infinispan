{
  Address localAddress=rpcManager.getAddress();
  if (work.getIdInString() == null) {
    return localAddress;
  }
  int segment=getSegment(stringToKey(work.getIdInString()));
  Address lockHolder=getLockHolder(replaceShard(getIndexName(),segment));
  logDebug("Lock holder for %d is %s",segment,lockHolder);
  Address destination;
  if (!hasOwnership) {
    logDebug("Lost ownership, new owner is %s",nextOwner);
    destination=nextOwner;
  }
 else {
    destination=(lockHolder != null && !localAddress.equals(lockHolder)) ? lockHolder : localAddress;
  }
  return destination;
}
