{
  Set<String> fileList=(Set<String>)cache.get(new FileListCacheKey(indexName));
  AssertJUnit.assertNotNull(fileList);
  AssertJUnit.assertTrue(fileList.contains(fileName) == expectRegisteredInFat);
  FileMetadata metadata=(FileMetadata)cache.get(new FileCacheKey(indexName,fileName));
  AssertJUnit.assertNotNull(metadata);
  long totalFileSize=metadata.getSize();
  int chunkNumbers=(int)(totalFileSize / chunkSize);
  for (int i=0; i < chunkNumbers; i++) {
    AssertJUnit.assertNotNull(cache.get(new ChunkCacheKey(indexName,fileName,i,metadata.getBufferSize())));
  }
  FileReadLockKey readLockKey=new FileReadLockKey(indexName,fileName);
  Object value=cache.get(readLockKey);
  if (expectedReadcount <= 1) {
    AssertJUnit.assertTrue("readlock value is " + value,value == null || Integer.valueOf(1).equals(value));
  }
 else {
    AssertJUnit.assertNotNull(value);
    AssertJUnit.assertTrue(value instanceof Integer);
    int v=(Integer)value;
    AssertJUnit.assertEquals(v,expectedReadcount);
  }
}
