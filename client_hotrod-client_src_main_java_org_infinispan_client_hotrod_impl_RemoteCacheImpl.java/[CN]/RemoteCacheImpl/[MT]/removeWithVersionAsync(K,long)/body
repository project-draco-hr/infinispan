{
  assertRemoteCacheManagerIsStarted();
  final NotifyingFutureImpl<Boolean> result=new NotifyingFutureImpl<Boolean>();
  Future<Boolean> future=executorService.submit(new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      try {
        boolean removed=removeWithVersion(key,version);
        try {
          result.notifyDone(removed);
        }
 catch (        Throwable t) {
          log.trace("Error when notifying",t);
        }
        return removed;
      }
 catch (      Exception e) {
        try {
          result.notifyException(e);
        }
 catch (        Throwable t) {
          log.trace("Error when notifying",t);
        }
        throw e;
      }
    }
  }
);
  result.setFuture(future);
  return result;
}
