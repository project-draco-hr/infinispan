{
  if (config == null)   throw new IllegalStateException("Make sure you call super.init() from CacheStore extension");
  if (config.isPurgeSynchronously()) {
    purgerService=new WithinThreadExecutor();
  }
 else {
    multiThreadedPurge=supportsMultiThreadedPurge() && config.getPurgerThreads() > 1;
    purgerService=Executors.newFixedThreadPool(supportsMultiThreadedPurge() ? config.getPurgerThreads() : 1,new ThreadFactory(){
      @Override public Thread newThread(      Runnable r){
        Thread t=new Thread(r,cache.getName() + "-" + config.getCacheLoaderClassName().substring(config.getCacheLoaderClassName().lastIndexOf(".") + 1)+ "-"+ THREAD_COUNTER.getAndIncrement());
        t.setDaemon(true);
        return t;
      }
    }
);
  }
  transactions=new ConcurrentHashMap<GlobalTransaction,List<? extends Modification>>(64,0.75f,getConcurrencyLevel());
}
