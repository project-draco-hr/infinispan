{
  NotifyingFuture<Double> future=createDelayedFuture(42.0,20);
  final AtomicBoolean taskRun=new AtomicBoolean();
  final CountDownLatch futureLatch=new CountDownLatch(1);
  NotifyingFuture<Void> andThenFuture=Futures.andThen(future,new Runnable(){
    @Override public void run(){
      taskRun.set(true);
    }
  }
);
  andThenFuture.attachListener(new FutureListener<Void>(){
    @Override public void futureDone(    Future<Void> future){
      futureLatch.countDown();
    }
  }
);
  futureLatch.await();
  assertTrue(taskRun.get());
}
