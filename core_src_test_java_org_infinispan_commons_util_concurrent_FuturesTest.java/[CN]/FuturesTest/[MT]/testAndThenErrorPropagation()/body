{
  NotifyingFuture<Void> combined=Futures.combine(Arrays.asList(createFutureWithError(new CacheException())));
  NotifyingFuture<Void> andThenFuture=Futures.andThen(combined,new Runnable(){
    @Override public void run(){
      fail("Should not call afterTask if initial future has errors");
    }
  }
);
  andThenFuture.get();
}
