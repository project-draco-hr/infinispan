{
  if (this == o) {
    return true;
  }
  if (!(o instanceof MapReduceCommand)) {
    return false;
  }
  if (!super.equals(o)) {
    return false;
  }
  MapReduceCommand that=(MapReduceCommand)o;
  if (keys.equals(that.keys)) {
    return false;
  }
  if (mapper != null && reducer != null && that.mapper != null && that.reducer != null) {
    return mapper.getClass().equals(that.mapper.getClass()) && reducer.getClass().equals(that.reducer.getClass());
  }
  return false;
}
