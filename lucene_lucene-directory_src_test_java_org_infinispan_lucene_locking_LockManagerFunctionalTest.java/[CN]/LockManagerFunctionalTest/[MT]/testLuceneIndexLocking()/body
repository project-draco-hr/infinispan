{
  BaseLockFactory baseLockFactory=BaseLockFactory.INSTANCE;
  assertFalse(IndexWriter.isLocked(directory1));
  Lock obtainedLock=directory1.obtainLock(IndexWriter.WRITE_LOCK_NAME);
  assertTrue(IndexWriter.isLocked(directory1));
  assertTrue(IndexWriter.isLocked(directory2));
  assertFalse(IndexWriter.isLocked(directory3));
  obtainedLock.ensureValid();
  obtainedLock.close();
  assertFalse(IndexWriter.isLocked(directory1));
  assertFalse(IndexWriter.isLocked(directory2));
  assertFalse(IndexWriter.isLocked(directory3));
}
