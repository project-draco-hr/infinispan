{
  DummyTransaction transaction=tm_.getTransaction();
  Collection<XAResource> resources=transaction.getEnlistedResources();
  for (  XAResource res : resources) {
    try {
      int prepareStatus=res.prepare(xid);
      transaction.setPrepareStatus(prepareStatus);
    }
 catch (    XAException e) {
      log.trace("The resource wants to rollback!",e);
      return false;
    }
catch (    Throwable th) {
      log.error("Unexpected error from resource manager!",th);
      throw new SystemException(th.getMessage());
    }
  }
  return true;
}
