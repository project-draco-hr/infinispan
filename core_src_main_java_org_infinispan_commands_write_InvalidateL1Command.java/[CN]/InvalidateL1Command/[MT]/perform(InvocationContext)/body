{
  for (  Object k : getKeys()) {
    InternalCacheEntry ice=dataContainer.get(k);
    if (ice != null) {
      DataLocality locality=dm.getLocality(k);
      while (locality.isUncertain() && dm.isRehashInProgress()) {
        LockSupport.parkNanos(MILLISECONDS.toNanos(50));
        locality=dm.getLocality(k);
      }
      if (!locality.isLocal()) {
        if (forRehash && config.isL1OnRehash()) {
          if (log.isTraceEnabled())           log.trace("Not removing, instead putting entry into L1.");
          dataContainer.put(k,ice.getValue(),config.getL1Lifespan(),config.getExpirationMaxIdle());
        }
 else {
          invalidate(ctx,k);
        }
      }
    }
  }
  return null;
}
