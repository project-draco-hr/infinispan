{
  if (collector.size() > maxCollectorSize) {
    final Map<KOut,List<VOut>> batch=collector.removeCollectedValues();
    if (!batch.isEmpty()) {
      Map<KOut,List<VOut>> combinedValues=combine(mcc,batch);
      Set<KOut> migratedKeys=migrateIntermediateKeysAndValues(mcc,combinedValues);
      intermediateKeys.addAll(migratedKeys);
    }
  }
}
