{
synchronized (lock) {
    cancelled=true;
    if (sync) {
      while (running) {
        try {
          lock.wait(configuration.getCacheStopTimeout());
        }
 catch (        InterruptedException e) {
          Thread.currentThread().interrupt();
          break;
        }
      }
    }
  }
  if (log.isDebugEnabled()) {
    log.debugf("Node %s cancelled state transfer for view %d after %s!",self,newViewId,Util.prettyPrintTime(System.nanoTime() - stateTransferStartNanos,TimeUnit.NANOSECONDS));
  }
}
