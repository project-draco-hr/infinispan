{
  stateTransferStartNanos=System.nanoTime();
synchronized (lock) {
    running=true;
  }
  try {
    doPerformStateTransfer();
  }
  finally {
synchronized (lock) {
      running=false;
      lock.notifyAll();
    }
  }
}
