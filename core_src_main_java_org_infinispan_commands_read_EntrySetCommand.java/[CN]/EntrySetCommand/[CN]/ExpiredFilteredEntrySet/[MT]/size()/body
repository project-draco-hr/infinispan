{
  int s=entrySet.size();
  long currentTimeMillis=0;
  for (  InternalCacheEntry e : entrySet) {
    if (e.canExpire()) {
      if (currentTimeMillis == 0)       currentTimeMillis=timeService.wallClockTime();
      if (e.isExpired(currentTimeMillis))       s--;
    }
  }
  return s;
}
