{
  TopologyAwareOwnershipStatistics stats=new TopologyAwareOwnershipStatistics(ch);
  log.tracef("Ownership stats: " + stats);
  int maxPrimarySegments=numSegments / currentMembers.size() + 1;
  for (  Address node : currentMembers) {
    int maxSegments=stats.computeMaxSegments(numSegments,numOwners,node);
    log.tracef("Primary segments ratio: %f, total segments ratio: %f",stats.getPrimaryOwned(node) / maxPrimarySegments,stats.getOwned(node) / maxSegments);
    assertTrue(maxPrimarySegments * 0.4 <= stats.getPrimaryOwned(node));
    assertTrue(stats.getPrimaryOwned(node) <= maxPrimarySegments * 2);
    assertTrue(maxSegments * 0.4 <= stats.getOwned(node));
    assertTrue(stats.getOwned(node) <= maxSegments * 2);
  }
}
