{
  if (similarity == null) {
    similarity=builder.getSimilarity();
  }
 else   if (!similarity.getClass().equals(builder.getSimilarity().getClass())) {
    throw new HibernateException("Cannot perform search on two entities with differing Similarity implementations (" + similarity.getClass().getName() + " & "+ builder.getSimilarity().getClass().getName()+ ")");
  }
  return similarity;
}
