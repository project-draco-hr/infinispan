{
  if (!hasNext())   throw new IndexOutOfBoundsException("Index is out of bounds. There is no next");
  Object toReturn=null;
  int bufferSize=buffer.length;
  if (bufferIndex >= 0 && index >= bufferIndex && index < (bufferIndex + bufferSize)) {
    int indexToReturn=index - bufferIndex;
    toReturn=buffer[indexToReturn];
  }
 else {
    try {
      KeyTransformationHandler keyTransformationHandler=KeyTransformationHandler.getInstance(cache);
      String documentId=(String)extractor.extract(index).getId();
      toReturn=cache.get(keyTransformationHandler.stringToKey(documentId,cache.getClassLoader()));
      Arrays.fill(buffer,null);
      buffer[0]=toReturn;
      for (int i=1; i < bufferSize; i++) {
        String bufferDocumentId=(String)extractor.extract(index + i).getId();
        Object toBuffer=cache.get(keyTransformationHandler.stringToKey(bufferDocumentId,cache.getClassLoader()));
        buffer[i]=toBuffer;
      }
      bufferIndex=index;
    }
 catch (    IOException e) {
      throw new CacheException();
    }
  }
  index++;
  return toReturn;
}
