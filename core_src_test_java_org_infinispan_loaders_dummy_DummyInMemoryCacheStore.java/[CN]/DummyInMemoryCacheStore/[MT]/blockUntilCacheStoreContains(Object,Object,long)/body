{
  long killTime=System.currentTimeMillis() + timeout;
  while (System.currentTimeMillis() < killTime) {
    InternalCacheEntry entry=deserializeEntry(store.get(key));
    if (entry != null && entry.getValue().equals(expectedValue))     return;
    TestingUtil.sleepThread(50);
  }
  throw new RuntimeException(String.format("Timed out waiting (%d ms) for cache store to contain key=%s with value=%s",timeout,key,expectedValue));
}
