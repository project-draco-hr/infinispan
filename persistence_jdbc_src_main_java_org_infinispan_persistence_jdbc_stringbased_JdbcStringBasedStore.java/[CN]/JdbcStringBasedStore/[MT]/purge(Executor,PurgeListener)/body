{
  ExecutorCompletionService<Void> ecs=new ExecutorCompletionService<Void>(executor);
  Future<Void> future=ecs.submit(new Callable<Void>(){
    @Override public Void call() throws Exception {
      Connection conn=null;
      PreparedStatement ps=null;
      try {
        String sql=tableManipulation.getDeleteExpiredRowsSql();
        conn=connectionFactory.getConnection();
        ps=conn.prepareStatement(sql);
        ps.setLong(1,ctx.getTimeService().wallClockTime());
        int result=ps.executeUpdate();
        if (log.isTraceEnabled()) {
          log.tracef("Successfully purged %d rows.",result);
        }
      }
 catch (      SQLException ex) {
        log.failedClearingJdbcCacheStore(ex);
        throw new PersistenceException("Failed clearing string based JDBC store",ex);
      }
 finally {
        JdbcUtil.safeClose(ps);
        connectionFactory.releaseConnection(conn);
      }
      return null;
    }
  }
);
  try {
    future.get();
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
  }
catch (  ExecutionException e) {
    log.errorExecutingParallelStoreTask(e);
    throw new PersistenceException(e);
  }
}
