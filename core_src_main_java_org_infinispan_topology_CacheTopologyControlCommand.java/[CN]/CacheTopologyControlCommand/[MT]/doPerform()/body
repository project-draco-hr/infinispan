{
switch (type) {
case JOIN:
    return clusterTopologyManager.handleJoin(cacheName,sender,joinInfo,viewId);
case LEAVE:
  clusterTopologyManager.handleLeave(cacheName,sender,viewId);
return null;
case REBALANCE_CONFIRM:
clusterTopologyManager.handleRebalanceCompleted(cacheName,sender,topologyId,throwable,viewId);
return null;
case CH_UPDATE:
localTopologyManager.handleConsistentHashUpdate(cacheName,new CacheTopology(topologyId,currentCH,pendingCH),viewId);
return null;
case REBALANCE_START:
localTopologyManager.handleRebalance(cacheName,new CacheTopology(topologyId,currentCH,pendingCH),viewId);
return null;
case GET_STATUS:
return localTopologyManager.handleStatusRequest(viewId);
case POLICY_GET_STATUS:
return rebalancePolicy.isRebalancingEnabled();
case POLICY_ENABLE:
rebalancePolicy.setRebalancingEnabled(true);
return true;
case POLICY_DISABLE:
rebalancePolicy.setRebalancingEnabled(false);
return true;
default :
throw new CacheException("Unknown cache topology control command type " + type);
}
}
