{
  try {
    if (partitionTopologies.isEmpty())     return;
    CacheTopology cacheTopology;
    if (isMergeView) {
      cacheTopology=buildCacheTopologyForMerge(clusterMembers,partitionTopologies);
    }
 else {
      cacheTopology=buildCacheTopology(clusterMembers,partitionTopologies);
    }
    if (cacheTopology == null)     return;
    if (isRebalanceInProgress()) {
      setRebalanceStatus();
    }
    updateCacheTopology(cacheTopology);
    broadcastConsistentHashUpdate();
    rebalancePolicy.updateCacheStatus(cacheName,this);
  }
 catch (  Exception e) {
    log.failedToRecoverCacheState(cacheName,e);
  }
}
