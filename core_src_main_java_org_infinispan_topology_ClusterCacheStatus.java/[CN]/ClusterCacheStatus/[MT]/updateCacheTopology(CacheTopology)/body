{
synchronized (this) {
    this.cacheTopology=newTopology;
    if (!members.containsAll(cacheTopology.getMembers())) {
      throw new IllegalStateException(String.format("Trying to set a topology with invalid members " + "for cache %s: members = %s, topology = %s",cacheName,members,cacheTopology));
    }
    if (newTopology.getCurrentCH() != null) {
      joiners=immutableRemoveAll(members,newTopology.getCurrentCH().getMembers());
    }
    if (trace)     log.tracef("Cache %s topology updated: members = %s, joiners = %s, topology = %s",cacheName,members,joiners,cacheTopology);
  }
}
