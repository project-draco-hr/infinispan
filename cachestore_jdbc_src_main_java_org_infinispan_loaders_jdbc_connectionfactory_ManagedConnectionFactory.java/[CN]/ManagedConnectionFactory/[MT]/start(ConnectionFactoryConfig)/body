{
  InitialContext ctx=null;
  String datasourceName=config.getDatasourceJndiLocation();
  try {
    ctx=new InitialContext();
    dataSource=(DataSource)ctx.lookup(datasourceName);
    if (trace) {
      log.trace("Datasource lookup for " + datasourceName + " succeded: "+ dataSource);
    }
    if (dataSource == null) {
      String msg="Could not find a connection in jndi under the name '" + datasourceName + "'";
      log.error(msg);
      throw new CacheLoaderException(msg);
    }
  }
 catch (  NamingException e) {
    log.error("Could not lookup connection with datasource " + datasourceName,e);
    throw new CacheLoaderException(e);
  }
 finally {
    if (ctx != null) {
      try {
        ctx.close();
      }
 catch (      NamingException e) {
        log.warn("Failed to close naming context.",e);
      }
    }
  }
}
