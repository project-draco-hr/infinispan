{
  ConfigurationBuilder config=new ConfigurationBuilder();
  for (  RemoteInfinispanServer server : getServers()) {
    config.addServer().host(server.getHotrodEndpoint().getInetAddress().getHostName()).port(server.getHotrodEndpoint().getPort());
  }
  config.balancingStrategy("org.infinispan.server.test.client.hotrod.HotRodTestRequestBalancingStrategy").balancingStrategy("org.infinispan.client.hotrod.impl.transport.tcp.RoundRobinBalancingStrategy").forceReturnValues(false).tcpNoDelay(true).pingOnStartup(true).transportFactory("org.infinispan.client.hotrod.impl.transport.tcp.TcpTransportFactory").marshaller(new GenericJBossMarshaller(Thread.currentThread().getContextClassLoader())).asyncExecutorFactory().factoryClass("org.infinispan.client.hotrod.impl.async.DefaultAsyncExecutorFactory").addExecutorProperty("infinispan.client.hotrod.default_executor_factory.pool_size","10").addExecutorProperty("infinispan.client.hotrod.default_executor_factory.queue_size","100000").keySizeEstimate(64).valueSizeEstimate(512);
  if (isDistributedMode()) {
    config.consistentHashImpl(1,"org.infinispan.client.hotrod.impl.consistenthash.ConsistentHashV1");
  }
 else {
    config.consistentHashImpl(2,"org.infinispan.client.hotrod.impl.consistenthash.ConsistentHashV2");
  }
  return config.build();
}
