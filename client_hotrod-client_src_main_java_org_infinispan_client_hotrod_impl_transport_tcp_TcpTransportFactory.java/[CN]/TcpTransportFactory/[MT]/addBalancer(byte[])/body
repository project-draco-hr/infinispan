{
  FailoverRequestBalancingStrategy balancer;
  FailoverRequestBalancingStrategy cfgBalancerInstance=configuration.balancingStrategy();
  if (cfgBalancerInstance != null) {
    balancer=cfgBalancerInstance;
  }
 else {
    RequestBalancingStrategy cfgBalancer=Util.getInstance(configuration.balancingStrategyClass());
    balancer=(cfgBalancer instanceof FailoverRequestBalancingStrategy) ? (FailoverRequestBalancingStrategy)cfgBalancer : new FailoverToRequestBalancingStrategyDelegate(cfgBalancer);
  }
  balancers.put(cacheName,balancer);
  balancer.setServers(topologyInfo.getServers());
  return balancer;
}
