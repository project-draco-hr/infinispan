{
  final int normalizedHash=getNormalizedHash(getGrouping(key));
  final int actualReplCount=Math.min(replCount,caches.size());
  final List<Address> owners=new ArrayList<Address>(actualReplCount);
  final boolean virtualNodesEnabled=isVirtualNodesEnabled();
  for (Iterator<Address> it=getPositionsIterator(normalizedHash); it.hasNext(); ) {
    Address a=it.next();
    boolean isDuplicate=virtualNodesEnabled && owners.contains(a);
    if (!isDuplicate) {
      owners.add(a);
      if (owners.size() >= actualReplCount)       return owners;
    }
  }
  return owners;
}
