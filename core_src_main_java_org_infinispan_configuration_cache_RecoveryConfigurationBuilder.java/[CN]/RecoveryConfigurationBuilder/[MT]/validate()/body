{
  if (!enabled || transaction().useSynchronization()) {
    return;
  }
  if (!clustering().cacheMode().isSynchronous()) {
    throw new CacheConfigurationException("Recovery not supported with Asynchronous " + clustering().cacheMode().friendlyCacheModeString() + " cache mode.");
  }
  if (!transaction().syncCommitPhase()) {
    throw new CacheConfigurationException("Recovery not supported with asynchronous commit phase.");
  }
}
