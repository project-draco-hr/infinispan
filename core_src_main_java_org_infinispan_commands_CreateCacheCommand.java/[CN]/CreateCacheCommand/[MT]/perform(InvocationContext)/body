{
  if (cacheConfigurationName == null) {
    throw new NullPointerException("Cache configuration name is required");
  }
  Configuration cacheConfig=cacheManager.getCacheConfiguration(cacheConfigurationName);
  if (cacheConfig == null) {
    if (MapReduceTask.DEFAULT_TMP_CACHE_CONFIGURATION_NAME.equals(cacheConfigurationName)) {
      cacheConfig=new ConfigurationBuilder().unsafe().unreliableReturnValues(true).clustering().cacheMode(CacheMode.DIST_SYNC).hash().numOwners(2).sync().build();
      log.debugf("Using default tmp cache configuration, defined as ",cacheNameToCreate);
    }
 else {
      throw new IllegalStateException("Cache configuration " + cacheConfigurationName + " is not defined on node "+ this.cacheManager.getAddress());
    }
  }
  cacheManager.defineConfiguration(cacheNameToCreate,cacheConfig);
  Cache<Object,Object> cache=cacheManager.getCache(cacheNameToCreate);
  waitForCacheToStabilize(cache,cacheConfig);
  log.debugf("Defined and started cache %s",cacheNameToCreate);
  return true;
}
