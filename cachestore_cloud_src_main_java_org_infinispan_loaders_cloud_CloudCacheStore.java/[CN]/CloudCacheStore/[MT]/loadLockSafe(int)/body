{
  Set<InternalCacheEntry> result=new HashSet<InternalCacheEntry>(maxEntries);
  for (  Map.Entry<String,Blob> entry : ctx.createBlobMap(containerName).entrySet()) {
    Bucket bucket=readFromBlob(entry.getValue(),entry.getKey());
    if (bucket.removeExpiredEntries())     updateBucket(bucket);
    for (Iterator<? extends InternalCacheEntry> i=bucket.getStoredEntries().iterator(); i.hasNext() && result.size() < maxEntries; )     result.add(i.next());
    if (result.size() >= maxEntries)     break;
  }
  return result;
}
