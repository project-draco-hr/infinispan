{
  if (!config.isLazyPurgingOnly()) {
    acquireGlobalLock(false);
    try {
      final BlobMap blobMap=ctx.createBlobMap(containerName);
      if (multiThreadedPurge) {
        purgerService.execute(new Runnable(){
          @Override public void run(){
            try {
              for (              Blob blob : blobMap.values()) {
                Bucket bucket=readFromBlob(blob);
                if (bucket.removeExpiredEntries())                 updateBucket(bucket);
              }
            }
 catch (            CacheLoaderException e) {
              log.warn("Problems purging bucket",e);
            }
          }
        }
);
      }
 else {
        for (        Blob blob : blobMap.values()) {
          Bucket bucket=readFromBlob(blob);
          if (bucket.removeExpiredEntries())           updateBucket(bucket);
        }
      }
    }
  finally {
      releaseGlobalLock(false);
    }
  }
}
