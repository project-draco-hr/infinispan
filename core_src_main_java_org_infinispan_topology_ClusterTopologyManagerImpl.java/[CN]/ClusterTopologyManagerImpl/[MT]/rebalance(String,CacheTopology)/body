{
  log.debugf("Starting cluster-wide rebalance for cache %s, topology = %s",cacheName,cacheTopology);
  int topologyId=cacheTopology.getTopologyId();
  Collection<Address> members=cacheTopology.getPendingCH().getMembers();
  RebalanceInfo existingRebalance=rebalanceStatusMap.putIfAbsent(cacheName,new RebalanceInfo(topologyId,members));
  if (existingRebalance != null) {
    throw new IllegalStateException("Aborting the current rebalance, there is another operation " + "in progress: " + existingRebalance);
  }
  ReplicableCommand command=new CacheTopologyControlCommand(cacheName,CacheTopologyControlCommand.Type.REBALANCE_START,transport.getAddress(),cacheTopology);
  executeOnClusterAsync(command);
}
