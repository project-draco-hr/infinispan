{
  if (viewId < this.viewId) {
    return;
  }
  this.viewId=viewId;
  boolean becameCoordinator=!isCoordinator && transport.isCoordinator();
  if (mergeView || becameCoordinator) {
    try {
      Map<String,List<CacheTopology>> clusterCacheMap=recoverClusterStatus();
      for (      Map.Entry<String,List<CacheTopology>> e : clusterCacheMap.entrySet()) {
        String cacheName=e.getKey();
        List<CacheTopology> topologyList=e.getValue();
        rebalancePolicy.initCache(cacheName,topologyList);
      }
    }
 catch (    Exception e) {
      log.failedToRecoverClusterState(e);
    }
  }
 else {
    try {
      rebalancePolicy.updateMembersList(newMembers);
    }
 catch (    Exception e) {
      log.errorUpdatingMembersList(e);
    }
  }
}
