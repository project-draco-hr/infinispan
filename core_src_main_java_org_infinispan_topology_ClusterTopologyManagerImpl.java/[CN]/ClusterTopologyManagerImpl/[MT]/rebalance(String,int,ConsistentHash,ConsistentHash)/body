{
  log.debugf("Starting cluster-wide rebalance for cache %s, topology id = %s, new CH = %s",cacheName,topologyId,pendingCH);
  RebalanceInfo existingRebalance=rebalanceStatusMap.putIfAbsent(cacheName,new RebalanceInfo(topologyId,pendingCH.getMembers()));
  if (existingRebalance != null) {
    throw new IllegalStateException("Aborting the current rebalance, there is another operation in progress: " + existingRebalance);
  }
  ReplicableCommand command=new CacheTopologyControlCommand(cacheName,CacheTopologyControlCommand.Type.REBALANCE_START,transport.getAddress(),topologyId,currentCH,pendingCH);
  executeOnClusterAsync(command);
}
