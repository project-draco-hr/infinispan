{
  AdvancedCache<K,V> currentCache=null;
  List<Address> members=null;
  for (  AdvancedCache<K,V> cache : caches) {
    if (cache == excludeCache) {
      continue;
    }
    Address address=cache.getCacheManager().getAddress();
    if (members == null) {
      members=cache.getCacheManager().getMembers();
    }
    if (members.get(0).equals(address)) {
      return cache;
    }
    if (members.get(1).equals(address)) {
      currentCache=cache;
    }
  }
  assertNotNull("Couldn't locate next coordinator",currentCache);
  if (log.isDebugEnabled()) {
    log.debug("Next Coordinator is " + currentCache);
  }
  return currentCache;
}
