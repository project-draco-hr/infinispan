{
  acquireLocksIfNeeded();
  long flagBitSet=EnumUtil.bitSetOf(Flag.SKIP_REMOTE_LOOKUP,Flag.CACHE_MODE_LOCAL);
  GetCacheEntryCommand command=commandsFactory.buildGetCacheEntryCommand(key,EnumUtil.mergeBitSets(flagBitSet,getFlagsBitSet()));
  InvocationContext invocationContext=icf.createRemoteInvocationContextForCommand(command,getOrigin());
  CacheEntry cacheEntry=(CacheEntry)invoker.invoke(invocationContext,command);
  if (cacheEntry == null) {
    if (trace)     log.trace("Did not find anything, returning null");
    return null;
  }
  if (cacheEntry instanceof MVCCEntry) {
    if (trace)     log.trace("Handling an internal cache entry...");
    MVCCEntry mvccEntry=(MVCCEntry)cacheEntry;
    return entryFactory.createValue(mvccEntry);
  }
 else {
    InternalCacheEntry internalCacheEntry=(InternalCacheEntry)cacheEntry;
    return internalCacheEntry.toInternalCacheValue();
  }
}
