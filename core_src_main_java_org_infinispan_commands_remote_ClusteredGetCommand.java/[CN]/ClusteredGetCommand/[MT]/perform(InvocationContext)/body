{
  acquireLocksIfNeeded();
  if (distributionManager != null && distributionManager.isAffectedByRehash(key))   return null;
  Set<Flag> commandFlags=EnumSet.of(Flag.SKIP_REMOTE_LOOKUP,Flag.CACHE_MODE_LOCAL);
  if (this.flags != null)   commandFlags.addAll(this.flags);
  GetKeyValueCommand command=commandsFactory.buildGetCacheEntryCommand(key,commandFlags);
  InvocationContext invocationContext=icc.createRemoteInvocationContextForCommand(command,getOrigin());
  CacheEntry cacheEntry=(CacheEntry)invoker.invoke(invocationContext,command);
  if (cacheEntry == null) {
    if (trace)     log.trace("Did not find anything, returning null");
    return null;
  }
  if (cacheEntry instanceof MVCCEntry) {
    if (trace)     log.trace("Handling an internal cache entry...");
    MVCCEntry mvccEntry=(MVCCEntry)cacheEntry;
    return entryFactory.createValue(mvccEntry);
  }
 else {
    InternalCacheEntry internalCacheEntry=(InternalCacheEntry)cacheEntry;
    return internalCacheEntry.toInternalCacheValue();
  }
}
