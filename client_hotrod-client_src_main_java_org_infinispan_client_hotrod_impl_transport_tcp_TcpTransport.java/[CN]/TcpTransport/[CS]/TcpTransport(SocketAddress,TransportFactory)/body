{
  super(transportFactory);
  this.serverAddress=serverAddress;
  try {
    if (transportFactory.getSSLContext() != null) {
      SSLContext sslContext=transportFactory.getSSLContext();
      socketChannel=null;
      socket=sslContext.getSocketFactory().createSocket();
    }
 else {
      socketChannel=SocketChannel.open();
      socket=socketChannel.socket();
    }
    socket.connect(serverAddress,transportFactory.getConnectTimeout());
    socket.setTcpNoDelay(transportFactory.isTcpNoDelay());
    socket.setKeepAlive(transportFactory.isTcpKeepAlive());
    socket.setSoTimeout(transportFactory.getSoTimeout());
    socketInputStream=new BufferedInputStream(socket.getInputStream(),socket.getReceiveBufferSize());
    socketOutputStream=new BufferedOutputStream(socket.getOutputStream(),socket.getSendBufferSize());
  }
 catch (  Exception e) {
    String message=String.format("Could not connect to server: %s",serverAddress);
    log.tracef(e,"Could not connect to server: %s",serverAddress);
    throw new TransportException(message,e,serverAddress);
  }
}
