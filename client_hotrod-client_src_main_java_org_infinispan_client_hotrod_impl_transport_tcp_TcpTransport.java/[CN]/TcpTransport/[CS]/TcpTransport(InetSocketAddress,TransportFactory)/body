{
  super(transportFactory);
  this.serverAddress=serverAddress;
  try {
    socketChannel=SocketChannel.open();
    socket=socketChannel.socket();
    socket.connect(serverAddress,transportFactory.getSoTimeout());
    socket.setTcpNoDelay(transportFactory.isTcpNoDelay());
    socket.setSoTimeout(transportFactory.getConnectTimeout());
    socketInputStream=new BufferedInputStream(socket.getInputStream(),socket.getReceiveBufferSize());
    socketOutputStream=new BufferedOutputStream(socket.getOutputStream(),socket.getSendBufferSize());
  }
 catch (  IOException e) {
    String message=String.format("Could not connect to server: %s",serverAddress);
    log.couldNotConnectToServer(serverAddress,e);
    throw new TransportException(message,e);
  }
}
