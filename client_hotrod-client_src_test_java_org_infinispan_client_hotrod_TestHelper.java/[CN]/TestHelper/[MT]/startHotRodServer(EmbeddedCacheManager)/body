{
  HotRodServer server=null;
  int maxTries=10;
  int currentTries=0;
  ChannelException lastException=null;
  while (server == null && currentTries < maxTries) {
    try {
      server=HotRodTestingUtil.startHotRodServer(cacheManager,uniquePort.incrementAndGet());
    }
 catch (    ChannelException e) {
      if (!(e.getCause() instanceof BindException)) {
        throw e;
      }
 else {
        log.debug("Address already in use: [" + e.getMessage() + "], so let's try next port");
        currentTries++;
        lastException=e;
      }
    }
  }
  if (server == null && lastException != null)   throw lastException;
  return server;
}
