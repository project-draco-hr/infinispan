{
  if (authzManager != null) {
    authzManager.checkPermission(AuthorizationPermission.EXEC);
  }
  ScriptMetadata metadata=getScriptMetadata(scriptName);
  SimpleBindings systemBindings=new SimpleBindings();
  systemBindings.put(SystemBindings.CACHE_MANAGER.toString(),cacheManager);
  systemBindings.put(SystemBindings.SCRIPTING_MANAGER.toString(),this);
  if (cache != null) {
    systemBindings.put(SystemBindings.CACHE.toString(),cache);
  }
  CacheScriptBindings bindings=new CacheScriptBindings(systemBindings,parameters);
  String mode=metadata.property(MetadataProperties.MODE);
  ScriptRunner runner=ExecutionMode.valueOf(mode.toUpperCase()).getRunner();
  return runner.runScript(this,metadata,bindings);
}
