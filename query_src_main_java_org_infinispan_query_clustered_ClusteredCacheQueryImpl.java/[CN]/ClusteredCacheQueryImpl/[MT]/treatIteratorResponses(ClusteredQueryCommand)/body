{
  ClusteredQueryInvoker invoker=new ClusteredQueryInvoker(cache,asyncExecutor);
  HashMap<UUID,ClusteredTopDocs> topDocsResponses=null;
  int resultSize=0;
  List<QueryResponse> responses=invoker.broadcast(command);
  topDocsResponses=new HashMap<UUID,ClusteredTopDocs>();
  for (  Object response : responses) {
    QueryResponse queryResponse=(QueryResponse)response;
    ClusteredTopDocs topDocs=new ClusteredTopDocs(queryResponse.getTopDocs(),queryResponse.getNodeUUID());
    resultSize+=queryResponse.getResultSize();
    topDocs.setNodeAddress(queryResponse.getAddress());
    topDocsResponses.put(queryResponse.getNodeUUID(),topDocs);
  }
  this.resultSize=resultSize;
  return topDocsResponses;
}
