{
  for (int segment=0; segment < builder.getNumSegments(); segment++) {
    List<Address> owners=builder.getOwners(segment);
    List<Address> backupOwners=builder.getBackupOwners(segment);
    for (int i=backupOwners.size() - 1; i >= 0; i--) {
      Address owner=backupOwners.get(i);
      if (locationIsDuplicate(owner,owners,level)) {
        for (        Address candidate : builder.getMembers()) {
          if (!owners.contains(candidate) && !locationIsDuplicate(candidate,owners,level)) {
            builder.addOwner(segment,candidate);
            builder.removeOwner(segment,owner);
            owners=builder.getOwners(segment);
            backupOwners=builder.getBackupOwners(segment);
            break;
          }
        }
      }
    }
  }
}
