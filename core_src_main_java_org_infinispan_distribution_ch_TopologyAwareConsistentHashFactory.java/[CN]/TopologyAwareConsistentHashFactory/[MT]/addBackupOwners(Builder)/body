{
  int minSegments=builder.getActualNumOwners() * builder.getNumSegments() / builder.getNumNodes();
  removeExtraBackupOwners(builder,minSegments);
  addBackupOwnersForLevel(builder,minSegments,Level.SITE);
  addBackupOwnersForLevel(builder,minSegments,Level.RACK);
  addBackupOwnersForLevel(builder,minSegments,Level.MACHINE);
  addBackupOwnersForLevel(builder,minSegments,Level.NONE);
  replaceBackupOwnersForLevel(builder,Level.SITE);
  replaceBackupOwnersForLevel(builder,Level.RACK);
  replaceBackupOwnersForLevel(builder,Level.MACHINE);
  replaceBackupOwnerForMachineLevel(builder,minSegments);
}
